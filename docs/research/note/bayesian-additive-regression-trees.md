# BARTの拡張手法の網羅と分類

ベイズ加法回帰樹（BART: Bayesian Additive Regression Trees）は、その柔軟性と高い予測精度から多くの応用分野で利用されています。BARTの基本モデル（Chipman ら (2010) ([Bayesian additive regression trees and the General BART model - PMC](https://pmc.ncbi.nlm.nih.gov/articles/PMC6800811/#:~:text=,Journal%20of%20Environmental%20Radioactivity%202015))）は回帰や2値分類に適用できますが、近年ではモデル性能の向上、適用可能なデータ型の拡大、特定の課題への対応を目的として数多くの拡張手法が提案されています。本稿では、それら拡張手法を主要なカテゴリに分類し、それぞれの特徴と提案論文についてまとめます。

## 1. モデル性能・柔軟性向上のための拡張

**（a）高次元データ・変数選択への対応:**  
- **DART (Dirichlet prior for BART):** BARTのスプリット変数選択にディリクレ事前分布を導入し、不要な変数への寄与を抑制することでスパース性を実現した手法です。Linero (2018) ([Bayesian Additive Regression Trees: A Review and Look Forward | Annual Reviews](https://www.annualreviews.org/content/journals/10.1146/annurev-statistics-031219-041110#:~:text=Linero%20AR,113%3A626%E2%80%9336)) ([Variable Selection Using Bayesian Additive Regression Trees](https://arxiv.org/pdf/2112.13998#:~:text=2,of%20which%20the%20event%20probabilities))が提案し、高次元データでも重要変数を自動選択しやすくしています（“Bayesian regression trees for high-dimensional prediction and variable selection” ([Bayesian Additive Regression Trees: A Review and Look Forward | Annual Reviews](https://www.annualreviews.org/content/journals/10.1146/annurev-statistics-031219-041110#:~:text=Linero%20AR,113%3A626%E2%80%9336))）。  
- **スパイク・アンド・スラブ事前分布:** 分割ノードごとに変数が選択される確率にスパイク・アンド・スラブ型の事前を置くことで、不要な変数の影響を排除する方法です。Ročková と van der Pas (2017) ([Sparse prediction informed by genetic annotations using the logit ...](https://pmc.ncbi.nlm.nih.gov/articles/PMC9892284/#:~:text=Sparse%20prediction%20informed%20by%20genetic,useful%20in%20the%20case))はこのアプローチでBARTの理論的収束性を解析し、重要変数の漸近的一致推定を保証しました。Liu ら (2021) もABC Bayesian forestという手法で類似のスパース化を図っています ([Variable Selection Using Bayesian Additive Regression Trees](https://arxiv.org/pdf/2112.13998#:~:text=match%20at%20L1522%20For%20DART,binomial))。  
- **Horseshoe正則化:** 木構造の分割ルールに対し階層的Horseshoe事前分布を適用し、ルールごとの寄与に強いスパース効果を与えた手法です。Nalenz と Villani (2018) ([
            Bayesian additive regression trees and the General BART model - PMC
        ](https://pmc.ncbi.nlm.nih.gov/articles/PMC6800811/#:~:text=,Google%20Scholar))が提案し、高次元かつルールが複雑な場合でも過適合を抑制します。  

**（b）平滑性の向上・滑らかな関数近似:**  
- **Soft BART:** 分割ルールをハードな閾値ではなく確率的に適用する「ソフト」決定木に置き換えることで、応答関数を滑らかに推定する拡張です ([[PDF] Bayesian regression tree ensembles that adapt to smoothness ...](https://www.semanticscholar.org/paper/Bayesian-regression-tree-ensembles-that-adapt-to-Linero-Yang/dca189ceb2e791fa0e0f04ffa734e7c09a75a955#:~:text=,the%20unknown%20smoothness%20and))。Linero と Yang (2018) ([Bayesian Additive Regression Trees: A Review and Look Forward | Annual Reviews](https://www.annualreviews.org/content/journals/10.1146/annurev-statistics-031219-041110#:~:text=match%20at%20L515%20Linero%20AR%2C,B%2080%3A1087%E2%80%93110))が提案した *“Bayesian regression tree ensembles that adapt to smoothness and sparsity”* に基づき、従来の階段状の予測関数を平滑化しつつスパース性にも適応します。この手法は高次元で真の関数が平滑な場合に精度向上が報告されています ([Bayesian Additive Regression Trees: A Review and Look Forward | Annual Reviews](https://www.annualreviews.org/content/journals/10.1146/annurev-statistics-031219-041110#:~:text=match%20at%20L515%20Linero%20AR%2C,B%2080%3A1087%E2%80%93110))。  
- **GP-BART:** 各決定木のリーフごとの予測にガウス過程事前を組み込むことで、観測間の共分散構造を明示的にモデル化したBART拡張です。Maia ら (2022) ([[2204.02112] GP-BART: a novel Bayesian additive regression trees approach using Gaussian processes](https://arxiv.org/abs/2204.02112#:~:text=whereby%20each%20tree%20explains%20a,modeling%20approaches%20in%20various%20scenarios))は「Gaussian processes Bayesian additive regression trees (GP-BART)」を提案し、標準BARTでは平滑性や空間的相関を捉えにくいデータに対して、高い予測性能と不確実性推定の向上を示しました ([[2204.02112] GP-BART: a novel Bayesian additive regression trees approach using Gaussian processes](https://arxiv.org/abs/2204.02112#:~:text=whereby%20each%20tree%20explains%20a,modeling%20approaches%20in%20various%20scenarios))。特に空間データなど平滑な効果が期待される場合に有効です。  

**（c）MCMCアルゴリズムおよび計算効率の改善:**  
- **効率的な木提案手法:** 標準BARTの木構造更新は単純な局所移動に依存するため収束が遅くなる場合があります。Pratola (2016) ([
            Bayesian additive regression trees and the General BART model - PMC
        ](https://pmc.ncbi.nlm.nih.gov/articles/PMC6800811/#:~:text=Posterior%20Simulation,of%20Binary%20and%20Polychotomous%20Response))はメトロポリス–ヘイスティングスにおける効率的な提案分布を開発し、大幅な探索の高速化を実現しました（“Efficient Metropolis-Hastings proposal mechanisms for Bayesian regression tree models”）。この手法により、特に共変量間に強い相関がある場合でもサンプラーのミキシングが改善されます ([
            Bayesian additive regression trees and the General BART model - PMC
        ](https://pmc.ncbi.nlm.nih.gov/articles/PMC6800811/#:~:text=Posterior%20Simulation,of%20Binary%20and%20Polychotomous%20Response))。  
- **Particle Gibbs BART:** Lakshminarayanan ら (2015) ([Bayesian Additive Regression Trees: A Review and Look Forward | Annual Reviews](https://www.annualreviews.org/content/journals/10.1146/annurev-statistics-031219-041110#:~:text=))は粒子フィルタとギブスサンプリングを組み合わせたサンプラーを導入し、木構造の同時更新による後方分布探索を可能にしました ([Bayesian Additive Regression Trees: A Review and Look Forward | Annual Reviews](https://www.annualreviews.org/content/journals/10.1146/annurev-statistics-031219-041110#:~:text=))。この“Particle Gibbs for BART”は高次元でも安定した収束を示し、逐次モンテカルロ法の利点をBARTに取り入れています。  
- **XBART:** BARTを逐次的勾配ブースティングに近い形式で近似し、高速に推定するアルゴリズムです。He ら (2019) ([Bayesian Additive Regression Trees: A Review and Look Forward | Annual Reviews](https://www.annualreviews.org/content/journals/10.1146/annurev-statistics-031219-041110#:~:text=26))の *“XBART: Accelerated Bayesian additive regression trees”* は事前分布に基づく重み付けを維持しつつ、逐次的に木を追加することでMCMCを介さず高速に予測を行います。計算コストは大幅に削減され、大規模データに対しても適用可能になりました。  

## 2. 応用領域の拡大に対応する拡張

**（a）分類問題への拡張:**  
- **2値分類BART:** 応答がバイナリの場合、BARTではプロビットリンクを用いたデータ拡張により対応します ([
            Bayesian additive regression trees and the General BART model - PMC
        ](https://pmc.ncbi.nlm.nih.gov/articles/PMC6800811/#:~:text=Trees,422%29%3A%20669%E2%80%93679))。Chipman ら (2010)はAlbert & Chib (1993) ([
            Bayesian additive regression trees and the General BART model - PMC
        ](https://pmc.ncbi.nlm.nih.gov/articles/PMC6800811/#:~:text=Trees,422%29%3A%20669%E2%80%93679))の手法を採用して2値データへのBayesian CART適用を実現しました。これによりロジスティック回帰に匹敵する柔軟な分類モデルとなっています。  
- **多クラス分類BART:** Kindo ら (2016) ([
            Bayesian additive regression trees and the General BART model - PMC
        ](https://pmc.ncbi.nlm.nih.gov/articles/PMC6800811/#:~:text=,new%20Bayesian%20ensemble%20of%20trees))は*“Multinomial probit Bayesian additive regression trees”* を発表し、BARTを多クラス（順序なしカテゴリ）に拡張しました。各クラスに対し潜在ガウスモデルを導入することでプロビットBARTを一般化したもので、従来の一対他法よりも一貫した階層ベイズモデルとしてカテゴリカル応答を扱えます ([
            Bayesian additive regression trees and the General BART model - PMC
        ](https://pmc.ncbi.nlm.nih.gov/articles/PMC6800811/#:~:text=,new%20Bayesian%20ensemble%20of%20trees))。また、Agarwal ら (2013) ([
            Bayesian additive regression trees and the General BART model - PMC
        ](https://pmc.ncbi.nlm.nih.gov/articles/PMC6800811/#:~:text=%5BPubMed%5D%20%5BGoogle%20Scholar%5D%20,Google%20Scholar))は衛星画像の土地被覆分類への応用でBARTを用いたマルチクラス分類手法を提案しています。  

**（b）カウントデータ・離散応答への拡張:**  
- **ロジ線形BART:** ポアソン回帰やカテゴリカル応答に対応するため、対数リンク関数下でBARTを適用する手法が考案されています。Murray (2017) ([
            Bayesian additive regression trees and the General BART model - PMC
        ](https://pmc.ncbi.nlm.nih.gov/articles/PMC6800811/#:~:text=trees,Google%20Scholar))は *“Log-linear BART for categorical and count responses”* としてポアソン分布や二項分布に対応するモデルを提案しました。これはデータ拡張にポリアガンマ分布を用いることで条件共役性を確保し、計算効率よくカウントデータの予測にBARTを活用しています。実際に、この手法は従来の一般化線形モデルを上回る予測性能を示しています ([
            Bayesian additive regression trees and the General BART model - PMC
        ](https://pmc.ncbi.nlm.nih.gov/articles/PMC6800811/#:~:text=trees,Google%20Scholar))。  
- **量的応答の分位点推定:** 応答分布の特定の分位点（パーセンタイル）を直接推定するBARTの拡張もあります。Kindo ら (2016) ([
            Bayesian additive regression trees and the General BART model - PMC
        ](https://pmc.ncbi.nlm.nih.gov/articles/PMC6800811/#:~:text=%5BGoogle%20Scholar%5D%20,Google%20Scholar))は *“Bayesian quantile additive regression trees”* を提案し、分位点損失に基づく木モデルを組み合わせることで分位点回帰をベイズ的に実現しました。これにより外れ値の影響を受けにくいロバストな予測が可能です。  

**（c）生存時間・時間系列への拡張:**  
- **生存BART:** 医療や信頼性工学の分野で重要な生存時間データ（イベント発生までの時間と打ち切り）に対応するため、BARTを用いた生存分析モデルが開発されています。Logan ら (2016) ([
            Bayesian additive regression trees and the General BART model - PMC
        ](https://pmc.ncbi.nlm.nih.gov/articles/PMC6800811/#:~:text=,Google%20Scholar))は *“Nonparametric survival analysis using BART”* において離散時間生存モデルとしてBARTを拡張しました。生存関数を時系列データとして扱い、BARTでハザードを推定するこの手法は、従来のCoxモデルでは捉えにくい非線形効果や交互作用を柔軟に捉えられることを示しています ([
            Bayesian additive regression trees and the General BART model - PMC
        ](https://pmc.ncbi.nlm.nih.gov/articles/PMC6800811/#:~:text=,Google%20Scholar))。またBonato ら (2011) ([
            Bayesian additive regression trees and the General BART model - PMC
        ](https://pmc.ncbi.nlm.nih.gov/articles/PMC6800811/#:~:text=,121%20PMC%20free))は遺伝子発現データに対する生存予測にBARTアンサンブルを適用し、高精度な予後予測を達成しました。さらに、Sparapani ら (2019)は競合リスクに対するBART ([
            Bayesian additive regression trees and the General BART model - PMC
        ](https://pmc.ncbi.nlm.nih.gov/articles/PMC6800811/#:~:text=%5BPubMed%5D%20%5BGoogle%20Scholar%5D%20,175%20Google))、Sparapani ら (2018)は再発イベントデータへのBART適用 ([
            Bayesian additive regression trees and the General BART model - PMC
        ](https://pmc.ncbi.nlm.nih.gov/articles/PMC6800811/#:~:text=,PMC%20free%20article))も報告しており、生存分析分野でBARTの応用が広がっています。  
- **時系列への拡張:** マクロ経済や金融の時系列では、時点ごとの関係が非線形となりうるため、BARTをベクトル自己回帰（VAR）モデルに組み込んだ研究もあります。Huber と Rossini (2021) は**BAVART** (Bayesian Additive Vector Autoregressive Regression Trees)モデルを提案し、VARの構造内でBARTを用いることで予測精度を向上させました ([Inference in Bayesian additive vector autoregressive tree models](https://air.unimi.it/retrieve/dfa8b9aa-267f-748b-e053-3a05fe0a3a96/Huber_Rossini_22-%20Inference%20in%20Bayesian%20additive%20Vector%20Autoregressive%20Tree%20Models.pdf#:~:text=,for%20stochastic%20volatility%20in%20the)) ([Inference in Bayesian additive vector autoregressive tree models](https://air.unimi.it/retrieve/dfa8b9aa-267f-748b-e053-3a05fe0a3a96/Huber_Rossini_22-%20Inference%20in%20Bayesian%20additive%20Vector%20Autoregressive%20Tree%20Models.pdf#:~:text=Bayesian%20additive%20vector%20autoregressive%20tree,MCMC))。このモデルではBARTにより時変係数や非線形関係を捉えつつ、各時系列間の動的な相互作用を推定できます。BAVARTは金利予測等で従来の線形VARに勝る性能を示しています ([Inference in Bayesian additive vector autoregressive tree models](https://air.unimi.it/retrieve/dfa8b9aa-267f-748b-e053-3a05fe0a3a96/Huber_Rossini_22-%20Inference%20in%20Bayesian%20additive%20Vector%20Autoregressive%20Tree%20Models.pdf#:~:text=BAVART%20model%20yields%20highly%20competitive,of%20un%02certainty%20on%20the%20economy))。  

**（d）複数アウトカム・混合型アウトカムへの拡張:**  
- **セミ連続（混合分布）アウトカム:** 零Inflationや実数連続の混合分布を持つ応答に対し、BARTを共有構造として用いる手法があります。Linero ら (2018) ([
            Bayesian additive regression trees and the General BART model - PMC
        ](https://pmc.ncbi.nlm.nih.gov/articles/PMC6800811/#:~:text=approach%20for%20land%20cover%20classification,Google%20Scholar))は *“Semiparametric Mixed-Scale Models Using Shared Bayesian Forests”* を発表し、例えば一部がゼロ値をとる連続データ（治療費データ等）に対して、ゼロ発生モデルと連続部分モデルで同じBARTを共有させる枠組みを提案しました。この**共有BART**モデルでは、離散と連続の両部分で共通の回帰木構造を持つため、両者の予測に一貫性が生まれ精度向上に寄与します ([
            Bayesian additive regression trees and the General BART model - PMC
        ](https://pmc.ncbi.nlm.nih.gov/articles/PMC6800811/#:~:text=approach%20for%20land%20cover%20classification,Google%20Scholar))。  
- **相関のある多変量アウトカム:** 複数の関連するアウトカムを同時に予測・推定するために、階層的にBARTを組み込むことも可能です。たとえばZhang ら (2007) ([
            Bayesian additive regression trees and the General BART model - PMC
        ](https://pmc.ncbi.nlm.nih.gov/articles/PMC6800811/#:~:text=Statistics%20and%20its%20Interface%202018%3B,Google%20Scholar))は空間データを含む2つのデータセットをマージするための空間調整BARTモデルを提案し、異なるデータ源間での一貫した推定を実現しました。また、最近の研究では教育評価データに対して、複数科目の得点に対する介入効果を同時に推定するマルチアウトカム版BCF（後述）が開発されています ([Bayesian causal forests for multivariate outcomes: application to Irish data from an international large scale education assessment | Journal of the Royal Statistical Society Series A: Statistics in Society | Oxford Academic](https://academic.oup.com/jrsssa/advance-article/doi/10.1093/jrsssa/qnae049/7681717#:~:text=An%20important%20limitation%20of%20many,Specifically%2C%20we%20attempt))。このようにBARTは階層モデルとして拡張することで、アウトカム間の相関も考慮した分析が可能です。  

## 3. 特定の制約・課題への対応を目的とした拡張

**（a）単調性制約への対応:**  
- **mBART (Multidimensional Monotone BART):** いくつかの予測変数については応答との関係が理論上単調増加/減少と考えられる場合があります。Chipman ら (2016) ([[1612.01619] mBART: Multidimensional Monotone BART](https://arxiv.org/abs/1612.01619#:~:text=matter%20considerations%20sometimes%20warrant%20a,mBART%2C%20the%20introduction%20of%20monotonicity))はそのような**単調性制約**を組み込んだBARTモデル *“mBART”* を提案しました。指定した変数に対して分割ルールが単調性を保つよう木構造を構築するもので、モンテカルロサンプル生成アルゴリズムも条件付き共役性が崩れるため新たに工夫されています ([[1612.01619] mBART: Multidimensional Monotone BART](https://arxiv.org/abs/1612.01619#:~:text=while%20avoiding%20the%20further%20confines,simulated%20and%20real%20examples%20demonstrate))。mBARTにより、予測関数がより滑らかかつ解釈しやすくなるとともに、外挿時の挙動も現実的になる利点があります ([[1612.01619] mBART: Multidimensional Monotone BART](https://arxiv.org/abs/1612.01619#:~:text=matter%20considerations%20sometimes%20warrant%20a,mBART%2C%20the%20introduction%20of%20monotonicity))。  
- **部分的なスムージング（Targeted smoothing）:** ある特定の連続変数（例：時間や年齢）のみに対して滑らかな効果を持たせ、それ以外の効果は非線形に捉えるような拡張もあります。Starling ら (2018) ([
            Bayesian additive regression trees and the General BART model - PMC
        ](https://pmc.ncbi.nlm.nih.gov/articles/PMC6800811/#:~:text=Scholar%20scholar.google.com%20%5D%20,parametric))は*“BART with Targeted Smoothing”*として、BARTモデル内の一部の効果に平滑化事前を適用する手法を示しました。産科領域の症例（死産リスクの週数依存性解析）で、この手法が局所的な滑らかさとBARTの非線形適合性を両立し、有益な予測と解釈を提供することが示されています ([
            Bayesian additive regression trees and the General BART model - PMC
        ](https://pmc.ncbi.nlm.nih.gov/articles/PMC6800811/#:~:text=Scholar%20scholar.google.com%20%5D%20,parametric))。  

**（b）誤差構造・分散の拡張:**  
- **Heteroscedastic BART (HBART):** 応答の分散が一定でない場合（異質分散性）、BART基本モデルでは予測区間の信頼性が低下します。これを克服するため、平均モデルに加えて分散にも木モデルを乗じて推定する異質分散BARTが考案されました ([[1709.07542] Heteroscedastic BART Via Multiplicative Regression Trees](https://ar5iv.labs.arxiv.org/html/1709.07542#:~:text=a%20constant%20variance%20error%20model,the%20mean%20and%20the%20variance))。例えばPratolaらを含む研究者グループ (2019) は、平均を和の木で、分散を積の木で表現する完全非パラメトリックなHBARTモデルを示しています ([[1709.07542] Heteroscedastic BART Via Multiplicative Regression Trees](https://ar5iv.labs.arxiv.org/html/1709.07542#:~:text=a%20constant%20variance%20error%20model,can%20provide%20insights%20into%20the))。BARTの柔軟性をそのままに分散構造も学習できるため、予測区間の適合度向上やデータ中の「分散に影響を与える因子」の発見にも寄与します ([[1709.07542] Heteroscedastic BART Via Multiplicative Regression Trees](https://ar5iv.labs.arxiv.org/html/1709.07542#:~:text=nonparametric%20heteroscedastic%20elaboration%20of%20BART,revealing%20new%20diagnostic%20plots%20are))。一方、Bleich と Kapelner (2014) ([[1709.07542] Heteroscedastic BART Via Multiplicative Regression Trees](https://ar5iv.labs.arxiv.org/html/1709.07542#:~:text=and%20is%20dramatically%20more%20hospitable,In%20another))は分散に線形モデルを仮定する簡易版を提案しており、計算コストと柔軟性のトレードオフがあります。現在ではHBARTの実装も公開され、応用が進んでいます。  

**（c）欠測値への対応:**  
- **BARTによる欠測データ補完:** 共変量に欠測がある場合、Kapelner と Bleich (2015) ([
            Bayesian additive regression trees and the General BART model - PMC
        ](https://pmc.ncbi.nlm.nih.gov/articles/PMC6800811/#:~:text=,2019%3B%204%3A%20ahead%20of%20print))はBARTを用いて欠測を扱う方法を提案しました。*“Prediction with missing data via BART”* と題した研究では、欠測指示変数を拡張した木の分割ルールに組み込み、欠測自体を情報として利用するアプローチを取っています。これにより、欠測時も一貫した予測が可能となり、医療統計などで有用と報告されています。  
- **Sequential BART imputation:** Xu ら (2016) ([
            Bayesian additive regression trees and the General BART model - PMC
        ](https://pmc.ncbi.nlm.nih.gov/articles/PMC6800811/#:~:text=yourself%20methods%20for%20causal%20inference%3A,DOI))はBARTを多重代入法に応用し、変数ごとに順次BARTで欠測値を予測して補完する手順を提案しました。Biostatistics誌の論文ではシミュレーションを通じ、この手法が従来の多重代入と比べバイアスを低減することが示されています ([
            Bayesian additive regression trees and the General BART model - PMC
        ](https://pmc.ncbi.nlm.nih.gov/articles/PMC6800811/#:~:text=yourself%20methods%20for%20causal%20inference%3A,DOI))。  
- **ロバスト代入モデル:** 欠測補完時の外れ値やモデル誤特定に頑健な手法として、Tan ら (2019) ([
            Bayesian additive regression trees and the General BART model - PMC
        ](https://pmc.ncbi.nlm.nih.gov/articles/PMC6800811/#:~:text=,2019%3B%204%3A%20ahead%20of%20print))は *“Robust-squared imputation models using BART”* を報告しています。これはBARTにより回帰モデルを柔軟化するとともに、二乗項によるロバスト推定を組み合わせたもので、調査データ中の欠測補完において有効性が確認されています。  

**（d）因果推論への特化:**  
- **バニラBARTの因果推論への適用:** Hill (2011) ([
Bayesian additive regression trees and the General BART model - PMC](https://pmc.ncbi.nlm.nih.gov/articles/PMC6800811/#:~:text=,DOI))はBARTを観察データからの因果効果推定に初めて本格的に適用し、その高い予測能力により処理効果の推定精度が向上することを示しました。具体的には、傾向スコア調整の代替としてBARTを用いることで、介入の平均効果や異質な効果の推定に成功しています ([Bayesian causal forests for multivariate outcomes: application to Irish data from an international large scale education assessment | Journal of the Royal Statistical Society Series A: Statistics in Society | Oxford Academic](https://academic.oup.com/jrsssa/advance-article/doi/10.1093/jrsssa/qnae049/7681717#:~:text=contributions%20to%20this%20area%20was,of%20the%20model%20and%20enables))。この研究以来、BARTは因果推論における強力な手法として注目されるようになりました。

- **Bayesian Causal Forest (BCF):** Hahn ら (2020) ([Bayesian causal forests for multivariate outcomes: application to Irish data from an international large scale education assessment | Journal of the Royal Statistical Society Series A: Statistics in Society | Oxford Academic](https://academic.oup.com/jrsssa/advance-article/doi/10.1093/jrsssa/qnae049/7681717#:~:text=Regression%20Trees%20,estimated%20directly%20from%20the%20data))はHillの手法を発展させ、応答$Y$の生成を**ベースライン効果**$\mu$と**処置効果**$\tau$に分離して別々にモデリングするBART拡張を提案しました。これを**ベイズ的因果の森 (BCF)**と呼び ([Bayesian causal forests for multivariate outcomes: application to Irish data from an international large scale education assessment | Journal of the Royal Statistical Society Series A: Statistics in Society | Oxford Academic](https://academic.oup.com/jrsssa/advance-article/doi/10.1093/jrsssa/qnae049/7681717#:~:text=Regression%20Trees%20,estimated%20directly%20from%20the%20data))、$\mu$と$\tau$にそれぞれ専用の弱情報な事前を与えることで、交絡の制御と処置効果のばらつき推定をより安定して行えるようにしています。BCFは個別効果の直接推定が可能で、従来のBARTよりも交絡調整に強く、因果推論分野で非常に人気の高い手法となっています ([Bayesian causal forests for multivariate outcomes: application to Irish data from an international large scale education assessment | Journal of the Royal Statistical Society Series A: Statistics in Society | Oxford Academic](https://academic.oup.com/jrsssa/advance-article/doi/10.1093/jrsssa/qnae049/7681717#:~:text=et%20al,estimated%20directly%20from%20the%20data))。近年ではBCFの変種として、重要変数に重みを置く事前を導入したもの ([Bayesian causal forests for multivariate outcomes: application to Irish data from an international large scale education assessment | Journal of the Royal Statistical Society Series A: Statistics in Society | Oxford Academic](https://academic.oup.com/jrsssa/advance-article/doi/10.1093/jrsssa/qnae049/7681717#:~:text=become%20one%20of%20the%20most,model%20include%20a%20hierarchical%20version))や、処置効果がある連続変数に沿って滑らかに変化するよう設計したモデル ([Bayesian causal forests for multivariate outcomes: application to Irish data from an international large scale education assessment | Journal of the Royal Statistical Society Series A: Statistics in Society | Oxford Academic](https://academic.oup.com/jrsssa/advance-article/doi/10.1093/jrsssa/qnae049/7681717#:~:text=capabilities%20for%20use%20in%20different,of%20a%20growth%20mindset%20in))、階層構造を組み込んだモデル（例：教育介入効果の学級間変動の分析） ([Bayesian causal forests for multivariate outcomes: application to Irish data from an international large scale education assessment | Journal of the Royal Statistical Society Series A: Statistics in Society | Oxford Academic](https://academic.oup.com/jrsssa/advance-article/doi/10.1093/jrsssa/qnae049/7681717#:~:text=predictor%20variables%20than%20less%20influential,primary%20focus%20of%20our%20study))も提案されており、因果効果推定におけるBARTの応用が拡大しています。

- **サブグループの検出:** 治療効果の異質性の中でも、特定の患者サブグループで有意な効果が現れる場合を検出する試みとして、BARTを利用した手法がいくつかあります。Sivaganesan ら (2017) ([
            Bayesian additive regression trees and the General BART model - PMC
        ](https://pmc.ncbi.nlm.nih.gov/articles/PMC6800811/#:~:text=%5BPubMed%5D%20%5BGoogle%20Scholar%5D%20,PMC%20free%20article))は*“Subgroup finding via BART”*において、応答への寄与が類似した観測をBARTによって自動クラスタリングし、効果の大きいサブグループを発見する方法を示しました。またSchnell ら (2016) ([
            Bayesian additive regression trees and the General BART model - PMC
        ](https://pmc.ncbi.nlm.nih.gov/articles/PMC6800811/#:~:text=Scholar%20scholar.google.com%20%5D%20,PMC%20free%20article))はベイズ的な信用区間に基づくサブグループ同定法を提案し、臨床試験データ中の有効対象群の探索にBARTを活用しています。これらの手法により、従来困難だったデータ駆動型のサブグループ解析が可能になっています。  

## 4. 各手法の比較まとめ

以上の拡張手法について、主要な特徴や適用タスク、計算コストを表にまとめます。

| **手法（拡張カテゴリ）**                          | **主な特徴・目的**                                        | **適用可能なタスク**                      | **計算コスト**                 |
|--------------------------------------------|----------------------------------------------------|------------------------------------|--------------------------|
| **DART（変数選択）** | ディリクレ事前でスプリット確率にスパース性付与。不要変数を抑制 ([Variable Selection Using Bayesian Additive Regression Trees](https://arxiv.org/pdf/2112.13998#:~:text=2,of%20which%20the%20event%20probabilities))。 | 高次元回帰・分類全般                 | 若干増加（変数重要度の追加サンプリング）    |
| **スパイク&スラブBART（変数選択）**  | スパイク・アンド・スラブ事前で不要変数の影響除去。理論的収束保証 ([Sparse prediction informed by genetic annotations using the logit ...](https://pmc.ncbi.nlm.nih.gov/articles/PMC9892284/#:~:text=Sparse%20prediction%20informed%20by%20genetic,useful%20in%20the%20case))。 | 高次元回帰・変数選択                 | 増加（階層事前の追加計算）         |
| **Soft BART（平滑化）** | 確率的分割により予測関数を平滑化。滑らかな真の関数に適合 ([Bayesian Additive Regression Trees: A Review and Look Forward : Annual Reviews](https://www.annualreviews.org/content/journals/10.1146/annurev-statistics-031219-041110#:~:text=Linero%20AR%2C%20Yang%20Y,B%2080%3A1087%E2%80%93110))。       | 回帰全般（特に滑らかな効果）             | 増加（ソフト分割の計算）           |
| **GP-BART（平滑化・空間）** | リーフ予測にGPを導入し空間的相関を表現。平滑かつ空間データに強い ([[2204.02112] GP-BART: a novel Bayesian additive regression trees approach using Gaussian processes](https://arxiv.org/abs/2204.02112#:~:text=whereby%20each%20tree%20explains%20a,modeling%20approaches%20in%20various%20scenarios))。| 回帰（空間データ、滑らかなトレンド）         | 大幅増加（GP計算で**O**($n^3$)） |
| **効率MH提案（MCMC改善）** | 木構造のMH提案を改良し高速化 ([Bayesian additive regression trees and the General BART model - PMC](https://pmc.ncbi.nlm.nih.gov/articles/PMC6800811/#:~:text=Posterior%20Simulation,of%20Binary%20and%20Polychotomous%20Response))。混合促進。                  | BART全般（大規模データのMCMC）           | 減少（同精度で収束が速い）         |
| **Particle Gibbs** | 粒子フィルタ併用で木構造を同時サンプル ([Bayesian Additive Regression Trees: A Review and Look Forward : Annual Reviews](https://www.annualreviews.org/content/journals/10.1146/annurev-statistics-031219-041110#:~:text=))。高次元でも安定。       | BART全般（高次元・複雑構造）            | 増加（粒子数に比例）             |
| **XBART（高速化）** | MCMC不要の逐次木アルゴリズム。高速だがベイズ保証も部分的に維持 ([Bayesian Additive Regression Trees: A Review and Look Forward : Annual Reviews](https://www.annualreviews.org/content/journals/10.1146/annurev-statistics-031219-041110#:~:text=26))。 | BART全般（大規模データ、高速予測）         | 大幅減少（並列化でほぼGBM並み）      |
| **分類BART（二項）**| プロビットデータ拡張で二項応答に対処 ([Bayesian additive regression trees and the General BART model - PMC](https://pmc.ncbi.nlm.nih.gov/articles/PMC6800811/#:~:text=Trees,422%29%3A%20669%E2%80%93679))。                     | 2値分類（医学診断、信用リスクなど）        | やや増加（データ拡張ステップ）       |
| **多クラスBART** | 潜在ガウスモデルで多クラス分類 ([Bayesian additive regression trees and the General BART model - PMC](https://pmc.ncbi.nlm.nih.gov/articles/PMC6800811/#:~:text=,new%20Bayesian%20ensemble%20of%20trees))。                      | 多クラス分類（画像認識、リスク区分）       | 増加（クラス数に比例）            |
| **ロジ線形BART** | 対数リンクでポアソン・二項に対応 ([Bayesian additive regression trees and the General BART model - PMC](https://pmc.ncbi.nlm.nih.gov/articles/PMC6800811/#:~:text=trees,Google%20Scholar))。                      | カウント予測（発生率予測、事故数など）      | 増加（補助変数サンプリング）         |
| **分位点BART** | 分位点損失で学習し外れ値に頑健 ([Bayesian additive regression trees and the General BART model - PMC](https://pmc.ncbi.nlm.nih.gov/articles/PMC6800811/#:~:text=%5BGoogle%20Scholar%5D%20,Google%20Scholar))。                        | 分位点回帰（リスク値、分布予測）         | 増加（損失関数変更による）         |
| **生存BART**| 離散時間生存モデルに拡張。非線形ハザード推定 ([Bayesian additive regression trees and the General BART model - PMC](https://pmc.ncbi.nlm.nih.gov/articles/PMC6800811/#:~:text=,Google%20Scholar))。            | 生存時間解析（医療、生物統計）          | 増加（時点ごとの計算）            |
| **競合リスクBART** | 複数イベント（死因など）の発生を同時にモデル化 ([Bayesian additive regression trees and the General BART model - PMC](https://pmc.ncbi.nlm.nih.gov/articles/PMC6800811/#:~:text=%5BPubMed%5D%20%5BGoogle%20Scholar%5D%20,175%20Google))。        | 競合リスク解析（疫学など）            | 増加                        |
| **BAVART（時系列）**| VARにBARTを組込み非線形時系列に対応。予測精度向上。                      | マクロ経済予測、金融時系列              | 増加（MCMC長大化）             |
| **共有BART**| 離散・連続の混合応答で木構造を共有 ([Bayesian additive regression trees and the General BART model - PMC](https://pmc.ncbi.nlm.nih.gov/articles/PMC6800811/#:~:text=approach%20for%20land%20cover%20classification,Google%20Scholar))。                    | セミ連続データ（費用データ等）           | 増加（複数尤度の同時計算）         |
| **mBART（単調制約）**| 特定変数での単調性を保証 ([[1612.01619] mBART: Multidimensional Monotone BART](https://arxiv.org/abs/1612.01619#:~:text=matter%20considerations%20sometimes%20warrant%20a,mBART%2C%20the%20introduction%20of%20monotonicity))。予測関数が解釈しやすい。            | 単調関係が既知の回帰（薬剤量と効果など）    | 増加（非共役化で収束遅延）         |
| **HBART（異質分散）**| 分散を木モデルで推定 ([[1709.07542] Heteroscedastic BART Via Multiplicative Regression Trees](https://ar5iv.labs.arxiv.org/html/1709.07542#:~:text=a%20constant%20variance%20error%20model,can%20provide%20insights%20into%20the))。予測区間の精度向上。                 | 異質分散データ（金融ボラティリティ等）     | 増加（平均・分散二重モデル）        |
| **欠測補完BART**| 欠測指示を組込み欠測時も予測 ([Bayesian additive regression trees and the General BART model - PMC](https://pmc.ncbi.nlm.nih.gov/articles/PMC6800811/#:~:text=,2019%3B%204%3A%20ahead%20of%20print))。                        | 欠測のある回帰・分類データ             | 増加（欠測処理の組込み）          |
| **順次BART代入**| 変数ごとに逐次BARTで多重代入 ([Bayesian additive regression trees and the General BART model - PMC](https://pmc.ncbi.nlm.nih.gov/articles/PMC6800811/#:~:text=yourself%20methods%20for%20causal%20inference%3A,DOI))。                      | 欠測データの多重代入全般              | 増加（変数数に比例）            |
| **因果推論BART**| BARTで交絡調整し処置効果推定 ([Bayesian causal forests for multivariate outcomes: application to Irish data from an international large scale education assessment](https://academic.oup.com/jrsssa/advance-article/doi/10.1093/jrsssa/qnae049/7681717#:~:text=contributions%20to%20this%20area%20was,of%20the%20model%20and%20enables))。                        | 観察研究の因果効果推定               | 増加（推定対象が複雑）           |
| **BCF（因果の森）** | $\mu$と$\tau$を分離モデリング ([Bayesian causal forests for multivariate outcomes: application to Irish data from an international large scale education assessment](https://academic.oup.com/jrsssa/advance-article/doi/10.1093/jrsssa/qnae049/7681717#:~:text=Regression%20Trees%20,estimated%20directly%20from%20the%20data))。異質効果に強い。           | 因果効果推定（個別効果の推定）          | 増加（モデル複雑化）            |
| **サブグループBART**| BARTで効果の大きい群を発見 ([Bayesian additive regression trees and the General BART model - PMC](https://pmc.ncbi.nlm.nih.gov/articles/PMC6800811/#:~:text=%5BPubMed%5D%20%5BGoogle%20Scholar%5D%20,PMC%20free%20article))。                       | 個別化医療、顧客セグメント分析           | 増加（多数比較の補正必要）         |

※表中の計算コストは概略的な比較であり、実際の所要時間は実装やデータサイズによります。

## 5. 最新の研究動向（過去5年間）

過去5年ほどの間に、BARTの研究はさらなる柔軟性と応用範囲の拡大に焦点が当てられています。まず**一般化BART**の分野では、Linero (2022)が*“Generalized BART models: Beyond conditional conjugacy”*を提唱し ([[PDF] CRAN - SoftBart: Soft Bayesian Additive Regression Trees](https://cran.r-project.org/web/packages/SoftBart/vignettes/SoftBart-Vig.pdf#:~:text=Trees%20cran.r,09924))、生存時間、異質分散、カウントデータなど条件付き共役性の枠に収まらない状況へBARTを適用する統一的フレームワークを示しました。この動向により、従来個別に開発されていた生存BARTやロジ線形BARTなどが理論的に整理され、任意の確率的応答変数にBARTを拡張する基盤が整いつつあります。

また、**平滑性と構造の組み込み**もトレンドの一つです。2020年代に入りLinero氏らによるSoft BART ([Bayesian Additive Regression Trees: A Review and Look Forward | Annual Reviews](https://www.annualreviews.org/content/journals/10.1146/annurev-statistics-031219-041110#:~:text=Linero%20AR%2C%20Yang%20Y,B%2080%3A1087%E2%80%93110))やGP-BART ([[2204.02112] GP-BART: a novel Bayesian additive regression trees approach using Gaussian processes](https://arxiv.org/abs/2204.02112#:~:text=whereby%20each%20tree%20explains%20a,modeling%20approaches%20in%20various%20scenarios))のように、「木」による区分的定数モデルを滑らかに改善するアプローチが登場しました。これらは深層学習に対抗する性能を視野に、勾配に基づく最適化やガウス過程とのハイブリッドでBARTを洗練させています。さらに2024年にはDeshpandeらによる**斜め分割BART (Oblique BART)**が報告され、線形結合によるハイパープレーンで特徴空間を分割することで、従来の軸平行分割よりも表現力を高めることに成功しています ([[2411.08849] Oblique Bayesian additive regression trees](https://arxiv.org/abs/2411.08849#:~:text=are%20based%20on%20axis,sometimes%20much%20better%20than))。これは勾配ブースティングの世界で知られるoblique treeをベイズ文脈に取り入れたもので、いくつかのデータセットで予測精度の向上が確認されています ([[2411.08849] Oblique Bayesian additive regression trees](https://arxiv.org/abs/2411.08849#:~:text=exhibit%20excellent%20theoretical%20properties,those%20methods))。

**因果推論分野**では、BART系モデルが標準的手法の一つとして定着しつつあり、特にBCFはその後様々な拡張が施されています ([Bayesian causal forests for multivariate outcomes: application to Irish data from an international large scale education assessment | Journal of the Royal Statistical Society Series A: Statistics in Society | Oxford Academic](https://academic.oup.com/jrsssa/advance-article/doi/10.1093/jrsssa/qnae049/7681717#:~:text=become%20one%20of%20the%20most,of%20a%20growth%20mindset%20in))。近年の研究例として、BCFにスパース事前を組み込んで交絡変数と効果修飾変数を区別しやすくしたモデル ([Bayesian causal forests for multivariate outcomes: application to Irish data from an international large scale education assessment | Journal of the Royal Statistical Society Series A: Statistics in Society | Oxford Academic](https://academic.oup.com/jrsssa/advance-article/doi/10.1093/jrsssa/qnae049/7681717#:~:text=capabilities%20for%20use%20in%20different,model%20include%20a%20hierarchical%20version))や、時間や距離といった連続軸に沿って処置効果が変化するような構造を持たせたモデルが提案されています。また、複数アウトカムに対する因果効果推定へのBART適用や、階層的データ（例: 学校内生徒データ）のための階層ベイズBARTも試みられています ([Bayesian causal forests for multivariate outcomes: application to Irish data from an international large scale education assessment | Journal of the Royal Statistical Society Series A: Statistics in Society | Oxford Academic](https://academic.oup.com/jrsssa/advance-article/doi/10.1093/jrsssa/qnae049/7681717#:~:text=predictor%20variables%20than%20less%20influential,primary%20focus%20of%20our%20study))。これらの発展は、政策効果の評価や医療介入の効能検証といった実社会の問題において、BARTを用いた柔軟な因果解析を可能にしています。

**計算環境とソフトウェアの進展**も重要です。R言語のパッケージ「**dbarts**」や「**BART**」に加え、近年はPythonの「**PyMC-BART**」やStanと連携した「**stan4bart**」 ([Stan and BART for Causal Inference: Estimating Heterogeneous ...](https://www.mdpi.com/1099-4300/24/12/1782#:~:text=Stan%20and%20BART%20for%20Causal,for%20fitting%20nonlinear%20response))など、BARTを手軽に利用できるツールが整備されています。特にstan4bartはHMC（ハミルトニアンモンテカルロ）によるサンプリングとBARTを組み合わせ、半パラメトリックBARTのパラメータ推定を安定化する試みであり、計算の重いBARTモデルにも高速かつ収束の良い推論をもたらす可能性があります ([Stan and BART for Causal Inference: Estimating Heterogeneous ...](https://www.mdpi.com/1099-4300/24/12/1782#:~:text=Stan%20and%20BART%20for%20Causal,for%20fitting%20nonlinear%20response))。また、GPU並列計算によるBARTの高速化や、大規模データに対する分割統治法的アプローチも研究が進んでいます。

総じて、BARTの拡張研究は「**より多様なデータタイプや問題設定に対応しつつ、計算効率と理論的保証を両立させる**」方向に発展しています。最新の動向としては、柔軟性を維持したままモデル構造を洗練する（平滑化や斜め分割）、高次元への適応や計算効率化（スパース事前や高速アルゴリズム）、そして因果推論など特定タスクへの特化が挙げられます。それに伴い、理論面でもBARTのPosterior濃度や収束性に関する研究 ([Bayesian additive regression trees and the General BART model - PMC](https://pmc.ncbi.nlm.nih.gov/articles/PMC6800811/#:~:text=,Google%20Scholar))が進み、実用面でも各種パッケージの整備によって統計・機械学習コミュニティでBARTが一層使いやすくなっています。これらの動向は今後も続くと見込まれ、BARTは統計的予測モデルのプラットフォームとしてさらなる発展を遂げていくでしょう。

