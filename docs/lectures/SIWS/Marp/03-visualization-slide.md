---
marp: true
size: 16:9
paginate: true
theme: gaia
backgroundColor: #fff
math: katex
---
<!-- header: 'T. Nakamura | Juntendo Univ.' -->
<!-- footer: '2025/02/08' -->
<style>
section { 
    font-size: 20px; 
}
img[alt~="center"] {
  display: block;
  margin: 0 auto;
}
/* ãƒšãƒ¼ã‚¸ç•ªå· */
section::after {
    content: attr(data-marpit-pagination) ' / ' attr(data-marpit-pagination-total);
    fonr-size: 60%;
}
/* ç™ºè¡¨ä¼šå */
header {
    width: 100%;
    position: absolute;
    top: unset;
    bottom: 21px;
    left: 0;
    text-align: center;
    font-size: 60%;
}
/* æ—¥ä»˜ */
footer {
    text-align: center;
    font-size: 15px;
}
</style>


<!--
_class: lead
_paginate: false
-->

![bg left:50% 80%](./02-figure/main.png)

# ãƒ‡ãƒ¼ã‚¿ãƒ©ãƒ³ã‚°ãƒªãƒ³ã‚°å…¥é–€
## Python `pandas` ã‚’ä½¿ã£ãŸãƒ‡ãƒ¼ã‚¿åŠ å·¥

## HDS ä¸­æ‘ çŸ¥ç¹

---

## ã“ã‚Œã¾ã§ã®å­¦ç¿’ã¨æœ¬æ—¥ã®ãƒ†ãƒ¼ãƒ

**ã“ã‚Œã¾ã§ã®å­¦ç¿’:**
* ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ã®åŸºæœ¬çš„ãªç¢ºèªæ–¹æ³•
* `matplotlib`ã‚„`seaborn`ã‚’ä½¿ã£ãŸãƒ‡ãƒ¼ã‚¿ã®å¯è¦–åŒ–
    * æ•£å¸ƒå›³ã€æŠ˜ã‚Œç·šã‚°ãƒ©ãƒ•ã€ç®±ã²ã’å›³ã€ãƒ’ã‚¹ãƒˆã‚°ãƒ©ãƒ ã€æ£’ã‚°ãƒ©ãƒ•ãªã©

**ã“ã®ç« ã§å­¦ã¶ã“ã¨ï¼šãƒ‡ãƒ¼ã‚¿ãƒ©ãƒ³ã‚°ãƒªãƒ³ã‚°**
`pandas`ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ã£ãŸä¸»è¦ãªãƒ‡ãƒ¼ã‚¿åŠ å·¥ãƒ»æ•´å½¢æ“ä½œã‚’å­¦ã³ã¾ã™ã€‚

---
## ãƒ‡ãƒ¼ã‚¿ãƒ©ãƒ³ã‚°ãƒªãƒ³ã‚°ã¨ã¯ï¼Ÿ

ãƒ‡ãƒ¼ã‚¿åˆ†æã®å‰å‡¦ç†ã¨ã—ã¦éå¸¸ã«é‡è¦ãªå·¥ç¨‹ã§ã™ã€‚ä¸»ãªæ“ä½œã«ã¯ä»¥ä¸‹ã®ã‚ˆã†ãªã‚‚ã®ãŒã‚ã‚Šã¾ã™ã€‚

1.  **è¡Œã®ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°**: æ¡ä»¶ã«åˆã†è¡Œã ã‘ã‚’é¸ã¶ã€‚
2.  **åˆ—ã®é›†è¨ˆ**: åˆ—ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰å¹³å‡ã‚„åˆè¨ˆãªã©ã®è¦ç´„çµ±è¨ˆé‡ã‚’è¨ˆç®—ã™ã‚‹ã€‚
3.  **ã‚°ãƒ«ãƒ¼ãƒ—åŒ–**: ç‰¹å®šã®åˆ—ã®å€¤ã«åŸºã¥ã„ã¦è¡Œã‚’ã‚°ãƒ«ãƒ¼ãƒ—ã«ã¾ã¨ã‚ã€ã‚°ãƒ«ãƒ¼ãƒ—ã”ã¨ã®é›†è¨ˆã‚’è¡Œã†ã€‚
4.  **åˆ—ã®ä½œæˆãƒ»å¤‰æ›**: æ—¢å­˜ã®åˆ—ã‹ã‚‰æ–°ã—ã„åˆ—ã‚’ä½œã£ãŸã‚Šã€åˆ—ã®å€¤ã‚’å¤‰æ›ã—ãŸã‚Šã™ã‚‹ã€‚
5.  **ä¸¦ã¹æ›¿ãˆ**: ç‰¹å®šã®åˆ—ã®å€¤ã«åŸºã¥ã„ã¦è¡Œã‚’ä¸¦ã³æ›¿ãˆã‚‹ã€‚
6.  **çµåˆ**: è¤‡æ•°ã®ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ã‚’ç‰¹å®šã®ã‚­ãƒ¼ã‚’ä½¿ã£ã¦ã¤ãªãåˆã‚ã›ã‚‹ã€‚

---
## ãªãœ `pandas` ã‚’å­¦ã¶ã®ã‹ï¼Ÿ

* Pythonã§ãƒ‡ãƒ¼ã‚¿åˆ†æã‚’è¡Œã†éš›ã®ä¸­å¿ƒçš„ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã€‚
* **SQLã¨ã®é¡ä¼¼æ€§**:
    * `pandas`ã®æ“ä½œã¯ã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ“ä½œè¨€èªã§ã‚ã‚‹SQLï¼ˆStructured Query Languageï¼‰ã®è€ƒãˆæ–¹ã¨å…±é€šã™ã‚‹éƒ¨åˆ†ãŒå¤šãã‚ã‚Šã¾ã™ã€‚
    * SQLã¯å¤§é‡ãƒ‡ãƒ¼ã‚¿ã‚’åŠ¹ç‡çš„ã«æ‰±ã†ãŸã‚ã«åºƒãåˆ©ç”¨ã•ã‚Œã¦ãŠã‚Šã€`pandas`ã‚’å­¦ã¶ã“ã¨ã¯SQLã®ç†è§£ã«ã‚‚ç¹‹ãŒã‚Šã¾ã™ã€‚

---
## æº–å‚™ï¼šãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¨ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆ

ã¾ãšã€å¿…è¦ãªãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ã€ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚’èª­ã¿è¾¼ã¿ã¾ã™ã€‚
ä»Šå›ã¯`seaborn`ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã«å«ã¾ã‚Œã‚‹`iris`ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆï¼ˆã‚¢ãƒ¤ãƒ¡ã®èŠ±ã®ãƒ‡ãƒ¼ã‚¿ï¼‰ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚

```python
import pandas as pd
import seaborn as sns
import numpy as np # æ•°å€¤è¨ˆç®—ã§åˆ©ç”¨

# seabornã‹ã‚‰irisãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚’ãƒ­ãƒ¼ãƒ‰
iris_df = sns.load_dataset('iris')

# ãƒ‡ãƒ¼ã‚¿ã®æœ€åˆã®5è¡Œã‚’ç¢ºèª
print("--- ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã®æœ€åˆã®5è¡Œ ---")
print(iris_df.head())
# print("\n--- ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã®åŸºæœ¬æƒ…å ± ---")
# iris_df.info() # ã‚¹ãƒ©ã‚¤ãƒ‰ã§ã¯å‡ºåŠ›ã‚’çœç•¥ã™ã‚‹å ´åˆã‚ã‚Š
# print("\n--- ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã®è¦ç´„çµ±è¨ˆé‡ ---")
# print(iris_df.describe()) # ã‚¹ãƒ©ã‚¤ãƒ‰ã§ã¯å‡ºåŠ›ã‚’çœç•¥ã™ã‚‹å ´åˆã‚ã‚Š
```

---
## ãƒ¡ã‚½ãƒƒãƒ‰ãƒã‚§ãƒ¼ãƒ³ï¼šå‡¦ç†ã‚’ç¹‹ã’ã‚‹æ›¸ãæ–¹

`pandas`ã§ã¯ã€è¤‡æ•°ã®ãƒ‡ãƒ¼ã‚¿æ“ä½œã‚’`.`ï¼ˆãƒ‰ãƒƒãƒˆï¼‰ã§ç¹‹ã’ã¦é€£ç¶šçš„ã«è¨˜è¿°ã™ã‚‹**ãƒ¡ã‚½ãƒƒãƒ‰ãƒã‚§ãƒ¼ãƒ³**ãŒã‚ˆãä½¿ã‚ã‚Œã¾ã™ã€‚

**ä¾‹ï¼š** ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ  `df` ã«æ“ä½œ `f()`ã€`g()`ã€`h()` ã‚’é †ç•ªã«é©ç”¨
```python
# result = df.f().g().h()
```
èª­ã¿æ–¹ï¼š
1.  `df` ã‚’ç”¨æ„ã€‚
2.  `df` ã« `f()` ã‚’é©ç”¨ã€‚
3.  ãã®çµæœã« `g()` ã‚’é©ç”¨ã€‚
4.  ã•ã‚‰ã«ãã®çµæœã« `h()` ã‚’é©ç”¨ã€‚

ã“ã®ç« ã§å­¦ã¶æ“ä½œã®å¤šãã¯ã€ãƒ¡ã‚½ãƒƒãƒ‰ãƒã‚§ãƒ¼ãƒ³ã§ç°¡æ½”ã«è¨˜è¿°ã§ãã¾ã™ã€‚

---
## 1. è¡Œã®ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ï¼šæ¡ä»¶ã«åˆã†ãƒ‡ãƒ¼ã‚¿ã‚’é¸ã¶

ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã®ä¸­ã‹ã‚‰ã€ç‰¹å®šã®æ¡ä»¶ã‚’æº€ãŸã™è¡Œã ã‘ã‚’æŠ½å‡ºã—ã¾ã™ã€‚

**ä¾‹1ï¼šå“ç¨® (`species`) ãŒ `setosa` ã®ãƒ‡ãƒ¼ã‚¿ã‚’æŠ½å‡º**
```python
# é€šå¸¸ã®ãƒ–ãƒ¼ãƒ«ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹
setosa_df = iris_df[iris_df['species'] == 'setosa']
print(setosa_df.head())
```
**`query`ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ã£ãŸå ´åˆ (ã‚ˆã‚ŠSQLãƒ©ã‚¤ã‚¯)**
```python
setosa_df_query = iris_df.query("species == 'setosa'")
print(setosa_df_query.head())
```

---
### è¡Œã®ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ï¼šè¤‡æ•°ã®æ¡ä»¶

è¤‡æ•°ã®æ¡ä»¶ã‚’çµ„ã¿åˆã‚ã›ã‚‹ã“ã¨ã‚‚å¯èƒ½ã§ã™ã€‚
* `&`: AND (ã‹ã¤)
* `|`: OR (ã¾ãŸã¯)
* `~`: NOT (å¦å®š)
* æ¯”è¼ƒæ¼”ç®—å­: `>`, `<`, `>=`, `<=`, `!=`

**ä¾‹2ï¼šã€Œå“ç¨®ãŒ `versicolor` ã§ã€ã‹ã¤èŠ±ã³ã‚‰ã®é•·ã• (`petal_length`) ãŒ4.5cmã‚ˆã‚Šå¤§ãã„ã€ãƒ‡ãƒ¼ã‚¿**
```python
versicolor_long_petal = iris_df[
    (iris_df['species'] == 'versicolor') & (iris_df['petal_length'] > 4.5)
]
print(versicolor_long_petal)
```
```python
# queryãƒ¡ã‚½ãƒƒãƒ‰ã®å ´åˆ
# versicolor_long_petal_query = iris_df.query(
#     "species == 'versicolor' and petal_length > 4.5"
# )
```

---
### è¡Œã®ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ï¼š`isin()` ãƒ¡ã‚½ãƒƒãƒ‰

ãƒªã‚¹ãƒˆã«å«ã¾ã‚Œã‚‹ã„ãšã‚Œã‹ã®å€¤ã§ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã™ã‚‹å ´åˆã€`isin()` ãƒ¡ã‚½ãƒƒãƒ‰ãŒä¾¿åˆ©ã§ã™ã€‚

**ä¾‹3ï¼šå“ç¨®ãŒ `setosa` ã¾ãŸã¯ `virginica` ã®ãƒ‡ãƒ¼ã‚¿**
```python
setosa_virginica_df = iris_df[iris_df['species'].isin(['setosa', 'virginica'])]
print(setosa_virginica_df.sample(5)) # ãƒ©ãƒ³ãƒ€ãƒ ã«5è¡Œè¡¨ç¤º
```

---
## 2. åˆ—ã®é›†è¨ˆï¼šãƒ‡ãƒ¼ã‚¿ã®ç‰¹å¾´ã‚’æ´ã‚€

ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ã®åˆ—ã«å¯¾ã—ã€å¹³å‡ã€åˆè¨ˆã€æœ€å¤§å€¤ã€æœ€å°å€¤ãªã©ã®**è¦ç´„çµ±è¨ˆé‡**ã‚’è¨ˆç®—ã—ã¾ã™ã€‚

**ä¾‹ï¼š`sepal_length`ï¼ˆãŒãã®é•·ã•ï¼‰ã®å¹³å‡ã¨æ¨™æº–åå·®**
```python
mean_sl = iris_df['sepal_length'].mean()
std_sl = iris_df['sepal_length'].std()
print(f"ãŒãã®é•·ã• å¹³å‡: {mean_sl:.2f} cm, æ¨™æº–åå·®: {std_sl:.2f} cm")
```
**è¤‡æ•°ã®çµ±è¨ˆé‡ã‚’ä¸€åº¦ã«è¨ˆç®— (`agg`ãƒ¡ã‚½ãƒƒãƒ‰)**
```python
summary_stats = iris_df['sepal_length'].agg(['mean', 'std', 'min', 'max'])
print(summary_stats)
```
æ¬ æå€¤(`NaN`)ã¯ã€å¤šãã®é›†è¨ˆé–¢æ•°ã§ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ç„¡è¦–ã•ã‚Œã¾ã™ã€‚

---
### ä¸»ãªé›†è¨ˆé–¢æ•°

* `mean()`: å¹³å‡å€¤
* `std()`: æ¨™æº–åå·®
* `median()`: ä¸­å¤®å€¤
* `min()`, `max()`: æœ€å°å€¤ã€æœ€å¤§å€¤
* `sum()`: åˆè¨ˆ
* `count()`: ä»¶æ•° (éæ¬ æå€¤ã®æ•°)
* `quantile(q=0.25)`: å››åˆ†ä½æ•° (ä¾‹: 0.25ã§ç¬¬ä¸€å››åˆ†ä½æ•°)
* `nunique()`: ãƒ¦ãƒ‹ãƒ¼ã‚¯ãªå€¤ã®æ•°
* `var()`: åˆ†æ•£

---
## 3. ã‚°ãƒ«ãƒ¼ãƒ—åŒ–ï¼šã‚°ãƒ«ãƒ¼ãƒ—ã”ã¨ã®ç‰¹å¾´ã‚’è¦‹ã‚‹

ç‰¹å®šã®åˆ—ã®å€¤ã«åŸºã¥ã„ã¦ãƒ‡ãƒ¼ã‚¿ã‚’ã‚°ãƒ«ãƒ¼ãƒ—åˆ†ã‘ã—ã€å„ã‚°ãƒ«ãƒ¼ãƒ—ã«å¯¾ã—ã¦é›†è¨ˆå‡¦ç†ã‚’è¡Œã„ã¾ã™ã€‚
`groupby()` ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚

**ä¾‹1ï¼šå“ç¨® (`species`) ã”ã¨ã«å„ç‰¹å¾´é‡ã®å¹³å‡å€¤ã‚’è¨ˆç®—**
```python
species_mean_df = iris_df.groupby('species').mean()
print(species_mean_df)
```
`groupby()`å®Ÿè¡Œæ™‚ç‚¹ã§ã¯ã‚°ãƒ«ãƒ¼ãƒ—åŒ–ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒç”Ÿæˆã•ã‚Œã€ãã®å¾Œã«é›†è¨ˆé–¢æ•° (`mean()`, `sum()`, `agg()`ãªã©) ã‚’é©ç”¨ã™ã‚‹ã¨è¨ˆç®—ãŒå®Ÿè¡Œã•ã‚Œã¾ã™ã€‚

---
### ã‚°ãƒ«ãƒ¼ãƒ—åŒ–ï¼šç™ºå±•çš„ãªé›†è¨ˆ

**ä¾‹2ï¼šå“ç¨®ã”ã¨ã®èŠ±ã³ã‚‰ã®é•·ã• (`petal_length`) ã®å¹³å‡**
```python
petal_len_mean_by_species = iris_df.groupby('species')['petal_length'].mean()
print(petal_len_mean_by_species)
```
**ä¾‹3ï¼šå“ç¨®ã”ã¨ã®èŠ±ã³ã‚‰ã®é•·ã•ã®é›†è¨ˆ (å¹³å‡, æ¨™æº–åå·®, å€‹æ•°)**
```python
petal_summary = iris_df.groupby('species')['petal_length'].agg(['mean', 'std', 'count'])
print(petal_summary)
```

---
## 4. åˆ—ã®ä½œæˆãƒ»å¤‰æ›ï¼šæ–°ã—ã„æƒ…å ±ã‚’åŠ ãˆã‚‹

æ—¢å­˜ã®åˆ—ã®å€¤ã‚’ä½¿ã£ã¦æ–°ã—ã„åˆ—ã‚’ä½œæˆã—ãŸã‚Šã€åˆ—ã®å€¤ã‚’å¤‰æ›ã—ãŸã‚Šã—ã¾ã™ã€‚

**ä¾‹ï¼šèŠ±ã³ã‚‰ã®é¢ç© (`petal_area`) ã‚’ `petal_length * petal_width` ã§è¨ˆç®—**

**æ–¹æ³•1ï¼šç›´æ¥ä»£å…¥**
```python
iris_df_mutated = iris_df.copy() # å…ƒã®ãƒ‡ãƒ¼ã‚¿ã‚’å¤‰æ›´ã—ãªã„ãŸã‚ã«ã‚³ãƒ”ãƒ¼
iris_df_mutated['petal_area'] = \
    iris_df_mutated['petal_length'] * iris_df_mutated['petal_width']
print(iris_df_mutated[['petal_length', 'petal_width', 'petal_area']].head())
```

---
### åˆ—ã®ä½œæˆãƒ»å¤‰æ›ï¼š`assign()` ãƒ¡ã‚½ãƒƒãƒ‰

`assign()` ãƒ¡ã‚½ãƒƒãƒ‰ã¯ã€æ–°ã—ã„åˆ—ã‚’è¿½åŠ ã—ãŸãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ã‚’è¿”ã—ã¾ã™ (å…ƒã®ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ã¯å¤‰æ›´ã—ã¾ã›ã‚“)ã€‚ãƒ¡ã‚½ãƒƒãƒ‰ãƒã‚§ãƒ¼ãƒ³ã«é©ã—ã¦ã„ã¾ã™ã€‚

**æ–¹æ³•2ï¼š`assign`ãƒ¡ã‚½ãƒƒãƒ‰**
```python
iris_df_assigned = iris_df.assign(
    petal_area = iris_df['petal_length'] * iris_df['petal_width'],
    sepal_area = iris_df['sepal_length'] * iris_df['sepal_width']
)
print(iris_df_assigned[['species', 'petal_area', 'sepal_area']].head())
```

---
## 5. ä¸¦ã¹æ›¿ãˆï¼šãƒ‡ãƒ¼ã‚¿ã‚’é †åºä»˜ã‘ã‚‹

ç‰¹å®šã®åˆ—ã®å€¤ã«åŸºã¥ã„ã¦ã€ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ã®è¡Œã‚’æ˜‡é †ã¾ãŸã¯é™é †ã«ä¸¦ã¹æ›¿ãˆã¾ã™ã€‚
`sort_values()` ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚

**ä¾‹1ï¼šèŠ±ã³ã‚‰ã®é•·ã• (`petal_length`) ãŒå¤§ãã„é †ï¼ˆé™é †ï¼‰ã«ä¸¦ã¹æ›¿ãˆ**
```python
sorted_iris_df = iris_df.sort_values(by='petal_length', ascending=False)
print(sorted_iris_df[['species', 'petal_length']].head())
```
* `ascending=True`: æ˜‡é † (ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ)
* `ascending=False`: é™é †

---
### ä¸¦ã¹æ›¿ãˆï¼šè¤‡æ•°ã‚­ãƒ¼ã§ã®ã‚½ãƒ¼ãƒˆ

è¤‡æ•°ã®ã‚­ãƒ¼ï¼ˆåˆ—ï¼‰ã‚’æŒ‡å®šã—ã¦ä¸¦ã¹æ›¿ãˆã‚‹ã“ã¨ã‚‚å¯èƒ½ã§ã™ã€‚

**ä¾‹2ï¼šå“ç¨® (`species`) ã§æ˜‡é †ã€ãã®ä¸­ã§èŠ±ã³ã‚‰ã®é•·ã• (`petal_length`) ã§é™é †**
```python
sorted_multi_key = iris_df.sort_values(
    by=['species', 'petal_length'],
    ascending=[True, False] # speciesã¯æ˜‡é †, petal_lengthã¯é™é †
)
print(sorted_multi_key[['species', 'petal_length']].head(10))
```

---
## 6. çµåˆï¼šè¤‡æ•°ã®ãƒ‡ãƒ¼ã‚¿ã‚’ç¹‹ãåˆã‚ã›ã‚‹

2ã¤ä»¥ä¸Šã®ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ã‚’ã€å…±é€šã®ã‚­ãƒ¼ï¼ˆåˆ—ï¼‰ã‚’ã‚‚ã¨ã«æ¨ªã«ç¹‹ãåˆã‚ã›ã¾ã™ã€‚
`merge()` ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚

**ä¾‹ï¼š`iris`ãƒ‡ãƒ¼ã‚¿ã«æ—¥æœ¬èªã®å“ç¨®åæƒ…å ±ã‚’çµåˆ**
ã¾ãšã€æ—¥æœ¬èªå“ç¨®åã‚’æŒã¤ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ã‚’ä½œæˆã—ã¾ã™ã€‚
```python
species_jpn_df = pd.DataFrame({
    'species': ['setosa', 'versicolor', 'virginica'],
    'species_jpn': ['ãƒ’ã‚ªã‚¦ã‚®ã‚¢ãƒ¤ãƒ¡', 'ãƒ–ãƒ«ãƒ¼ãƒ•ãƒ©ãƒƒã‚°', 'ãƒãƒ¼ã‚¸ãƒ‹ã‚«']
})
print("--- æ—¥æœ¬èªå“ç¨®åãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ  ---")
print(species_jpn_df)
```

---
### çµåˆï¼š`merge()` ã®å®Ÿè¡Œ

`on`å¼•æ•°ã§ã‚­ãƒ¼ã¨ãªã‚‹åˆ—ã‚’æŒ‡å®šã—ã¾ã™ã€‚`how`å¼•æ•°ã§çµåˆæ–¹æ³•ã‚’æŒ‡å®šã—ã¾ã™ï¼ˆ`left`, `right`, `inner`, `outer`ï¼‰ã€‚
```python
merged_iris_df = pd.merge(iris_df, species_jpn_df, on='species', how='left')
# how='left': å·¦å´(iris_df)ã®å…¨è¡Œã‚’æ®‹ã—ã€å³å´(species_jpn_df)ã‹ã‚‰æƒ…å ±ã‚’ä»˜åŠ 

print("\n--- æ—¥æœ¬èªå“ç¨®åã¨çµåˆã—ãŸãƒ‡ãƒ¼ã‚¿ (ã‚µãƒ³ãƒ—ãƒ«) ---")
print(merged_iris_df.sample(5))
```
ã‚­ãƒ¼åˆ—åãŒå·¦å³ã§ç•°ãªã‚‹å ´åˆã¯ `left_on`, `right_on` ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚

---
## ãã®ä»–ã®ä¾¿åˆ©ãªæ“ä½œ

ä¸Šè¨˜ä»¥å¤–ã«ã‚‚ã€ãƒ‡ãƒ¼ã‚¿ãƒ©ãƒ³ã‚°ãƒªãƒ³ã‚°ã§å½¹ç«‹ã¤åŸºæœ¬çš„ãªæ“ä½œãŒã‚ã‚Šã¾ã™ã€‚

* **åˆ—ã®é¸æŠ**: ç‰¹å®šã®åˆ—ã ã‘ã‚’é¸ã³å‡ºã™ã€‚
* **åˆ—åã®å¤‰æ›´**: åˆ—ã®åå‰ã‚’å¤‰æ›´ã™ã‚‹ã€‚
* **ä¸Šä½/ä¸‹ä½Nä»¶ã®å–å¾—**: ç‰¹å®šã®æ¡ä»¶ã§ãƒˆãƒƒãƒ—Nã®ãƒ‡ãƒ¼ã‚¿ã‚’æŠ½å‡ºã€‚

---
### ãã®ä»–ã®æ“ä½œï¼šåˆ—ã®é¸æŠ

ç‰¹å®šã®åˆ—ã ã‘ã‚’é¸ã³å‡ºã™ã«ã¯ã€åˆ—åã‚’ãƒªã‚¹ãƒˆã§æŒ‡å®šã—ã¾ã™ã€‚

```python
# 'species', 'petal_length', 'petal_width' ã®3åˆ—ã‚’é¸æŠ
selected_columns_df = iris_df[['species', 'petal_length', 'petal_width']]
print(selected_columns_df.head())
```
ç‰¹å®šã®åˆ—ã‚’å‰Šé™¤ã™ã‚‹ã«ã¯ `drop()` ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚
```python
# 'sepal_width' åˆ—ã‚’å‰Šé™¤ (axis=1ã§åˆ—ã‚’æŒ‡å®š)
# dropped_df = iris_df.drop('sepal_width', axis=1)
# print(dropped_df.head())
```

---
### ãã®ä»–ã®æ“ä½œï¼šåˆ—åã®å¤‰æ›´

`rename()` ãƒ¡ã‚½ãƒƒãƒ‰ã§åˆ—åã‚’å¤‰æ›´ã—ã¾ã™ã€‚

```python
renamed_df = iris_df.rename(columns={
    'sepal_length': 'gaku_nagasa_cm', # ãŒãã®é•·ã•(cm)
    'sepal_width': 'gaku_haba_cm',   # ãŒãã®å¹…(cm)
    'petal_length': 'kaben_nagasa_cm',# èŠ±å¼ã®é•·ã•(cm)
    'petal_width': 'kaben_haba_cm'   # èŠ±å¼ã®å¹…(cm)
})
print(renamed_df.head())
```

---
### ãã®ä»–ã®æ“ä½œï¼šä¸Šä½/ä¸‹ä½Nä»¶ã®å–å¾—

`nlargest()` ã‚„ `nsmallest()` ãƒ¡ã‚½ãƒƒãƒ‰ã§ã€ç‰¹å®šã®åˆ—ã®å€¤ãŒå¤§ãã„/å°ã•ã„é †ã«Nä»¶ã®ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ã¾ã™ã€‚

```python
# petal_length ãŒå¤§ãã„ä¸Šä½3ä»¶
top_3_petal_length = iris_df.nlargest(3, 'petal_length')
print("--- èŠ±å¼ã®é•·ã•ãŒå¤§ãã„ä¸Šä½3ä»¶ ---")
print(top_3_petal_length)

# petal_length ãŒå°ã•ã„ä¸Šä½3ä»¶
# smallest_3_petal_length = iris_df.nsmallest(3, 'petal_length')
```

---
## ã¾ã¨ã‚ï¼šãƒ‡ãƒ¼ã‚¿ãƒ©ãƒ³ã‚°ãƒªãƒ³ã‚°æ“ä½œä¸€è¦§

| æ“ä½œ             | `pandas`ã§ã®ä¸»ãªå®Ÿç¾æ–¹æ³•                                       | èª¬æ˜                                                                 |
| ---------------- | ------------------------------------------------------------ | -------------------------------------------------------------------- |
| è¡Œã®ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°   | `[]` (ãƒ–ãƒ¼ãƒ«ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹), `query()`                             | æ¡ä»¶ã«åˆã†è¡Œã‚’é¸æŠã™ã‚‹                                                 |
| åˆ—ã®é›†è¨ˆ         | `mean()`, `sum()`, `agg()` ãªã©                                 | åˆ—ã®å€¤ã‚’è¦ç´„çµ±è¨ˆé‡ã§ã¾ã¨ã‚ã‚‹                                           |
| ã‚°ãƒ«ãƒ¼ãƒ—åŒ–       | `groupby()` ã¨é›†è¨ˆé–¢æ•°                                          | ã‚°ãƒ«ãƒ¼ãƒ—ã”ã¨ã«é›†è¨ˆã™ã‚‹                                                 |
| åˆ—ã®ä½œæˆãƒ»å¤‰æ›   | ç›´æ¥ä»£å…¥, `assign()`                                           | æ—¢å­˜ã®åˆ—ã‹ã‚‰æ–°ã—ã„åˆ—ã‚’ä½œæˆã—ãŸã‚Šã€å€¤ã‚’å¤‰æ›ã—ãŸã‚Šã™ã‚‹                     |
| ä¸¦ã¹æ›¿ãˆ         | `sort_values()`                                                | ç‰¹å®šã®åˆ—ã®å€¤ã«åŸºã¥ã„ã¦è¡Œã‚’ä¸¦ã³æ›¿ãˆã‚‹                                     |
| çµåˆ             | `merge()`                                                      | å…±é€šã®ã‚­ãƒ¼ã‚’ä½¿ã£ã¦è¤‡æ•°ã®ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ã‚’ç¹‹ãåˆã‚ã›ã‚‹                   |
| åˆ—ã®é¸æŠ         | `[]`, `loc[]`, `iloc[]`, `drop()`                              | ç‰¹å®šã®åˆ—ã‚’é¸ã³å‡ºã™ã€ã¾ãŸã¯å‰Šé™¤ã™ã‚‹                                       |
| åˆ—åã®å¤‰æ›´       | `rename()`                                                     | åˆ—ã®åå‰ã‚’å¤‰æ›´ã™ã‚‹                                                   |
| ä¸Šä½/ä¸‹ä½Nä»¶å–å¾— | `head()`, `tail()`, `nlargest()`, `nsmallest()`                  | ãƒ‡ãƒ¼ã‚¿ã®ä¸€éƒ¨ã‚„æ¥µç«¯ãªå€¤ã‚’æŒã¤ãƒ‡ãƒ¼ã‚¿ã‚’æŠ½å‡ºã™ã‚‹                             |

---

## çµ‚ã‚ã‚Šã«

ãƒ‡ãƒ¼ã‚¿ãƒ©ãƒ³ã‚°ãƒªãƒ³ã‚°ã¯ã€ãƒ‡ãƒ¼ã‚¿åˆ†æãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«ãŠã„ã¦éå¸¸ã«é‡è¦ãªã‚¹ã‚­ãƒ«ã§ã™ã€‚
åˆ†æã«é©ã—ãŸå½¢ã«ãƒ‡ãƒ¼ã‚¿ã‚’æ•´å½¢ã™ã‚‹ã“ã¨ã§ã€ã‚ˆã‚Šæ´å¯Ÿã«æº€ã¡ãŸçµæœã‚’å¾—ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

æ§˜ã€…ãªãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã§ã“ã‚Œã‚‰ã®æ“ä½œã‚’ç·´ç¿’ã—ã€ç¿’ç†Ÿã‚’ç›®æŒ‡ã—ã¾ã—ã‚‡ã†ï¼ ğŸŒ¸
