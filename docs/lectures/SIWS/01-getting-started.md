# Pythonでデータを始めよう

Pythonでデータ探索を始める前に、まず理解すべき重要な概念がいくつかあります：

1. PythonとGoogle Colabとは？
2. Pythonでのコーディング方法は？
3. Pythonパッケージとは？

これから第1章から第3章でこれらの概念を紹介します。すでにこれらの概念に多少慣れている場合は、第4章に進んで最初のデータセットである2013年にニューヨーク市(NYC)の主要3空港から出発した全国内線フライトのデータを紹介します。このデータセットは、本書の大部分で詳しく探索していきます。

## PythonとGoogle Colabとは？

本書全体を通して、PythonをGoogle Colabで使用することを前提とします。初心者はこの二つを混同することがよくあります。最も簡単に言えば、Pythonは車のエンジンのようなもので、Google Colabは車のダッシュボードのようなものです。

![Python vs Google Colab](https://i.imgur.com/8YXkc7z.png)

より正確に言えば、Pythonは計算を実行するプログラミング言語であり、Google Colabは多くの便利な機能やツールを提供するインターフェースを備えた統合開発環境（IDE）です。車のスピードメーター、バックミラー、ナビゲーションシステムがあることで運転が非常に楽になるように、Google Colabのインターフェースを使うことでPythonの使用が非常に楽になります。

### PythonとGoogle Colabのインストール

> **Google Colabに関する注意**: 講師からGoogle Colabへのリンクとアクセス権が提供されている場合は、このセクションをスキップできます。ただし、Google Colabで数ヶ月作業した後、これらの手順に戻ってお使いのコンピュータにソフトウェアをインストールすることをお勧めします。

まず、PythonとGoogle Colabを設定する方法をいくつか示します：

1. **Google Colabを使用する**: ブラウザで[Google Colab](https://colab.research.google.com/)にアクセスします。Googleアカウントでログインするだけで利用できます。
   
2. **自分のコンピュータにPythonをインストールする場合**:
   + Pythonのダウンロードとインストールは[Python公式サイト](https://www.python.org/downloads/)から行えます。
   + データ分析には[Anaconda](https://www.anaconda.com/products/individual)のインストールも選択肢です。
   + よりシンプルな環境を求める場合は[Miniconda](https://docs.conda.io/en/latest/miniconda.html)も良いでしょう。

今回は、どこからでもアクセスでき、セットアップも簡単なGoogle Colabを使用することを前提に進めます。

### Google Colabを使用したPython

以前の車の比喩を思い出してください。エンジン（Python）と直接やり取りするのではなく、ダッシュボードの要素（Google Colab）とやり取りするように、Pythonを直接使用するのではなく、Google Colabのインターフェースを使用します。

Google Colabを開くと、以下のような画面が表示されるはずです。

![Google Colabインターフェース](https://i.imgur.com/NHHvQdx.png)

ノートブックには主に「コードセル」と「テキストセル」の2種類のセルがあります。コードセルにはPythonコードを書き、実行ボタンをクリックするか「Shift+Enter」を押して実行します。テキストセルはMarkdown形式で書かれ、説明文やノートを追加するために使用されます。

## Pythonでのコーディング方法は？

さて、PythonとGoogle Colabのセットアップができたら、次は「Pythonをどう使うの？」と疑問に思うかもしれません。最初に覚えておきたいのは、Excel、SPSS、Minitabのようなポイント＆クリックインターフェースを提供する他の統計ソフトウェアとは異なり、Pythonはインタープリタ言語です。つまり、Pythonコードで書かれたコマンドを入力する必要があります。言い換えれば、Pythonでコーディング/プログラミングする必要があります。この本では「コーディング」と「プログラミング」という用語を互換的に使用します。

Pythonを使用するために熟練したコーダー/コンピュータプログラマーである必要はありませんが、新しいPythonユーザーが理解する必要がある基本的なプログラミングの概念セットがあります。したがって、この本はプログラミングに関する本ではありませんが、データを効果的に探索・分析するために必要な基本的なプログラミングの概念について学びます。

### 基本的なプログラミングの概念と用語

ここでは基本的なプログラミングの概念と用語を紹介します。これらの概念と用語をすべて今すぐ暗記するのではなく、「実践による学習」をガイドします。学習を助けるために、通常のテキストと`コンピュータコード`を区別するために常に異なるフォントを使用します。これらのトピックをマスターする最良の方法は、Pythonでの意図的な練習と多くの反復を通じてです。

* 基本：
    + *Google Colabセル*: コマンドを入力する場所。
    + *コードの実行*: セルでPythonに命令を与えることで、動作を実行するよう伝える行為。
    + *オブジェクト*: Pythonで値が保存される場所。値をオブジェクトに*代入*する方法と、オブジェクトの内容を表示する方法を示します。
    + *データ型*: 整数、浮動小数点数/数値、ブール値、文字列。整数は-1、0、2、4092のような値です。浮動小数点数または数値は整数を含むより大きな値のセットで、-24.932や0.8のような小数値も含みます。ブール値は`True`または`False`のいずれかであり、文字列は「キャベツ」、「ハミルトン」、「ワイヤーは史上最高のTVショーだ」、「このラーメンはおいしい」などのテキストです。文字列は多くの場合、引用符で囲まれて示されます。
* *リスト*: 値のシリーズ。これらは`[]`を使用して作成されます。例えば、`[6, 11, 13, 31, 90, 92]`は6つの正の整数値のシリーズを作成します。
* *カテゴリ変数*: *カテゴリデータ*はPythonでは一般的に特別な方法で表現されます。カテゴリデータは*文字列*として表すこともできます。この違いについては本書を進めながら学んでいきます。
* *データフレーム*: 長方形のスプレッドシート。PythonではpandasライブラリのDataFrameオブジェクトとして表現され、行は*観測値*、列は観測値を記述する*変数*に対応します。データフレームについては第4章で説明します。
* *条件文*:
  + Pythonでの等値比較は`==`を使います（`=`ではなく、これは通常、代入に使用されます）。例えば、`2 + 1 == 3`は`2 + 1`を`3`と比較し、正しいPythonコードですが、`2 + 1 = 3`はエラーを返します。
  + ブール代数: `True/False`ステートメントと`<`（未満）、`<=`（以下）、`!=`（等しくない）などの数学演算子。例えば、`4 + 2 >= 3`は`True`を返しますが、`3 + 5 <= 1`は`False`を返します。
  + 論理演算子: `and`は「かつ」を表し、`or`は「または」を表します。例えば、`(2 + 1 == 3) and (2 + 1 == 4)`は両方の節が`True`ではないため（最初の節だけが`True`）、`False`を返します。一方、`(2 + 1 == 3) or (2 + 1 == 4)`は2つの節のうち少なくとも1つが`True`であるため、`True`を返します。
* *関数*: 関数はPythonでタスクを実行します。入力として*引数*を取り、出力を返します。関数の引数を手動で指定するか、関数の*デフォルト値*を使用することができます。
  + 例えば、Pythonの`range()`関数は数字のシーケンスを生成します。もし`range(1)`を実行すると、値0を返します。これはあまり役に立たないようですが、デフォルト引数が`range(start=0, stop=1)`のように設定されているためです。異なる動作にするために`start`と`stop`の値を変更しない場合、Pythonはあなたが単に数値0から0までのシーケンスが欲しいと仮定します。`=`記号の後に値を更新することで引数の値を変更できます。`range(start=2, stop=6)`を試してみると、`2, 3, 4, 5`という結果が得られます。
  + この本を通してたくさんの関数を扱い、その挙動を理解するための練習をたくさん行います。関数について言及するときは、上記の`range()`のように関数名の後ろに`()`を付けて示します。

これはPython熟練ユーザーになるために必要なすべてのプログラミングの概念と用語の網羅的なリストではありません。そのようなリストは非常に大きくなり、特に初心者には役に立たないでしょう。むしろ、これは始める前に知っておく必要があるプログラミングの概念と用語の最小限のリストだと考えています。残りは進みながら学ぶことができます。これらの概念と用語のすべてをマスターするには、より多くの練習をすることで構築されていくでしょう。

### エラー、警告、メッセージ

新しいPythonとGoogle Colabユーザーを威嚇するものの一つは、*エラー*、*警告*、*メッセージ*がどのように報告されるかです。Pythonはエラー、警告、メッセージを目立つ赤色のフォントで表示し、叱られているような気分にさせることがあります。しかし、赤いテキストがセルに表示されても常に悪いことではありません。

Pythonは3つの異なる状況でエラーメッセージを表示します：

* **エラー**: 赤いテキストが正当なエラーである場合、「Error:…」で始まり、何が間違っているかを説明しようとします。一般的にエラーがある場合、コードは実行されません。例えば、第3章で見るように、`ModuleNotFoundError: No module named 'seaborn'`というエラーが表示された場合、`seaborn`モジュールがアクセスできないことを意味します。そのため、`seaborn`モジュールを最初にインポートせずに`seaborn`の機能を使用することはできません。
* **警告**: 赤いテキストが警告である場合、「Warning:」で始まり、Pythonは警告がある理由を説明しようとします。一般的にコードは実行されますが、いくつかの注意点があります。例えば、第5章で見るように、2つのデータポイントが欠損値を持つデータセットに基づいて散布図を作成する場合、次のような警告が表示されることがあります：`UserWarning: Matplotlib is currently using module://ipykernel.pylab.backend_inline, which is a non-GUI backend, so cannot show the figure.`。Pythonは残りの非欠損値でプロットを生成しますが、2つのポイントが欠けていることを警告します。
* **メッセージ**: 赤いテキストが「Error」または「Warning」で始まらない場合、それは*単なる親切なメッセージ*です。これらのメッセージは、今後の第3章でPythonパッケージをインポートするとき、または第5章で`pd.read_csv()`関数でスプレッドシートファイルに保存されたデータを読み込むときに表示されます。これらは役立つ診断メッセージであり、コードの動作を妨げるものではありません。また、`pip install`を使用してパッケージをインストールするときにもこれらのメッセージが表示されます。

コンソールに赤いテキストが表示されても、*パニックにならないでください*。必ずしも何か問題があるという意味ではありません。むしろ：

* テキストが「Error」で始まる場合は、その原因を突き止めます。<span style="color:red">エラーは赤信号のように考えてください：何かが間違っています！</span>
* テキストが「Warning」で始まる場合は、心配すべきことかどうかを確認します。例えば、散布図に欠損値があるという警告が表示され、欠損値があることを知っている場合は問題ありません。それが驚きである場合は、データを調べて何が欠けているのかを確認します。<span style="color:gold">警告は黄色信号のように考えてください：すべてが正常に動作していますが、注意/注目してください。</span>
* それ以外の場合、テキストは単なるメッセージです。それを読み、Pythonに手を振り返し、話しかけてくれたことに感謝します。<span style="color:green">メッセージは青信号のように考えてください：すべてが正常に動作していて、そのまま続けてください！</span>

### コーディングを学ぶためのヒント

コーディング/プログラミングを学ぶことは、外国語を学ぶことによく似ています。最初は威圧的でフラストレーションがたまることがあります。そのようなフラストレーションは一般的であり、学習中に落胆を感じるのは正常です。しかし、外国語を学ぶのと同様に、努力を惜しまず、間違いを恐れなければ、誰でも学び、向上することができます。

プログラミングを学ぶ際に覚えておくと役立つヒントをいくつか紹介します：

* **コンピュータは実際にはそれほど賢くないことを覚えておいてください**: あなたのコンピュータやスマートフォンが「賢い」と思うかもしれませんが、実際には人々が「賢く」見えるように設計するために多くの時間とエネルギーを費やしました。実際には、コンピュータには必要なすべてを指示する必要があります。さらに、コンピュータに与える指示にはミスがあってはならず、どんな形でも曖昧であってはなりません。
* **「コピー、ペースト、修正」アプローチを取ってください**: 特に最初のプログラミング言語を学ぶとき、または特に複雑なコードを理解する必要があるとき、ゼロからコードを書くよりも、既存の動作するコードを取って自分の目的に合わせて修正する方が、多くの場合はるかに簡単です。私たちはこれを*「コピー、ペースト、修正」*アプローチと呼びます。そのため、初期段階では、記憶からコードを書こうとするのではなく、私たちが提供した既存の例を取り、コピー、ペースト、修正して目標に合わせることをお勧めします。自信がついてきたら、このアプローチから徐々に離れ、ゼロからコードを書き始めることができます。「コピー、ペースト、修正」アプローチは、子供が自転車に乗ることを学ぶための補助輪のようなものと考えてください。慣れた後は、もう必要ありません。
* **コーディングを学ぶ最良の方法は実践することです**: コーディングをそれ自体のために学ぶよりも、目標を持っている場合や、特定のプロジェクト、例えばあなたが興味を持ち、あなたにとって重要なデータを分析する作業をしている場合、コーディングの学習がはるかにスムーズに進むことがわかります。
* **練習が鍵です**: 外国語スキルを向上させる唯一の方法が多くの練習と会話であるのと同様に、コーディングスキルを向上させる唯一の方法は多くの練習です。心配しないでください、私たちはそうするための多くの機会を提供します！

## Pythonパッケージとは？

多くの新しいPythonユーザーが混乱するもう一つの点は、Pythonパッケージのアイデアです。Pythonパッケージは追加の関数、データ、ドキュメントを提供することで、Pythonの機能を拡張します。これらは世界中のPythonユーザーコミュニティによって書かれ、インターネットから無料でダウンロードできます。

例えば、この本で使用する多くのパッケージの中には、データ可視化のための`matplotlib`と`seaborn`パッケージ、データ操作のための`pandas`パッケージ、そしてデータサイエンスのための様々なツールを含む`scipy`パッケージがあります。

Pythonパッケージの良い類似性は、携帯電話にダウンロードできるアプリのようなものです：

![Python vs Pythonパッケージ](https://i.imgur.com/XvHnHvS.png)

つまり、Pythonは新しい携帯電話のようなものです：初めて使用するときにある程度の機能がありますが、すべてがあるわけではありません。Pythonパッケージは、Apple App StoreやAndroidのGoogle Playから携帯電話にダウンロードできるアプリのようなものです。

この類似性を続けて、Instagramアプリで写真を編集し共有することを考えてみましょう。新しい電話を購入し、Instagramで友達と写真を共有したいとします。必要なことは：

1. *アプリをインストールする*: あなたの電話は新しいのでInstagramアプリが含まれていないため、App StoreまたはGoogle Playからアプリをダウンロードする必要があります。これを一度行えば、当面は設定されています。アプリの更新がある場合、将来的に再度行う必要があるかもしれません。
2. *アプリを開く*: Instagramをインストールした後、それを開く必要があります。

Instagramが電話で開いたら、友達や家族と写真を共有することができます。このプロセスはPythonパッケージを使用する場合と非常に似ています。必要なことは：

1. *パッケージをインストールする*: これは電話にアプリをインストールするようなものです。ほとんどのパッケージはPythonをインストールしたときにデフォルトでインストールされていません。したがって、パッケージを初めて使用したい場合は、まずインストールする必要があります。パッケージをインストールしたら、新しいバージョンに更新したい場合を除いて、おそらく再インストールしません。
2. *パッケージを「インポート」する*: パッケージを「インポート」することは、電話でアプリを開くようなものです。パッケージはGoogle Colabを起動したときにデフォルトで「インポート」されていません。使用したい各パッケージを毎回Google Colabを起動するたびに「インポート」する必要があります。

データ可視化のための`matplotlib`と`seaborn`パッケージに対してこれらの2つのステップを実行してみましょう。

### パッケージのインストール

> **Google Colabに関する注意**: Google Colabを使用している場合、パッケージの多くはすでにインストールされています。インストールされていないパッケージは、特別なコマンドでインストールできます。

Google Colabでパッケージをインストールする方法は2つあります：簡単な方法と少し高度な方法です。まず簡単な方法から見てみましょう：

1) 左側のメニューで「ファイル」を選択
2) 「新しいノートブック」を選択して新しいノートブックを作成
3) 新しいコードセルに次のコマンドを入力：`!pip install seaborn`
4) 「実行」をクリックまたはShift+Enterを押して実行

これはGoogle Colabでパッケージをインストールする一般的な方法です。`!`プレフィックスはシステムコマンドを実行するために使われます。

それでは、データ可視化のパッケージをインストールしてみましょう：

```python
!pip install matplotlib seaborn
```

多くのパッケージはGoogle Colabに既にインストールされていますが、最新バージョンにアップデートするために上記のコマンドを実行することがあります。

携帯電話のアプリと同様に、パッケージは一度だけインストールする必要があります。ただし、以前にインストールしたパッケージを新しいバージョンに更新したい場合は、前述の手順を繰り返してパッケージを再インストールする必要があります。

### パッケージの読み込み

パッケージをインストールした後は、「インポート」する必要があります。つまり、それを「開く」必要があります。これは`import`コマンドを使用して行います。

例えば、`matplotlib`と`seaborn`パッケージをインポートするには、以下のコードをコンソールパネルで実行します。「コードを実行する」とはどういう意味ですか？以下のコードをコンソールパネルに入力するかコピー＆ペーストし、Enterキーを押します。

```python
import matplotlib.pyplot as plt
import seaborn as sns
```

上記のコードを実行した後、カーソルが新しいセルの先頭に表示される場合、成功し、`matplotlib`と`seaborn`パッケージが読み込まれ、使用できる状態になっています。ただし、「エラーメッセージ」が表示された場合...

```
ModuleNotFoundError: No module named 'seaborn'
```

...パッケージのインストールが成功していないことを意味します。これは、エラーメッセージの例です。このエラーメッセージが表示された場合は、パッケージのインストールに関するセクションに戻り、続行する前に`seaborn`パッケージが正しくインストールされていることを確認してください。

これらのステップを繰り返して、`pandas`、`numpy`、および`scipy`パッケージもインポートしてみましょう。

```python
import pandas as pd
import numpy as np
from scipy import stats
```

### パッケージの使用

Pythonパッケージを使用したい新しいPythonユーザーがよく犯す非常に一般的なミスは、`import`コマンドを使ってまず「インポート」することを忘れることです。覚えておいてください：*Google Colabを起動するたびに、使用したい各パッケージをインポートする必要があります。*最初にパッケージを「インポート」せずに機能を使用しようとすると、次のようなエラーメッセージが表示されます：

```
NameError: name 'plt' is not defined
```

これは、パッケージがまだインストールされていないというエラーメッセージとは異なります。Pythonはあなたがまだ「インポート」されていないパッケージの関数を使用しようとしていることを伝えています。Pythonはあなたが使用している関数をどこで見つければいいか分かりません。初めて使用するとき、ほとんどすべての新しいユーザーがこれを忘れ、慣れるのは少し面倒です。ただし、練習すれば覚えておくことができ、しばらくすると自然になります。

## 最初のデータセットを探索しよう

これまで学んだことをすべて実践し、実際のデータの探索を始めましょう！データは様々な形式で私たちの元に来ます。写真からテキスト、数字まで。この本を通して、「スプレッドシート」タイプの形式で保存されたデータセットに焦点を当てます。これはおそらく多くの分野でデータが収集され保存される最も一般的な方法です。プログラミングの概念のセクションから覚えているように、これらの「スプレッドシート」タイプのデータセットはPythonでは_データフレーム_と呼ばれます。この本を通して、データフレームとして保存されたデータを扱うことに焦点を当てます。

まず、この章に必要なすべてのパッケージをインポートしましょう。パッケージのインストールと読み込み方法については第3章を参照してください。

```python
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns
```

以降の章では、その章のPythonコードを使うために必要なパッケージを常にリストアップします。

### NYCフライトデータセット

多くの人が飛行機に乗ったことがあるか、乗ったことのある人を知っています。空の旅は多くの人々の生活で常に存在するようになりました。空港の出発便情報ボードを見ると、様々な理由で遅延している便が頻繁に見られます。フライトの遅延を引き起こす理由を理解する方法はありますか？

私たちは皆、可能な限り時間通りに目的地に到着したいと思っています。（空港で過ごすことを密かに愛していない限り。もしあなたがそのような人であれば、最終目的地にいることを非常に楽しみにしているふりをしてください。）この本を通して、2013年にニューヨーク市の3つの主要空港、ニューアーク・リバティ国際空港（EWR）、ジョン・F・ケネディ国際空港（JFK）、ラガーディア空港（LGA）から出発したすべての国内線に関連するデータを分析します。

まず、このデータをGitHubからダウンロードしてみましょう：

```python
# URLからデータをダウンロード
flights_url = "https://raw.githubusercontent.com/tomoshige/website/refs/heads/main/docs/lectures/SIWS/datasets/flights.csv"
airlines_url = "https://raw.githubusercontent.com/tomoshige/website/refs/heads/main/docs/lectures/SIWS/datasets/airlines.csv"

# データフレームとして読み込む
# 注意: このデータはnycflights13と完全に同じではありませんが、例示目的で使用します
airports = pd.read_csv(flights_url, header=None, 
                       names=["ID", "name", "city", "country", "IATA", "ICAO", 
                              "latitude", "longitude", "altitude", "timezone", 
                              "DST", "tz", "type", "source"])

airlines = pd.read_csv(airlines_url, header=None,
                       names=["ID", "name", "alias", "IATA", "ICAO", "callsign", 
                              "country", "active"])

# より詳細なフライトデータを取得するためのURLを設定
# 注意: これは例示目的です。実際のデータセットはこれより複雑になります
flight_data = {
    'year': [2013] * 10,
    'month': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
    'day': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
    'dep_time': [517, 533, 542, 544, 554, 554, 555, 557, 557, 558],
    'sched_dep_time': [515, 529, 540, 545, 600, 558, 600, 600, 600, 600],
    'dep_delay': [2, 4, 2, -1, -6, -4, -5, -3, -3, -2],
    'arr_time': [830, 850, 923, 1004, 812, 740, 913, 709, 838, 753],
    'sched_arr_time': [819, 830, 850, 1022, 837, 728, 854, 723, 846, 745],
    'arr_delay': [11, 20, 33, -18, -25, 12, 19, -14, -8, 8],
    'carrier': ['UA', 'UA', 'AA', 'B6', 'DL', 'UA', 'B6', 'EV', 'B6', 'AA'],
    'flight': [1545, 1714, 1141, 725, 461, 1696, 507, 5708, 79, 301],
    'tailnum': ['N14228', 'N24211', 'N619AA', 'N804JB', 'N668DN', 'N39463', 'N516JB', 'N829AS', 'N593JB', 'N3ALAA'],
    'origin': ['EWR', 'LGA', 'JFK', 'JFK', 'LGA', 'EWR', 'EWR', 'LGA', 'JFK', 'LGA'],
    'dest': ['IAH', 'IAH', 'MIA', 'BQN', 'ATL', 'ORD', 'FLL', 'IAD', 'MCO', 'ORD'],
    'air_time': [227, 227, 160, 183, 116, 150, 158, 53, 140, 138],
    'distance': [1400, 1416, 1089, 1576, 762, 719, 1065, 229, 944, 733],
    'hour': [5, 5, 5, 5, 6, 5, 6, 6, 6, 6],
    'minute': [15, 29, 40, 45, 0, 58, 0, 0, 0, 0],
    'time_hour': ['2013-01-01T05:00:00Z', '2013-01-01T05:00:00Z', '2013-01-01T05:00:00Z', 
                  '2013-01-01T05:00:00Z', '2013-01-01T06:00:00Z', '2013-01-01T05:00:00Z', 
                  '2013-01-01T06:00:00Z', '2013-01-01T06:00:00Z', '2013-01-01T06:00:00Z', 
                  '2013-01-01T06:00:00Z']
}

flights = pd.DataFrame(flight_data)

# 天気データの作成（簡略化されたデモ用）
weather_data = {
    'origin': ['EWR', 'JFK', 'LGA'] * 3,
    'year': [2013] * 9,
    'month': [1] * 9,
    'day': [1, 1, 1, 1, 1, 1, 1, 1, 1],
    'hour': [0, 0, 0, 1, 1, 1, 2, 2, 2],
    'temp': [39.02, 39.02, 39.92, 39.02, 39.02, 39.02, 39.02, 39.92, 39.02],
    'dewp': [26.06, 26.96, 26.96, 26.96, 26.96, 26.96, 26.96, 26.96, 26.96],
    'humid': [59.37, 60.27, 60.27, 60.27, 60.27, 60.27, 60.27, 60.27, 60.27],
    'wind_dir': [270, 270, 270, 270, 270, 270, 270, 270, 270],
    'wind_speed': [10.36, 10.36, 10.36, 10.36, 10.36, 10.36, 10.36, 10.36, 10.36],
    'wind_gust': [np.nan, np.nan, np.nan, np.nan, np.nan, np.nan, np.nan, np.nan, np.nan],
    'precip': [0, 0, 0, 0, 0, 0, 0, 0, 0],
    'pressure': [1012.0, 1012.0, 1012.0, 1012.0, 1012.0, 1012.0, 1012.0, 1012.0, 1012.0],
    'visib': [10, 10, 10, 10, 10, 10, 10, 10, 10]
}

weather = pd.DataFrame(weather_data)

# 飛行機の情報データ（簡略化されたデモ用）
planes_data = {
    'tailnum': ['N10156', 'N102UW', 'N103US', 'N104UW', 'N10575'],
    'year': [2004, 1998, 1999, 1999, 2002],
    'type': ['Fixed wing multi engine', 'Fixed wing multi engine', 'Fixed wing multi engine', 
             'Fixed wing multi engine', 'Fixed wing multi engine'],
    'manufacturer': ['EMBRAER', 'AIRBUS INDUSTRIE', 'AIRBUS INDUSTRIE', 'AIRBUS INDUSTRIE', 'EMBRAER'],
    'model': ['EMB-145XR', 'A320-214', 'A320-214', 'A320-214', 'EMB-145LR'],
    'engines': [2, 2, 2, 2, 2],
    'seats': [55, 182, 182, 182, 55],
    'speed': [np.nan, np.nan, np.nan, np.nan, np.nan],
    'engine': ['Turbo-fan', 'Turbo-fan', 'Turbo-fan', 'Turbo-fan', 'Turbo-fan']
}

planes = pd.DataFrame(planes_data)
```

これで5つのデータフレームが利用できるようになりました：

* `flights`: すべてのフライトに関する情報。
* `airlines`: 航空会社名と国際航空運送協会（IATA）の2文字コード（キャリアコードとも呼ばれる）を一致させる表。例えば、「DL」はデルタ航空の2文字コードです。
* `planes`: 使用された各物理航空機に関する情報。
* `weather`: 3つのNYC空港それぞれの毎時気象データ。
* `airports`: 国内目的地の名前、コード、場所。

### `flights`データフレーム

まず`flights`データフレームを探索し、その構造を把握しましょう。以下のコードをコンソールで実行し、入力するか、コピー＆ペーストしてください。コンソールに`flights`データフレームの内容が表示されます。モニターのサイズによって出力は若干異なる場合があります。

```python
flights
```

この出力を解説しましょう：

* これは`pandas.DataFrame`です：pandas DataFrameは特定の種類のデータフレームです。この特定のデータフレームには
    + 行は異なる*観測値*に対応します。ここでは、各観測値はフライトです。
    + 列は各観測値を記述する*変数*に対応します。
* `year`、`month`、`day`、`dep_time`、`sched_dep_time`、`dep_delay`、`arr_time`はこのデータセットの異なる列、つまり異なる変数です。
* 次に最初の10件のフライトに対応する最初の10行の観測値のプレビューが表示されます。Pythonは最初の10行のみを表示しています。なぜなら、すべての行を表示するとあなたの画面が圧倒されてしまうからです。

残念ながら、この出力はデータをよく探索することができませんが、良いプレビューを提供します。データフレームを探索するいくつかの異なる方法を見てみましょう。

### データフレームの探索

`flights`のようなデータフレームに含まれるデータを把握するには多くの方法があります。問題のデータフレームを「引数」（入力）として取る4つの関数を紹介します。また、データフレームの特定の列を探索するための4番目の方法も含めます：

1. `.head()`メソッドを使用すると、データフレームの最初の数行を表示します。
2. `.info()`メソッドは、データフレームの構造に関する情報を表示します。これはpandasパッケージに含まれています。
3. `.describe()`メソッドは、数値データに関する基本的な統計情報を表示します。
4. `[]`「インデックス演算子」を使用すると、データフレーム内の単一の変数/列を表示できます。

**1. `.head()`**:

Google Colabでセルに`flights.head()`を入力して実行します。この結果のビューアでこのデータフレームを探索してください。データフレームを確認する習慣をつけるべきです。

```python
flights.head()
```

**2. `.info()`**:

データフレームを探索する2番目の方法は、pandasライブラリに含まれる`.info()`メソッドを使用することです。このメソッドはデータフレームを探索するための別の視点を提供します：

```python
flights.info()
```

`.info()`は各変数のデータ型と非欠損値の数を示します。ここで、`int64`と`float64`は「整数」と「浮動小数点数」を指し、これらは数値/数値変数のコンピュータコード用語です。

対照的に、`object`は「オブジェクト」を指し、テキストデータのコンピュータ用語です。ほとんどの形式では、`carrier`や`origin`などのテキストデータはカテゴリ変数です。`time_hour`変数は別のデータ型です：日付と時刻の組み合わせを表します。ただし、この本では日付と時刻は扱いません。

**3. `.describe()`**:

データフレーム全体を探索する3番目の方法は、`.describe()`メソッドを使用することです。これを使って航空会社のデータを2つの方法で探索してみましょう：

```python
airlines.describe()
```

一見すると、出力にあまり違いがないように見えるかもしれません。ただし、レポートを作成するためのツールを使用する場合、後者のコードは読みやすく、読者に優しい出力を生成します。

**4. `[]` 演算子**

最後に、`[]`演算子を使用すると、データフレーム内の単一の変数を抽出して探索できます。例えば、次のようにコンソールで実行してください：

```python
airlines['name']
```

`[]`演算子を使用して、`name`変数のみを抽出し、長さ16のシリーズとして返しました。データフレームを探索するために`[]`演算子を頻繁に使用することはなく、代わりに`.head()`と`.info()`関数を好みます。

### 識別変数と測定変数

データフレームで遭遇する変数の種類には微妙な違いがあります。*識別変数*と*測定変数*があります。例えば、`.info()`を使用して`airports`データフレームを探索してみましょう：

```python
airports.info()
```

変数`IATA`と`name`は*識別変数*と呼ばれるもので、各観測単位を一意に識別する変数です。この場合、識別変数は空港を一意に識別します。このような変数は、主にデータフレーム内の各行を一意に識別するために実践で使用されます。`IATA`は各空港のIATA（国際航空運送協会）コードを示し、`name`変数は空港の正式名称を提供します。残りの変数（`latitude`、`longitude`、`altitude`、`timezone`、`DST`、`tz`）は多くの場合*測定*または*特性*変数と呼ばれます：各観測単位のプロパティを記述する変数です。例えば、`latitude`と`longitude`は各空港の緯度と経度を示します。

さらに、時には単一の変数が各観測単位を一意に識別するのに十分ではない場合があります：変数の組み合わせが必要になることがあります。絶対的なルールではありませんが、整理のために、識別変数をデータフレームの左端の列に配置することが良い習慣とされています。

### ヘルプファイル

Pythonのもう一つの良い機能は、様々な関数とデータセットのドキュメントを提供するヘルプ機能です。関数またはデータフレームの名前の前に`?`を追加し、コンソールで実行することでヘルプファイルを表示できます。そうすると、対応するドキュメンテーションが存在する場合、それを示すページが表示されます。例えば、`flights`データフレームのヘルプファイルを見てみましょう。

```python
# Google Colabのマジックコマンドを使用
?flights
```

または

```python
# help関数を使用
help(flights)
```

ヘルプ情報はGoogle Colabのヘルプパネルにポップアップするはずです。Pythonパッケージに含まれる関数やデータフレームについて質問がある場合は、すぐにヘルプファイルを参照する習慣を身につけるべきです。

## 結論

Pythonでデータを探索するために、私たちが最低限必要なツールセットを提供しました。この章にあなたが知る必要のあるすべてが含まれていますか？絶対にそうではありません。この章にすべてを含めようとすると、章が非常に大きくなり、役に立たなくなってしまいます！先ほど述べたように、ツールボックスに追加する最良の方法は、Google Colabにアクセスし、可能な限りコードを実行して書くことです。

### 追加リソース

コーディング、Python、Google Colabの世界に不慣れで、より詳細な紹介が役立つと感じる場合は、[「Python for Data Science Handbook」](https://jakevdp.github.io/PythonDataScienceHandbook/)や[「Python Data Science Tutorials」](https://realpython.com/tutorials/data-science/)などのリソースをチェックすることをお勧めします。これらには学習しながら従うことができるチュートリアルが含まれています。

### 今後の内容

次に「pandasによるデータサイエンス」の部分に進みます。データサイエンティストのツールボックスで最も重要なツールだと感じるものからです：データ可視化。引き続き、データ可視化のための`matplotlib`および`seaborn`パッケージを使用して、`pandas`パッケージに含まれるデータを探索します。データ可視化はデータ探索のための強力なツールであり、`.head()`および`.info()`関数が提供できる以上の洞察を提供することがわかるでしょう。