# 線形代数学 第13回：連立一次方程式の解の分類

## 1. 講義情報と予習ガイド

**講義回**: 第13回

**スライド**: [こちら](./slides/13-system-of-linear-equation-slide.pdf)

**演習問題**: [こちら](./exercise/exercise7.pdf)

---

## 2. 学習目標

本講義を修了するころには、以下のことができるようになることを目指します。

1.  連立一次方程式の解の種類（**唯一解**、**無数の解**、**解なし**）を理解し、区別できる。
2.  与えられた連立一次方程式について、解が存在するための条件を判定できる。
3.  連立一次方程式の解が幾何学的に何を意味するのかを説明できる。
4.  行列の**ランク**と連立一次方程式の解の種類の関係性を明確に説明できる。

---

## 3. 基本概念の確認

### 3.1 連立一次方程式とその行列表現

$n$ 個の未知数 $x_1, x_2, \ldots, x_n$ に関する $m$ 個の一次方程式からなる連立一次方程式を考えます。

$$
\begin{cases}
a_{11}x_1 + a_{12}x_2 + \cdots + a_{1n}x_n = b_1 \\
a_{21}x_1 + a_{22}x_2 + \cdots + a_{2n}x_n = b_2 \\
\vdots \\
a_{m1}x_1 + a_{m2}x_2 + \cdots + a_{mn}x_n = b_m
\end{cases}
$$

この連立一次方程式は、行列とベクトルを用いて次のように簡潔に表現できます。

$$A\mathbf{x} = \mathbf{b}$$

ここで、
- $A$: $m \times n$ の**係数行列**
  $$
  A =
  \begin{bmatrix}
  a_{11} & a_{12} & \cdots & a_{1n} \\
  a_{21} & a_{22} & \cdots & a_{2n} \\
  \vdots & \vdots & \ddots & \vdots \\
  a_{m1} & a_{m2} & \cdots & a_{mn}
  \end{bmatrix}
  $$
- $\mathbf{x}$: $n$ 次元の**未知数ベクトル** (解ベクトル)
  $$
  \mathbf{x} =
  \begin{bmatrix}
  x_1 \\ x_2 \\ \vdots \\ x_n
  \end{bmatrix}
  $$
- $\mathbf{b}$: $m$ 次元の**定数ベクトル** (右辺ベクトル)
  $$
  \mathbf{b} =
  \begin{bmatrix}
  b_1 \\ b_2 \\ \vdots \\ b_m
  \end{bmatrix}
  $$

### 3.2 解の定義と種類

> **定義**: 連立一次方程式 $A\mathbf{x} = \mathbf{b}$ の**解**とは、この等式を満たす未知数ベクトル $\mathbf{x}$ の具体的な値（または値の組）のことです。

連立一次方程式の解は、次の3つのいずれかのケースに分類されます。

1.  **唯一解 (Unique solution)**: 解がただ一つだけ存在する。
2.  **無数の解 (Infinitely many solutions)**: 解が無限に存在する。
3.  **解なし (No solution)**: 解が存在しない。

---

## 4. 解の存在と一意性に関する理論

### 4.1 方程式の数と未知数の数による大まかな分類

連立一次方程式 $A\mathbf{x} = \mathbf{b}$ において、$m$ は方程式の数、$n$ は未知数の数を表します。

1.  $m < n$ (**劣決定系**または**不足決定系** とも呼ばれる): 未知数の数よりも方程式の数が少ない。
    -   一般に、解が存在する場合は**無数の解**を持つことが多いです。ただし、矛盾する方程式が含まれていれば**解なし**となることもあります。
2.  $m = n$ (**正方系**または**完全決定系** とも呼ばれる): 未知数の数と方程式の数が等しい。
    -   係数行列 $A$ が**正則** (つまり 逆行列が存在する) であれば、**唯一解**が存在します。
    -   係数行列 $A$ が**特異** (つまり 逆行列が存在しない) であれば、**無数の解**を持つか、**解なし**となります。
3.  $m > n$ (**優決定系**または**過剰決定系** とも呼ばれる): 未知数の数よりも方程式の数が多い。
    -   一般に、**解なし**となることが多いです。ただし、冗長な方程式や線形従属な方程式が含まれていて、実質的な方程式の数が未知数の数以下になる場合は、解が存在することもあります。

**注意**: 上記はあくまで一般的な傾向であり、解の種類を正確に判定するには、次節のランクを用いた条件が必要です。

### 4.2 行列のランクと解の存在条件（ルーシェ＝カペリの定理）

連立一次方程式 $A\mathbf{x} = \mathbf{b}$ の解の存在と種類は、係数行列 $A$ のランク $\text{rank}(A)$ と、係数行列 $A$ に定数ベクトル $\mathbf{b}$ を付け加えた**拡大係数行列** $[A|\mathbf{b}]$ のランク $\text{rank}([A|\mathbf{b}])$ を比較することで厳密に判定できます。

> **定理 (ルーシェ＝カペリの定理)**:
> $m \times n$ 行列 $A$ を係数行列とする連立一次方程式 $A\mathbf{x} = \mathbf{b}$ について、
>
> 1.  **解が存在するための必要十分条件**:
>     $\text{rank}(A) = \text{rank}([A|\mathbf{b}])$
>
> 2.  **解の種類**:
>     -   $\text{rank}(A) = \text{rank}([A|\mathbf{b}]) = n$ (未知数の数) の場合: **唯一解**が存在する。
>     -   $\text{rank}(A) = \text{rank}([A|\mathbf{b}]) < n$ の場合: **無数の解**が存在する。このとき、$n - \text{rank}(A)$ 個の自由変数（パラメータ）を使って解を表すことができる。
>     -   $\text{rank}(A) < \text{rank}([A|\mathbf{b}])$ の場合: **解なし**。

### 4.3 簡約階段行列を用いた解の判定法

ガウスの消去法を用いて拡大係数行列 $[A|\mathbf{b}]$ を**簡約階段行列**に変形することで、解の種類を判定し、実際に解を求めることができます。

1.  **唯一解**:
    -   簡約階段行列において、係数行列部分の各列にピボット (主成分) が存在する。
    -   すなわち、$\text{rank}(A) = n$ であり、矛盾する行 ($0 \ 0 \ \cdots \ 0 \ | \ c$, ただし $c \neq 0$) が現れない。
2.  **無数の解**:
    -   簡約階段行列において、ピボットを持たない列が係数行列部分に存在する (これが自由変数に対応する)。
    -   かつ、矛盾する行 ($0 \ 0 \ \cdots \ 0 \ | \ c$, ただし $c \neq 0$) が現れない。
3.  **解なし**:
    -   簡約階段行列において、$0x_1 + 0x_2 + \cdots + 0x_n = c$ ($c \neq 0$) という形の方程式に対応する行、すなわち $[0 \ 0 \ \cdots \ 0 \ | \ c]$ ($c \neq 0$) という形の行が現れる。これは矛盾を意味する。

---

## 5. 具体例と解説

### 5.1 唯一解を持つ例

連立一次方程式:

$$
\begin{cases}
x + 2y = 5 \\
2x - y = 0
\end{cases}
$$

拡大係数行列 $[A|\mathbf{b}]$:

$$
\left[
\begin{array}{cc|c}
1 & 2 & 5 \\
2 & -1 & 0
\end{array}
\right]
$$

ガウスの消去法を適用 (行基本変形):

$$
\left[
\begin{array}{cc|c}
1 & 2 & 5 \\
2 & -1 & 0
\end{array}
\right]
\xrightarrow{R_2 - 2R_1}
\left[
\begin{array}{cc|c}
1 & 2 & 5 \\
0 & -5 & -10
\end{array}
\right]
\xrightarrow{-\frac{1}{5}R_2}
\left[
\begin{array}{cc|c}
1 & 2 & 5 \\
0 & 1 & 2
\end{array}
\right]
\xrightarrow{R_1 - 2R_2}
\left[
\begin{array}{cc|c}
1 & 0 & 1 \\
0 & 1 & 2
\end{array}
\right]
$$

この簡約階段行列から、$x=1$, $y=2$ という**唯一解**が得られます。

**ランクによる確認**:
- 係数行列 $A = \begin{bmatrix} 1 & 2 \\ 2 & -1 \end{bmatrix}$ は行基本変形により $\begin{bmatrix} 1 & 0 \\ 0 & 1 \end{bmatrix}$ となるため、$\text{rank}(A) = 2$。
- 拡大係数行列 $[A|\mathbf{b}]$ は上記の通り $\left[ \begin{array}{cc|c} 1 & 0 & 1 \\ 0 & 1 & 2 \end{array} \right]$ となるため、$\text{rank}([A|\mathbf{b}]) = 2$。
- 未知数の数 $n=2$。
したがって、$\text{rank}(A) = \text{rank}([A|\mathbf{b}]) = n = 2$ なので、唯一解が存在します。

### 5.2 無数の解を持つ例

連立一次方程式:

$$
\begin{cases}
x + 2y - z = 5 \\
2x - y + z = 0 \\
3x + y \qquad = 5
\end{cases}
$$

拡大係数行列 $[A|\mathbf{b}]$:

$$
\left[
\begin{array}{ccc|c}
1 & 2 & -1 & 5 \\
2 & -1 & 1 & 0 \\
3 & 1 & 0 & 5
\end{array}
\right]
$$

ガウスの消去法を適用:

$$
\left[
\begin{array}{ccc|c}
1 & 2 & -1 & 5 \\
2 & -1 & 1 & 0 \\
3 & 1 & 0 & 5
\end{array}
\right]
\xrightarrow{R_2 - 2R_1, R_3 - 3R_1}
\left[
\begin{array}{ccc|c}
1 & 2 & -1 & 5 \\
0 & -5 & 3 & -10 \\
0 & -5 & 3 & -10
\end{array}
\right]
\xrightarrow{R_3 - R_2}
\left[
\begin{array}{ccc|c}
1 & 2 & -1 & 5 \\
0 & -5 & 3 & -10 \\
0 & 0 & 0 & 0
\end{array}
\right]
$$

$$
\xrightarrow{-\frac{1}{5}R_2}
\left[
\begin{array}{ccc|c}
1 & 2 & -1 & 5 \\
0 & 1 & -3/5 & 2 \\
0 & 0 & 0 & 0
\end{array}
\right]
\xrightarrow{R_1 - 2R_2}
\left[
\begin{array}{ccc|c}
1 & 0 & 1/5 & 1 \\
0 & 1 & -3/5 & 2 \\
0 & 0 & 0 & 0
\end{array}
\right]
$$

この簡約階段行列から、
$x + \frac{1}{5}z = 1 \implies x = 1 - \frac{1}{5}z$
$y - \frac{3}{5}z = 2 \implies y = 2 + \frac{3}{5}z$
$z$ はピボットを持たない列に対応するため、**自由変数**となります。$z = t$ ($t$ は任意の実数) とおくと、解は
$x = 1 - \frac{1}{5}t$, $y = 2 + \frac{3}{5}t$, $z = t$
となり、**無数の解**が存在します。

**ランクによる確認**:
- 簡約階段行列の係数行列部分は $\begin{bmatrix} 1 & 0 & 1/5 \\ 0 & 1 & -3/5 \\ 0 & 0 & 0 \end{bmatrix}$ なので、$\text{rank}(A) = 2$。
- 簡約階段行列全体は $\left[ \begin{array}{ccc|c} 1 & 0 & 1/5 & 1 \\ 0 & 1 & -3/5 & 2 \\ 0 & 0 & 0 & 0 \end{array} \right]$ なので、$\text{rank}([A|\mathbf{b}]) = 2$。
- 未知数の数 $n=3$。
したがって、$\text{rank}(A) = \text{rank}([A|\mathbf{b}]) = 2 < n = 3$ なので、無数の解が存在します。自由度は $n - \text{rank}(A) = 3 - 2 = 1$ です。

### 5.3 解がない例

連立一次方程式:

$$
\begin{cases}
x + 2y = 5 \\
2x + 4y = 6
\end{cases}
$$

拡大係数行列 $[A|\mathbf{b}]$:

$$
\left[
\begin{array}{cc|c}
1 & 2 & 5 \\
2 & 4 & 6
\end{array}
\right]
$$

ガウスの消去法を適用:

$$
\left[
\begin{array}{cc|c}
1 & 2 & 5 \\
2 & 4 & 6
\end{array}
\right]
\xrightarrow{R_2 - 2R_1}
\left[
\begin{array}{cc|c}
1 & 2 & 5 \\
0 & 0 & -4
\end{array}
\right]
$$

この簡約階段行列の第2行は $0x + 0y = -4$、すなわち $0 = -4$ を意味し、これは矛盾です。
したがって、この連立方程式は**解なし**です。

**ランクによる確認**:
- 簡約階段行列の係数行列部分は $\begin{bmatrix} 1 & 2 \\ 0 & 0 \end{bmatrix}$ なので、$\text{rank}(A) = 1$。
- 簡約階段行列全体は $\left[ \begin{array}{cc|c} 1 & 2 & 5 \\ 0 & 0 & -4 \end{array} \right]$ なので、$\text{rank}([A|\mathbf{b}]) = 2$。
したがって、$\text{rank}(A) = 1 < \text{rank}([A|\mathbf{b}]) = 2$ なので、解は存在しません。

---

## 6. 幾何学的解釈

### 6.1 2次元空間 (平面) での解釈

2つの未知数 $x, y$ を持つ連立一次方程式は、各方程式が平面上の直線を表現します。

### 6.2 3次元空間での解釈

3つの未知数 $x, y, z$ を持つ連立一次方程式は、各方程式が3次元空間内の平面を表現します。

1.  **唯一解**: 3つの平面が1点で交わる。
2.  **無数の解**:
    -   3つの平面が1本の直線で交わる (交線が解の集合)。
    -   2つの平面が一致し、その平面が第3の平面と1本の直線で交わる。
    -   3つの平面がすべて一致する (平面上のすべての点が解)。
3.  **解なし**:
    -   少なくとも2つの平面が平行で、共通の交点/交線を持たない。
    -   3つの平面が互いに交わるが、共通の交点を持たない (例: 三角柱を形成するように交わる)。
    -   3つの平面がすべて平行で、互いに異なる位置にある。

---

## 7. 演習問題

### 7.1 基本問題

1.  以下の連立一次方程式を解き、解の種類（唯一解、無数の解、解なし）を判定しなさい。

(a)

$$
\begin{cases}
2x + 3y = 8 \\
-4x - 6y = -16
\end{cases}
$$

(b)
    
$$
\begin{cases}
2x + y - z = 3 \\
x - y + z = 2 \\
3x + 2y = 4
\end{cases}
$$
    
(c)

$$
\begin{cases}
x + 2y - z = 5 \\
2x + 4y - 2z = 6 \\
3x + 6y - 3z = 15
\end{cases}
$$

2.  次の係数行列 $A$ と定数ベクトル $\mathbf{b}$ で定まる連立一次方程式 $A\mathbf{x} = \mathbf{b}$ の解の種類を、ランクを調べることによって判定しなさい。

    (a) $A = \begin{bmatrix} 1 & 3 & 2 \\ 2 & 6 & 4 \\ 3 & 9 & 6 \end{bmatrix}$, $\mathbf{b} = \begin{bmatrix} 4 \\ 8 \\ 12 \end{bmatrix}$

    (b) $A = \begin{bmatrix} 1 & 3 & 2 \\ 2 & 6 & 4 \\ 3 & 9 & 6 \end{bmatrix}$, $\mathbf{b} = \begin{bmatrix} 4 \\ 8 \\ 10 \end{bmatrix}$

3.  ある連立一次方程式 $A\mathbf{x} = \mathbf{b}$ において、係数行列 $A$ のサイズが $4 \times 4$ (方程式の数4、未知数の数4) であり、$\text{rank}(A) = 2$、$\text{rank}([A|\mathbf{b}]) = 3$ であった。この方程式の解の種類はどうなるか。理由とともに説明しなさい。

### 7.2 応用問題

4.  パラメータ $\lambda$ を含む以下の連立一次方程式について、$\lambda$ の値によって解の種類がどのように変化するか調べなさい。

$$
\begin{cases}
x + y + z = 6 \\
x + 2y + \lambda z = 10 \\
x + 3y + \lambda^2 z = \lambda + 12
\end{cases}
$$

5.  3次元空間内の3点 $P_1(1, 2, 3)$, $P_2(2, 3, 1)$, $P_3(3, 1, 2)$ を通る平面の方程式を $ax + by + cz = d$ とする。

    (a) これら3点が平面上にあるという条件から、$a, b, c, d$ に関する連立一次方程式を立てなさい (ただし、$a,b,c$ の少なくとも1つは0でないとする)。
    
    (b) (a)で立てた連立一次方程式を解き、平面の方程式を求めなさい (解は一意に定まらない場合、パラメータ表示でよい。例えば $d=1$ とおくなどして特定の解を一つ見つけてもよい)。この問題の解の性質について考察しなさい。

