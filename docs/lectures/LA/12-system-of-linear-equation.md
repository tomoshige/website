# 線形代数学 I 第12回 講義ノート

## 1. 講義情報

**講義回**: 第12回  

**テーマ**: ランクの概念とその計算  

**関連項目**: 階段行列、簡約階段行列、行基本変形、行列のランク  

**予習すべき内容**: 連立一次方程式の行列表現、行列の基本変形、ガウスの消去法

**スライド**: [こちら](./slides/12-system-of-linear-equation-slide.pdf)

**演習問題**: [こちら](./exercise/exercise6.pdf)

## 2. 学習目標

1. 階段行列と簡約階段行列の定義と性質を理解する
2. 行基本変形を用いて階段行列と簡約階段行列を導出できるようになる
3. 行列のランクの概念を理解し、その意味を説明できるようになる
4. 行列のランクを計算できるようになる
5. ランクとベクトルの一次独立性の関係を理解する

## 3. 基本概念

### 3.1 階段行列の定義

> **定義**: 階段行列（echelon form）とは、以下の条件を満たす行列のことです。
> 1. すべてのゼロ行（要素がすべて0の行）は行列の下部に集められている
> 2. 各行の先頭の非ゼロ要素（先頭係数）は、その上の行の先頭非ゼロ要素よりも右にある
> 3. 先頭係数の列より左の列はすべて0である

階段行列は「階段のような形」をしています。次の行列は階段行列の例です：

$$
\begin{pmatrix}
2 & 3 & 1 & 7 \\
0 & 4 & -3 & 2 \\
0 & 0 & 1 & 5 \\
0 & 0 & 0 & 0
\end{pmatrix}
$$

この行列では：
- 1行目の先頭係数は第1列の2
- 2行目の先頭係数は第2列の4
- 3行目の先頭係数は第3列の1
- 4行目はゼロ行

このように、先頭係数が右下へと階段状に並んでいるため「階段行列」と呼ばれます。

### 3.2 簡約階段行列の定義

> **定義**: 簡約階段行列（reduced echelon form）とは、以下の追加条件を満たす階段行列のことです。
> 1. 各行の先頭係数は1である
> 2. 先頭係数のある列において、その先頭係数以外の要素はすべて0である

簡約階段行列の例：

$$
\begin{pmatrix}
1 & 0 & 0 & 2 \\
0 & 1 & 0 & -1 \\
0 & 0 & 1 & 3 \\
0 & 0 & 0 & 0
\end{pmatrix}
$$

この行列では：
- すべての先頭係数が1
- 先頭係数のある列（第1, 2, 3列）では、先頭係数以外の要素がすべて0

特に、各行の先頭係数が単位行列の形になっている部分があることに注目してください。

### 3.3 行列のランクの定義

> **定義**: 行列Aのランク（rank）とは、Aを階段行列（または簡約階段行列）に変形したときの非ゼロ行の数です。これは、（後で学ぶ）行列内の線形独立な行（または列）ベクトルの最大数を表します。

ランクは次のような記号で表します：
$\text{rank}(A)$ または $\text{r}(A)$

重要な性質：
- $m\times n$行列のランク$r$は、$r ≤ min(m, n)$ を満たす
- 行列のランクは、行基本変形によって変わらない
- 行列のランクは、その行ベクトルの最大線形独立数と列ベクトルの最大線形独立数に等しい

例えば、以下の階段行列のランクは3です（非ゼロ行が3行あるため）：

$$
\begin{pmatrix}
1 & 3 & 2 & 7 \\
0 & 1 & -3 & 2 \\
0 & 0 & 1 & 5 \\
0 & 0 & 0 & 0
\end{pmatrix}
$$

## 4. 理論と手法

### 4.1 行基本変形による階段行列の導出方法

**行基本変形**によって任意の行列は、階段行列・簡約階段行列に変形できます。
行基本変形には以下の3種類があります：

1. 行の入れ替え
2. 行のスカラー倍
3. ある行の定数倍を別の行に加える

### 4.2 ランクの計算方法

行列のランクを計算する手順：

1. 行基本変形を用いて行列を階段行列に変形する
2. 非ゼロ行の数を数える

### 4.3 簡約階段行列の一意性

行列$A$ に対して、行基本変形によって得られる簡約階段行列はただ1つである。すなわち同じ行列$A$に対して、異なる行基本変形によって得られた簡約階段行列を$B$と$B'$とすると、$B=B'$が成り立つ。


### 4.4 行列のランクと一次独立性の関係

行列ランクには以下の重要な性質がある。次回以降に扱うベクトルの1次独立との関係をここでは指摘しておく。

- 行列Aのランクは、Aの行ベクトルの中で一次独立なものの最大数
- 同様に、Aのランクは、Aの列ベクトルの中で一次独立なものの最大数

これにより、行列$A$のランクについて次の結果が成り立つ。

- $\text{rank}(A) = \text{rank}(A^T)$（転置行列のランクは元の行列と同じ）
- $\text{rank}(A) = \text{rank}(AA^T) = \text{rank}(A^TA)$
- $\text{rank}(AB) \leq \min(\text{rank}(A), \text{rank}(B))$（行列の積のランク）

## 5. 具体的な計算例

### 例題1: 階段行列への変形

行列Aを階段行列に変形してみましょう。

$$A = 
\begin{pmatrix}
2 & 1 & 3 & 7 \\
4 & -1 & 2 & 10 \\
6 & 3 & 9 & 18
\end{pmatrix}
$$

**解答**:

ステップ1: 第1列を処理します。先頭係数として第1行の2を選びます。

$$
\begin{pmatrix}
2 & 1 & 3 & 7 \\
4 & -1 & 2 & 10 \\
6 & 3 & 9 & 18
\end{pmatrix}
$$

第2行の要素を0にするため、第1行の(-2)倍を第2行に加えます。
$R_2 \leftarrow R_2 + (-2)R_1$

$$
\begin{pmatrix}
2 & 1 & 3 & 7 \\
0 & -3 & -4 & -4 \\
6 & 3 & 9 & 18
\end{pmatrix}
$$

第3行の要素を0にするため、第1行の(-3)倍を第3行に加えます。
$R_3 \leftarrow R_3 + (-3)R_1$

$$
\begin{pmatrix}
2 & 1 & 3 & 7 \\
0 & -3 & -4 & -4 \\
0 & 0 & 0 & -3
\end{pmatrix}
$$

ステップ2: 第2列を処理します。先頭係数として第2行の-3を選びます。

第3行は既に第2列が0なので処理する必要はありません。

ステップ3: 第3列を処理します。第3行は全て0になってしまっているため、第3列の処理は必要ありません。

結果として、階段行列は次のようになります：

$$
\begin{pmatrix}
2 & 1 & 3 & 7 \\
0 & -3 & -4 & -4 \\
0 & 0 & 0 & -3
\end{pmatrix}
$$

この行列は非ゼロ行が3行あるため、元の行列Aのランクは3です。

### 例題2: 簡約階段行列への変形

先ほどの階段行列を簡約階段行列に変形しましょう。

$$
\begin{pmatrix}
2 & 1 & 3 & 7 \\
0 & -3 & -4 & -4 \\
0 & 0 & 0 & -3
\end{pmatrix}
$$

**解答**:

ステップ1: 最下行から処理します。第3行の先頭係数を1にするため、行全体を-3で割ります。
$R_3 \leftarrow R_3 / (-3)$

$$
\begin{pmatrix}
2 & 1 & 3 & 7 \\
0 & -3 & -4 & -4 \\
0 & 0 & 0 & 1
\end{pmatrix}
$$

ステップ2: 第2行に移ります。先頭係数を1にするため、行全体を-3で割ります。
$R_2 \leftarrow R_2 / (-3)$

$$
\begin{pmatrix}
2 & 1 & 3 & 7 \\
0 & 1 & 4/3 & 4/3 \\
0 & 0 & 0 & 1
\end{pmatrix}
$$

第4列の第2行の要素を0にするため、第3行の(-4/3)倍を第2行に加えます。
$R_2 \leftarrow R_2 + (-4/3)R_3$

$$
\begin{pmatrix}
2 & 1 & 3 & 7 \\
0 & 1 & 4/3 & 0 \\
0 & 0 & 0 & 1
\end{pmatrix}
$$

ステップ3: 第1行に移ります。先頭係数を1にするため、行全体を2で割ります。
$R_1 \leftarrow R_1 / 2$

$$
\begin{pmatrix}
1 & 1/2 & 3/2 & 7/2 \\
0 & 1 & 4/3 & 0 \\
0 & 0 & 0 & 1
\end{pmatrix}
$$

第2列の第1行の要素を0にするため、第2行の(-1/2)倍を第1行に加えます。
$R_1 \leftarrow R_1 + (-1/2)R_2$

$$
\begin{pmatrix}
1 & 0 & 5/6 & 7/2 \\
0 & 1 & 4/3 & 0 \\
0 & 0 & 0 & 1
\end{pmatrix}
$$

第4列の第1行の要素を0にするため、第3行の(-7/2)倍を第1行に加えます。
$R_1 \leftarrow R_1 + (-7/2)R_3$

$$
\begin{pmatrix}
1 & 0 & 5/6 & 0 \\
0 & 1 & 4/3 & 0 \\
0 & 0 & 0 & 1
\end{pmatrix}
$$

これが簡約階段行列であり、非ゼロ行が3行あるので、ランクは3です。

## 6. 演習問題

### 6.1 基本問題

1. 以下の行列を階段行列に変形し、ランクを求めなさい。

$$A = \begin{pmatrix}
1 & 2 & 3 & 4 \\
2 & 4 & 6 & 8 \\
3 & 6 & 8 & 10
\end{pmatrix}$$

2. 以下の行列を簡約階段行列に変形し、ランクを求めなさい。

$$B = \begin{pmatrix}
1 & 2 & 3 \\
4 & 5 & 6 \\
7 & 8 & 9
\end{pmatrix}$$

3. 以下の行列のランクを求め、列ベクトルの線形独立性について考察しなさい。

$$C = \begin{pmatrix}
2 & 4 & 2 \\
1 & 2 & 1 \\
3 & 6 & 3
\end{pmatrix}$$

4. 以下の行列のランクと、その転置行列のランクを求め、両者が等しいことを確認しなさい。

$$D = \begin{pmatrix}
1 & 0 & 2 & -1 \\
0 & 1 & 3 & 2 \\
2 & 1 & 7 & 0
\end{pmatrix}$$

5. 行列 $A$ と $B$ について、$\text{rank}(AB) \leq \min(\text{rank}(A), \text{rank}(B))$ となることを、次の例を用いて確認しなさい。

$$A = \begin{pmatrix}
1 & 2 \\
3 & 4 \\
5 & 6
\end{pmatrix}, B = \begin{pmatrix}
1 & 0 & 2 \\
0 & 1 & 1
\end{pmatrix}$$

6. 行列 $A$ が次のとき、$\text{rank}(A^T A)$ と $\text{rank}(A A^T)$ を計算し、両者の関係について考察しなさい。

$$A = \begin{pmatrix}
1 & 0 & 2 \\
0 & 1 & 1 \\
0 & 0 & 0
\end{pmatrix}$$
