# 講義6: データサイエンスに必要な行列計算

## 1. 講義概要
- **講義時間:** 60分　/　**演習時間:** 30分
- **目的:**  
  データサイエンスの基礎として、行列の基本的な性質（単位行列、転置行列、対称行列）を理解し、計算手法を習得する。
- **今日の目標:**  
  各種行列の定義と性質を明確に把握し、Google Colab上での計算実例を通して、理論と実践の橋渡しができるようになる。

## 2. 理論的背景と内容の説明
### 2.1 定義・基本概念
- **単位行列:**  
  全ての対角成分が1、非対角成分が0である正方行列。任意の行列$A$に対して、$AI=IA=A$が成り立つ。  
  （例：$I_3=\begin{pmatrix}1&0&0\\0&1&0\\0&0&1\end{pmatrix}$）
- **転置行列:**  
  行列$A$の行と列を入れ替えた行列$A^T$。基本性質として、$(A^T)^T=A$、$(A+B)^T=A^T+B^T$、$(AB)^T=B^T A^T$がある。
- **対称行列:**  
  転置しても変わらない行列、すなわち$A=A^T$となる正方行列。対称行列は固有値が実数であるなど、解析上重要な性質を持つ。

### 2.2 定理・命題
- **単位行列の性質:**  
  任意の行列$A$に対して、$AI=IA=A$が成立する。
- **転置行列の基本性質:**  
  - $(A^T)^T = A$
  - $(A+B)^T = A^T+B^T$
  - $(\alpha A)^T = \alpha A^T \quad (\alpha \in \mathbb{R})$
  - $(AB)^T = B^T A^T$
- **対称行列の性質:**  
  - 対称行列は必ず正方行列である。
  - 任意の行列$A$に対して、$A+A^T$は対称行列となる。

### 2.3 数式・証明の詳細
- **単位行列の計算例:**  
  例えば、以下のような3×3行列$A$を考えます。

    $$
    A=\begin{pmatrix}
    2 & 3 & 4 \\
    1 & 0 & -1 \\
    5 & 2 & 3
    \end{pmatrix}
    $$

    また、3×3の単位行列$I$は

    $$
    I=\begin{pmatrix}
    1 & 0 & 0 \\
    0 & 1 & 0 \\
    0 & 0 & 1
    \end{pmatrix}
    $$

    となります。

    単位行列の定義から、任意の3×3行列$A$に対して、$IA=A$および$AI=A$が成立します。具体的に$I$と$A$の積を計算すると、

    $$
    IA = \begin{pmatrix}
    1 & 0 & 0 \\
    0 & 1 & 0 \\
    0 & 0 & 1
    \end{pmatrix}
    \begin{pmatrix}
    2 & 3 & 4 \\
    1 & 0 & -1 \\
    5 & 2 & 3
    \end{pmatrix}
    $$
    $$
    =\begin{pmatrix}
    1\cdot2+0\cdot1+0\cdot5 & 1\cdot3+0\cdot0+0\cdot2 & 1\cdot4+0\cdot(-1)+0\cdot3 \\
    0\cdot2+1\cdot1+0\cdot5 & 0\cdot3+1\cdot0+0\cdot2 & 0\cdot4+1\cdot(-1)+0\cdot3 \\
    0\cdot2+0\cdot1+1\cdot5 & 0\cdot3+0\cdot0+1\cdot2 & 0\cdot4+0\cdot(-1)+1\cdot3 
    \end{pmatrix}
    =\begin{pmatrix}
    2 & 3 & 4 \\
    1 & 0 & -1 \\
    5 & 2 & 3
    \end{pmatrix}
    =A.
    $$

この例により、単位行列$I$との積が元の行列$A$を変えないことが確認できます。
- **転置の計算例:**  
  例：$A=\begin{pmatrix}1 & 2 \\ 3 & 4 \\ 5 & 6\end{pmatrix}$の場合、  
  $$
  A^T=\begin{pmatrix}1 & 3 & 5 \\ 2 & 4 & 6\end{pmatrix}
  $$
- **対称行列の確認:**  
    まず、与えられた行列
    $$
    A=\begin{pmatrix}
    2 & 3 & 4 \\
    1 & 0 & -1 \\
    5 & 2 & 3
    \end{pmatrix}
    $$

    に対して、その転置行列は

    $$
    A^T=\begin{pmatrix}
    2 & 1 & 5 \\
    3 & 0 & 2 \\
    4 & -1 & 3
    \end{pmatrix}
    $$
    となります。

    1. $A+A^T$ が対称であること

    任意の行列$A$に対して、転置の性質より

    $$
    (A+A^T)^T = A^T + (A^T)^T = A^T + A = A+A^T
    $$

    が成立します。したがって、$A+A^T$は対称行列です。

    具体的に計算すると、

    $$
    A+A^T=
    \begin{pmatrix}
    2 & 3 & 4 \\
    1 & 0 & -1 \\
    5 & 2 & 3
    \end{pmatrix}
    +
    \begin{pmatrix}
    2 & 1 & 5 \\
    3 & 0 & 2 \\
    4 & -1 & 3
    \end{pmatrix}
    =
    \begin{pmatrix}
    2+2 & 3+1 & 4+5 \\
    1+3 & 0+0 & -1+2 \\
    5+4 & 2+(-1) & 3+3
    \end{pmatrix}
    =
    \begin{pmatrix}
    4 & 4 & 9 \\
    4 & 0 & 1 \\
    9 & 1 & 6
    \end{pmatrix}.
    $$

    この行列は、$(1,2)$の成分が4であり、$(2,1)$も4、$(1,3)$が9で$(3,1)$が9、$(2,3)$が1で$(3,2)$も1となっており、明らかに各成分が対称になっています。

    2. $A^T A$ が対称であること

    一般に、任意の行列$A$に対して、

    $$
    (A^T A)^T = A^T (A^T)^T = A^T A
    $$

    が成り立つため、$A^T A$は対称行列となります。

    具体的に計算して確認してみましょう。

    まず、$A^T A$ の $(i,j)$ 成分は、$A^T$の$i$行と$A$の$j$列の内積です。

    - $(1,1)$成分:
    $$
    (A^T A)_{11} = 2\cdot2 + 1\cdot1 + 5\cdot5 = 4 + 1 + 25 = 30.
    $$

    - $(1,2)$成分:
    $$
    (A^T A)_{12} = 2\cdot3 + 1\cdot0 + 5\cdot2 = 6 + 0 + 10 = 16.
    $$

    - $(1,3)$成分:
    $$
    (A^T A)_{13} = 2\cdot4 + 1\cdot(-1) + 5\cdot3 = 8 - 1 + 15 = 22.
    $$

    - $(2,1)$成分:
    $$
    (A^T A)_{21} = 3\cdot2 + 0\cdot1 + 2\cdot5 = 6 + 0 + 10 = 16.
    $$

    - $(2,2)$成分:
    $$
    (A^T A)_{22} = 3\cdot3 + 0\cdot0 + 2\cdot2 = 9 + 0 + 4 = 13.
    $$

    - $(2,3)$成分:
    $$
    (A^T A)_{23} = 3\cdot4 + 0\cdot(-1) + 2\cdot3 = 12 + 0 + 6 = 18.
    $$

    - $(3,1)$成分:
    $$
    (A^T A)_{31} = 4\cdot2 + (-1)\cdot1 + 3\cdot5 = 8 - 1 + 15 = 22.
    $$

    - $(3,2)$成分:
    $$
    (A^T A)_{32} = 4\cdot3 + (-1)\cdot0 + 3\cdot2 = 12 + 0 + 6 = 18.
    $$

    - $(3,3)$成分:
    $$
    (A^T A)_{33} = 4\cdot4 + (-1)\cdot(-1) + 3\cdot3 = 16 + 1 + 9 = 26.
    $$

        よって、

        $$
        A^T A =
        \begin{pmatrix}
        30 & 16 & 22 \\
        16 & 13 & 18 \\
        22 & 18 & 26
        \end{pmatrix}.
        $$

        この行列では、$(1,2)=16$と$(2,1)=16$、$(1,3)=22$と$(3,1)=22$、$(2,3)=18$と$(3,2)=18$となっており、各成分が対称であることが確認できます。

    以上より、与えられた行列$A$について、$A+A^T$と$A^T A$がともに対称行列であることが示されました。

## 3. 扱う内容の実例（GPT, Colab等は使用せず）
- **実例1:**  
  単位行列と任意行列の乗算の具体例をホワイトボード上で解説し、$AI=IA=A$が成り立つことを確認する。
- **実例2:**  
  転置行列の計算例として、具体的な数値行列の転置操作を紙上で手計算し、$(A^T)^T=A$などの性質を示す。
- ※実例は紙上での手計算またはホワイトボードでの説明を想定し、各性質の確認方法を強調する。

## 4. ChatGPTによる解説＋Colabでの実行例
- **ChatGPT解説:**  
  各行列の性質は、データサイエンスのアルゴリズムや数値解析において重要な役割を果たします。  
  単位行列は基本的な行列の恒等性を示し、転置行列はデータの構造変換に利用されます。  
  対称行列は、共分散行列や距離行列などに現れるため、固有値解析などで重要です。  
  また、トレースは行列の性質を一目で把握できる指標として、数理統計や最適化問題で使用されます。
- **Colab実行例:** 以下に、各性質を確認するためのサンプルコードと実行結果を提示する。
  ```python
  import numpy as np

  # サンプル行列の定義
  A = np.array([[1, 2, 3],
                [4, 5, 6],
                [7, 8, 9]])
  
  # 単位行列の生成（サイズ3×3）
  I = np.eye(3)
  print("単位行列 I:")
  print(I, "\n")
  
  # 転置行列の計算
  A_T = A.T
  print("行列 A の転置 A^T:")
  print(A_T, "\n")
  
  # 対称行列の例：A + A^T (対称行列となる)
  S = A + A_T
  print("対称行列 S = A + A^T:")
  print(S, "\n")
  
  # 行列のトレースの計算
  trace_A = np.trace(A)
  print("行列 A のトレース:", trace_A)


## 6. 演習問題
- **問題1:**  
  任意の$3×3$行列$A$を定義し、単位行列$I$との乗算により$AI=IA=A$であることを確認せよ。  

- **問題2:**  
  行列
  $$
  A=\begin{pmatrix}
  2 & 3 & 1 \\
  0 & -1 & 4 \\
  5 & 2 & 0
  \end{pmatrix}
  $$
  の転置$A^T$を求め、$(A^T)^T=A$が成立することを示せ。  また、$A^{T}A$を計算せよ。

- **問題3:**  
  以下の行列
  $$
  B=\begin{pmatrix}
  3 & 1 & 2 \\
  1 & 4 & 0 \\
  2 & 0 & 5
  \end{pmatrix}
  $$
  が対称行列であることを確認しなさい。