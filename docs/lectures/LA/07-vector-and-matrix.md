# 講義7: データとベクトルの和と積

## 1. 講義概要
- **講義時間:** 60分　/　**演習時間:** 30分
- **目的:**  
  1次元データをベクトルとして捉え、ベクトル演算（加法、内積、スカラー倍）を用いて、データの平均、偏差、分散の計算方法を理解する。
- **今日の目標:**  
  ・データの平均、偏差、分散の定義とその計算方法を明確にする。  
  ・ベクトルを用いた表現で、統計量がどのように求められるかを具体例を通して確認する。  
  ・Google Colab上での実行例により、理論と実践の両面から理解を深める。

## 2. 理論的背景と内容の説明
### 2.1 定義・基本概念
- **ベクトル:**  
  1次元データの集合を $\mathbf{x} = (x_1, x_2, \dots, x_n)$ として表現する。  
- **データの平均:**  
  $$ \bar{x} = \frac{1}{n}\sum_{i=1}^{n} x_i $$  
  ベクトルの場合、平均を全成分が1のベクトル$\mathbf{1}$を用いて、$$ \bar{x}\mathbf{1} $$ と表現できる。
- **データの偏差:**  
  各データ点の平均からの差：  
  $$ x_i - \bar{x} $$  
  ベクトル全体では、$$ \mathbf{x} - \bar{x}\mathbf{1} $$ と書く。
- **データの分散:**  
  $$ \sigma^2 = \frac{1}{n}\sum_{i=1}^{n}(x_i - \bar{x})^2 $$  
  ベクトルの内積を用いると、  
  $$ \sigma^2 = \frac{1}{n}\|\mathbf{x} - \bar{x}\mathbf{1}\|^2 = \frac{1}{n}(\mathbf{x} - \bar{x}\mathbf{1})^T (\mathbf{x} - \bar{x}\mathbf{1}). $$

### 2.2 定理・命題
- **線形性:**  
  平均は線形演算であり、  
  $$ \overline{a\mathbf{x} + b\mathbf{y}} = a\bar{x} + b\bar{y} $$  
  が成立する。
- **内積の対称性:**  
  内積は対称性を持ち、  
  $$ (\mathbf{x} - \bar{x}\mathbf{1})^T (\mathbf{x} - \bar{x}\mathbf{1}) = \|\mathbf{x} - \bar{x}\mathbf{1}\|^2 $$  
  と表現される。
- **ノルムと分散:**  
  分散は、データのばらつきを内積（ノルムの2乗）で表すため、  
  $$ \sigma^2 = \frac{1}{n}\|\mathbf{x} - \bar{x}\mathbf{1}\|^2. $$

### 2.3 数式・証明の詳細
- **平均のベクトル表示:**  
  平均値を $\bar{x}$ とすると、  
  $$ \bar{x}\mathbf{1} = \frac{1}{n}(x_1+x_2+\cdots+x_n)
  \begin{pmatrix}
  1 \\ 1 \\ \vdots \\ 1
  \end{pmatrix}. $$
- **分散の内積表示:**  
  $$ \sigma^2 = \frac{1}{n} (\mathbf{x} - \bar{x}\mathbf{1})^T (\mathbf{x} - \bar{x}\mathbf{1}). $$
- **具体的な計算例:**  
  例：データ $\mathbf{x} = (3, 5, 7, 9)$ の場合  
  - 平均:  
    $$ \bar{x} = \frac{3+5+7+9}{4} = 6. $$
  - 偏差ベクトル:  
    $$ \mathbf{x} - \bar{x}\mathbf{1} = (3-6,\, 5-6,\, 7-6,\, 9-6) = (-3, -1, 1, 3). $$
  - 分散:  
    $$ \sigma^2 = \frac{(-3)^2 + (-1)^2 + 1^2 + 3^2}{4} = \frac{9+1+1+9}{4} = 5. $$

## 3. 扱う内容の実例（GPT, Colab等は使用せず）
- **実例1:**  
  生データ $\mathbf{x} = (10, 20, 30, 40, 50)$ を用いて、  
  - 平均: $$ \bar{x} = \frac{10+20+30+40+50}{5} = 30. $$
  - 偏差: $$ (10-30,\, 20-30,\, 30-30,\, 40-30,\, 50-30) = (-20, -10, 0, 10, 20). $$
  - 分散: $$ \sigma^2 = \frac{20^2+10^2+0^2+10^2+20^2}{5} = \frac{400+100+0+100+400}{5} = 200. $$
- **実例2:**  
  ホワイトボードで、データの各要素から平均を引く操作や、内積計算により分散を求める計算手順を解説する。

## 4. ChatGPTによる解説＋Colabでの実行例
- **ChatGPT解説:**  
  データの平均、偏差、分散は、ベクトルとして表現することで、内積やノルムなどの線形代数のツールを用いて効率的に計算できる。  
  これにより、1次元データの基本的な統計量が、行列やベクトルの演算を通して直感的に理解できるようになる。  
  大規模データの場合、NumPy等のライブラリを利用することで、計算処理が高速かつ正確に行われる点も重要である。
- **Colab実行例:** 以下に、PythonとNumPyを用いたサンプルコードを示す。
  ```python
  import numpy as np

  # サンプルデータ: 1次元データをベクトルとして定義
  x = np.array([3, 5, 7, 9])
  n = x.size

  # データの平均の計算
  mean = np.mean(x)
  print("データの平均:", mean)

  # データの偏差の計算
  deviation = x - mean
  print("データの偏差:", deviation)

  # 分散の計算（母分散の計算）
  variance = np.sum(deviation ** 2) / n
  print("データの分散:", variance)
  ```

## 5. 学んだ内容の応用例
- **応用分野:**  
  統計解析、機械学習、データマイニング、信号処理など
- **具体例:**  
  - **主成分分析 (PCA):** 多変量データの分散共分散行列の計算により次元削減を行う。  
  - **クラスタリング:** クラスタの中心（平均）を求め、各データの偏差をもとにクラスタリングを実施する。  
  - **時系列解析:** 移動平均や分散を計算することで、データの変動パターンを解析する。

## 6. 演習問題
- **問題1:**  
  1次元データ $\mathbf{x} = (8, 12, 10, 14, 16)$ の平均、偏差、分散を手計算およびPythonで計算し、その結果を比較せよ。  
  *【ヒント】* 平均は全データの和をデータ数で割る。

- **問題2:**  
  任意の1次元データベクトルを定義し、$\mathbf{x}$ と $\mathbf{x} - \bar{x}\mathbf{1}$ の内積がどのような意味を持つか考察せよ。  
  *【ヒント】* 内積が0になる条件について考えてみる。

- **問題3:**  
  ベクトル演算を用いて、分散がどのように内積で表現されるかを証明せよ。  
  *【ヒント】* $$\sigma^2 = \frac{1}{n} (\mathbf{x} - \bar{x}\mathbf{1})^T (\mathbf{x} - \bar{x}\mathbf{1})$$ の形に注目する。

- **問題4:**  
  以下の2つの7要素からなるデータについて、各データの平均および分散を計算し、分散が小さい・大きいという概念について考察せよ。  
  - **データA:** $(10,\ 11,\ 9,\ 10,\ 10,\ 11,\ 9)$  
  - **データB:** $(2,\ 15,\ -5,\ 20,\ 8,\ 0,\ 30)$  
  *【ヒント】*  
    - 各データの平均は、全要素の和を7で割ることで求められる。  
    - 分散は、各要素と平均の差の二乗の平均として求める。  
    - 分散が小さい場合は、データのばらつき（散らばり）が小さいことを、分散が大きい場合はデータが広く散らばっていることを示す。

- **問題5:**  
  1次元データベクトル $\mathbf{x} = (x_1, x_2, \dots, x_n)$ に対して、各要素の偏差値（標準得点）をベクトルを用いて表現せよ。  
  すなわち、各成分の偏差値  
  $$
  z_i = \frac{x_i - \bar{x}}{\sigma} \quad (i=1,\dots,n)
  $$
  を、ベクトル記法を用いて  
  $$
  \mathbf{z} = \frac{\mathbf{x} - \bar{x}\mathbf{1}}{\sigma}
  $$
  と表し、その計算過程を示せ。  
  *【ヒント】*  
  - 平均は、$$ \bar{x} = \frac{1}{n}\sum_{i=1}^{n} x_i $$ として求め、$\bar{x}\mathbf{1}$ として全要素に展開できる。  
  - 標準偏差は、$$ \sigma = \sqrt{\frac{1}{n} (\mathbf{x} - \bar{x}\mathbf{1})^T (\mathbf{x} - \bar{x}\mathbf{1})} $$ で計算できる。  
  - ベクトル演算を利用することで、各成分の計算を一括して表現できる。

## 付録・参考資料
- **参考文献:**  
  - 『線形代数学入門』、『統計学入門』、オンライン教材（Khan Academy, Courseraなど）
- **補足資料:**  
  - 詳細な解説スライド  
  - 追加例題集および演習問題の解答例  
  - FAQ: ベクトル演算を用いた統計量計算に関するよくある質問とその解説