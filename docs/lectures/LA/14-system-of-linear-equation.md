# 講義13: 連立方程式の解の存在条件と判別

## 1. 講義概要
- **講義時間:** 60分　/　**演習時間:** 30分
- **目的:** 連立1次方程式の解の存在条件を理解し、拡大係数行列のランクを用いた解の判別法を習得する。
- **今日の目標:** 拡大係数行列のランク計算の手法を学び、解の一意性、無限解、解なしの各パターンを具体例とともに明確に判別できるようになる。

## 2. 理論的背景と内容の説明
### 2.1 定義・基本概念
- **拡大係数行列:** 連立1次方程式の係数行列と定数項を組み合わせた行列。  
  例：$A$を係数行列、$b$を定数項ベクトルとすると、拡大係数行列は$[A|b]$と表す。
- **ランク:** 行列の中で互いに線形独立な行または列の最大数。  
  解の存在条件の判定において重要な役割を果たす。

### 2.2 定理・命題
- **解の存在定理:**  
  連立1次方程式は、係数行列$A$と拡大係数行列$[A|b]$のランクが等しければ解が存在する。  
  $$\mathrm{rank}(A)=\mathrm{rank}([A|b])$$  
  不等の場合は解が存在しない。
- **解の一意性と無限解の条件:**  
  - 一意解が存在するためには、$\mathrm{rank}(A)=n$（$n$は未知数の数）である必要がある。  
  - $\mathrm{rank}(A) < n$の場合、自由変数が生じ無限解となる。

### 2.3 数式・証明の詳細
- **基本的な証明の流れ:**  
  1. 連立方程式を行列表示し、係数行列$A$と定数項ベクトル$b$を整理する。  
  2. 拡大係数行列$[A|b]$を作成し、ガウス・ジョルダン法などで簡約化する。  
  3. $\mathrm{rank}(A)$と$\mathrm{rank}([A|b])$の比較から、解の存在と一意性または無限解の条件を導出する。  
- **数式例:**  
  例として、2変数の場合  
  $$
  \begin{cases}
  2x + 3y = 5 \\
  4x + 6y = 10
  \end{cases}
  $$
  の場合、  
  $$
  A=\begin{pmatrix}2 & 3\\4 & 6\end{pmatrix},\quad [A|b]=\begin{pmatrix}2 & 3 & 5\\4 & 6 & 10\end{pmatrix}
  $$  
  とし、ランクが等しいが未知数の数より小さいため無限解となる。

## 3. 扱う内容の実例（GPT, Colab等は使用せず）
- **実例1:**  
  2変数2方程式の例：  
  $$
  \begin{cases}
  2x + 3y = 5 \\
  4x + 6y = 10
  \end{cases}
  $$
  この場合、係数行列と拡大係数行列のランクが同じであるが、未知数の数（2）よりランクが小さいため無限解が存在する。
- **実例2:**  
  3変数3方程式の例：  
  $$
  \begin{cases}
  x + y + z = 3 \\
  2x + 3y + 4z = 8 \\
  3x + 4y + 5z = 10
  \end{cases}
  $$
  それぞれの行列を作成し、ランク計算を通じて一意解または無解のパターンを議論する。
- ※これらの例は、紙上での手計算やホワイトボードでの解説を想定する。

## 4. ChatGPTによる解説＋Colabでの実行例
- **ChatGPT解説:**  
  連立方程式の解の存在条件は、拡大係数行列のランクの計算により判別される。  
  具体的には、係数行列$A$と拡大係数行列$[A|b]$のランクが一致する場合に解が存在し、その後未知数の数とランクの関係から一意解または無限解かを決定する。  
  ガウス・ジョルダン法を利用して行列の簡約化を行う手順や、自由変数の存在がどのように無限解を導くかを詳細に解説する。
- **Colab実行例:** 以下にサンプルコードと実行結果を提示
  ```python
  # サンプルコード：拡大係数行列のランク計算例
  import numpy as np

  # 連立方程式: 2x + 3y = 5, 4x + 6y = 10 の例
  A = np.array([[2, 3],
                [4, 6]])
  b = np.array([5, 10])
  
  # 拡大係数行列の作成
  Ab = np.column_stack((A, b))
  
  # ランクの計算
  rank_A = np.linalg.matrix_rank(A)
  rank_Ab = np.linalg.matrix_rank(Ab)
  
  print("係数行列 A のランク:", rank_A)
  print("拡大係数行列 [A|b] のランク:", rank_Ab)
  
  # 解の存在条件の判定
  if rank_A == rank_Ab:
      if rank_A == A.shape[1]:
          print("一意解が存在します。")
      else:
          print("無限解が存在します。")
  else:
      print("解は存在しません。")
  ```

## 5. 学んだ内容の応用例
- **応用分野:**  
  コンピュータグラフィックス、機械学習、統計解析など、多様な分野において連立方程式の解法は基本的な技法となる。
- **具体例:**  
  - **主成分分析 (PCA):** 行列のランクや固有値分解を利用してデータの次元削減を行う。  
  - **数値解析:** 線形システムの解法が、微分方程式の数値解法や最適化問題に応用される。
- 応用例では、理論で学んだランク計算の考え方が現実の問題解決にどのように貢献するかを具体的に示す。

## 6. 演習問題
- **問題1:**  
  以下の連立方程式の係数行列と拡大係数行列を作成し、それぞれのランクを計算せよ。  
  $$
  \begin{cases}
  x + 2y = 3 \\
  2x + 4y = 6
  \end{cases}
  $$
- **問題2:**  
  3変数の連立方程式
  $$
  \begin{cases}
  x + y + z = 3 \\
  2x + 3y + 4z = 8 \\
  3x + 4y + 5z = 10
  \end{cases}
  $$
  において、係数行列と拡大係数行列のランクを比較し、一意解、無限解、または解なしのどれに該当するかを判定せよ。
- **問題3:**  
  応用問題として、実世界のデータ（例：統計データ）に基づいた連立方程式の例を考え、ランク計算を用いて解の存在条件を確認せよ。
- ※各問題には、授業内でのヒントや解説（演習後の確認用）を付加する。

## 付録・参考資料
- **参考文献:**  
  - 「線形代数学入門」などの教科書  
  - 論文、オンライン講義資料（例: Khan Academy, MIT OpenCourseWare）
- **補足資料:**  
  - 詳細な解説スライド  
  - 追加例題集  
  - FAQ: 連立方程式の解の存在条件に関するよくある質問