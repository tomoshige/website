# 講義9: 連立方程式の解の種類

## 1. 本日扱う内容について（概要）
- **目的:**  
    - 連立一次方程式の解の種類（解が一意、解が無数、解が存在しない）の概念を理解する  
    - 3つの未知数を含む連立一次方程式を中心に、各解のパターンの例を学ぶ  
    - Google Colab を用いて、2変数および3変数の場合のシミュレーションと図示により、幾何学的な解のパターン（直線の交点、平面の交点など）を視覚的に理解する

- **講義の流れ:**  
    1. 連立一次方程式の解の種類の理論的背景（定義・定理・数式）  
    2. 具体例の紹介（3変数の例：一意解、無数解、解なし；2変数の例も併せて）  
    3. ChatGPTによる解説＋Google Colabでの実行例（シミュレーションと図示）  
    4. 学んだ内容の応用例  
    5. 演習問題

---

## 2. 扱う内容の理論の説明（定義・定理・数式を含む）

- これまでの連立1次方程式
    - ここまでの議論では一般的な連立方程式を紹介しつつも、未知数の数と方程式の数が同じ連立方程式を扱ってきました。
    - 連立1次方程式は必ず解けて、解はただ1つに定まった。

- これからの連立1次方程式
    - 未知数の数と方程式の数は同じではない。
    - 連立1次方程式の解がただ1つに定まる場合、解が存在しない場合や、解が無数に存在する場合もある

実際、現実に扱われる連立1次方程式では、未知数の数と方程式の数も異なるし、解が1つに定まるとは限りません。
どのように、そのような連立1次方程式を解いていけば良いのか、解が存在するかを判断するかが1つの大きな問題です。

### 連立1次方程式の一般形

- **定義:**  
  未知数 $x_1, x_2, \dots, x_n$ に対して、$m$ 本の一次方程式が同時に成立する連立一次方程式は、以下のように書くことができる。
  $$
  \begin{cases}
  a_{11} x_1 + a_{12} x_2 + \cdots + a_{1n} x_n = b_1, \\\
  a_{21} x_1 + a_{22} x_2 + \cdots + a_{2n} x_n = b_2, \\\
  \quad\vdots \\\
  a_{m1} x_1 + a_{m2} x_2 + \cdots + a_{mn} x_n = b_m.
  \end{cases}
  $$

### 連立一次方程式の解の種類

連立一次方程式の解のパターンは大きく3つに分類されます：

1. **一意解 (Unique Solution):**  
    すべての方程式が独立で、解がただ1つ定まる場合。  
    （例：各方程式が異なる平面を表し、それらが一点で交わる場合）
2. **無数の解 (Infinitely Many Solutions):**  
    方程式同士に依存関係があり、自由変数が存在する場合。  
    （例：3本の方程式のうち2本が独立で、残りがその組み合わせになっている場合）
3. **解なし (No Solution):**  
    複数の方程式が矛盾しており、どの解も満たせない場合。  
    （例：同じ左辺に対して異なる右辺が設定されている場合）

### 数式による条件（概念レベルの説明）
- **一意解の場合:**  
    方程式が独立で、自由変数がない場合。
- **無数の解の場合:**  
    少なくとも1つの自由変数が存在し、解の集合がパラメータ表示できる場合。
- **解なしの場合:**  
    複数の方程式が互いに矛盾しているため、共通の解が存在しない場合。

> ※ 注意：本講義では拡大係数行列の操作は次回の講義で詳しく扱うため、今回は解の種類そのものと、その性質・条件に着目して説明します。

---

## 3. 扱う内容の例（実例を提示、GPT, Colabなどは利用しない）

### 【2変数の連立一次方程式の場合】

1. **一意解の例:**  
    \[
    \begin{cases}
    x + 2y = 5, \\
    3x - y = 4.
    \end{cases}
    \]
    - 直線同士が交わり、一点で交差するので、解は一意です。

2. **無数の解の例:**  
    \[
    \begin{cases}
    x + 2y = 5, \\
    2x + 4y = 10.
    \end{cases}
    \]
    - 2行目は 1行目の倍数なので、2つの直線は同一であり、無数の解が存在します（直線全体が解集合）。

3. **解が存在しない例:**  
    \[
    \begin{cases}
    x + 2y = 5, \\
    2x + 4y = 11.
    \end{cases}
    \]
    - 2行目は 1行目の倍数ではないため、2つの直線は平行で交わらず、解は存在しません。

### 【3変数の連立一次方程式の場合】

1. **一意解の例**
    \[
    \begin{cases}
    3x + y + z = -5, \\
    4x + 3y - z = -2, \\
    5x + 4y + z = 6.
    \end{cases}
    \]
    この系は独立な方程式で、一意解が存在し、（例として以前の講義で示したように）解は  
    \[
    x = -5,\quad y = 7,\quad z = 3.
    \]

2. **無数の解の例**
    \[
    \begin{cases}
    x + 2y - z = 1, \\
    2x -3y - 2z = 2, \\
    3x - y - 3z = 3.
    \end{cases}
    \]
    ここでは、3番目と式は、1番目の式と2番目の式の和であるため、実質的に独立な式は 2 本となり、自由変数が1つ存在して無数の解（パラメータ表示）が得られます。

3. **解が存在しない例**
    \[
    \begin{cases}
    x + y + z = 2, \\
    2x + 2y + 2z = 4, \\
    x + y + z = 3.
    \end{cases}
    \]
    1番目と3番目の式は同じ左辺ですが右辺が異なるため、矛盾が生じ、解は存在しません。


---

## 4. ChatGPTによる解説＋Google Colab での実行例

### ChatGPTによる解説
- **解説ポイント:**  
  - 連立一次方程式の解の種類は、係数行列の線形独立性に依存します。  
  - 一意解が得られる場合は、各方程式が独立しており、未知数の数と方程式のランクが一致します。  
  - 無数の解がある場合、方程式間に線形依存性があり、自由変数が存在するため、解集合はパラメータで表される線形空間（直線や平面）となります。  
  - 解が存在しない場合、方程式間で矛盾があり、条件を同時に満たす解が存在しません。  
  - これらの概念を、2変数の場合の直線の交点、また 3変数の場合の平面の交点の図示によって視覚的に理解します。

### Google Colabでの実行例

#### 【2変数の場合】
```python
import numpy as np
import matplotlib.pyplot as plt

# 一意解の例: 直線の交点
x = np.linspace(-5, 5, 400)
# 直線1: x + 2y = 5  → y = (5 - x)/2
y1 = (5 - x) / 2
# 直線2: 3x - y = 4  → y = 3x - 4
y2 = 3 * x - 4

plt.figure(figsize=(8,6))
plt.plot(x, y1, label="x + 2y = 5")
plt.plot(x, y2, label="3x - y = 4")
# 解を代数的に求める（交点）
# 交点: 解 x, y を求める
# 例として、交点が (1, 2) とする（実際の計算は省略）
plt.plot(1, 2, 'ro', label="交点 (1,2)")
plt.xlabel("x")
plt.ylabel("y")
plt.title("一意解: 直線の交点")
plt.legend()
plt.grid(True)
plt.show()

# 無数解の例: 同一の直線
plt.figure(figsize=(8,6))
plt.plot(x, (5 - x) / 2, label="x + 2y = 5")
plt.plot(x, (5 - x) / 2, 'r--', label="2x + 4y = 10 (同じ直線)")
plt.xlabel("x")
plt.ylabel("y")
plt.title("無数解: 同一の直線")
plt.legend()
plt.grid(True)
plt.show()

# 解が存在しない例: 平行な直線
plt.figure(figsize=(8,6))
plt.plot(x, (5 - x) / 2, label="x + 2y = 5")
# 2行目: 2x + 4y = 11 → y = (11 - 2x)/4
plt.plot(x, (11 - 2*x) / 4, label="2x + 4y = 11")
plt.xlabel("x")
plt.ylabel("y")
plt.title("解が存在しない: 平行な直線")
plt.legend()
plt.grid(True)
plt.show()
```

#### 【3変数の場合】
3変数の場合は、各方程式は平面を表し、以下の例でシミュレーションします。

1. **一意解の例 (Unique Solution):**  
   例題：  
   \[
   \begin{cases}
   x + y + z = 6, \\
   2x + 3y + 4z = 14, \\
   3x + 4y + 5z = 20.
   \end{cases}
   \]
   この場合、3平面は一点で交わり、一意解が得られます。

2. **無数の解の例 (Infinitely Many Solutions):**  
   例題：  
   \[
   \begin{cases}
   x + y + z = 6, \\
   2x + 3y + 4z = 14, \\
   3x + 4y + 5z = 20.
   \end{cases}
   \]
   ※ 実は、3行目が1行目と2行目の線形結合になっている場合、ランクは 2 となり、解は無限に存在します。

3. **解が存在しない例 (No Solution):**  
   例題：  
   \[
   \begin{cases}
   x + y + z = 6, \\
   2x + 3y + 4z = 14, \\
   3x + 4y + 5z = 21.
   \end{cases}
   \]
   この場合、3行目が矛盾するため、平面は交わらず解は存在しません。

以下は、3変数の場合のシンプルな 3D プロット例（ただし、ここでは解の計算の詳細は省略し、概念図示に重点を置いています）。


#### Google Colab での Plotly を用いた 3次元可視化の実装例
以下のコードは、例A（一意解の例）の3変数連立一次方程式に対する3平面の交点（解）の 3D 可視化を、Plotly を用いてインタラクティブに表示します。Plotly の図は回転や拡大縮小が可能です。

```python
import numpy as np
import plotly.graph_objects as go

# グリッドの定義
x = np.linspace(-15, 15, 50)
y = np.linspace(-15, 15, 50)
X, Y = np.meshgrid(x, y)

# 平面の定義（例Aの各式を z = f(x, y) の形に変形）
# (1) 3x + y + z = -5  →  z = -5 - 3x - y
Z1 = -5 - 3 * X - Y
# (2) 4x + 3y - z = -2  →  z = 4x + 3y + 2
Z2 = 4 * X + 3 * Y + 2
# (3) 5x + 4y + z = 6   →  z = 6 - 5x - 4y
Z3 = 6 - 5 * X - 4 * Y

# 一意解の例の解（例として前回示した解）
solution = np.array([-5, 7, 3])

# Plotly の Figure を作成して各平面を追加
fig = go.Figure()

fig.add_trace(go.Surface(x=X, y=Y, z=Z1, opacity=0.6,
                         colorscale='Viridis', name='平面 1: 3x + y + z = -5'))
fig.add_trace(go.Surface(x=X, y=Y, z=Z2, opacity=0.6,
                         colorscale='Cividis', name='平面 2: 4x + 3y - z = -2'))
fig.add_trace(go.Surface(x=X, y=Y, z=Z3, opacity=0.6,
                         colorscale='Plasma', name='平面 3: 5x + 4y + z = 6'))

# 解の点をプロット（Scatter3d）
fig.add_trace(go.Scatter3d(
    x=[solution[0]],
    y=[solution[1]],
    z=[solution[2]],
    mode='markers',
    marker=dict(size=8, color='red'),
    name='解 (-5, 7, 3)'
))

# レイアウトの更新（軸タイトルなど）
fig.update_layout(
    title='3次元連立一次方程式（例A）の解の可視化',
    scene=dict(
        xaxis_title='x',
        yaxis_title='y',
        zaxis_title='z'
    ),
    autosize=True
)

fig.show()
```

※ 同様に、無数解や解が存在しない場合のシミュレーションも、各平面（または直線）の関係を変えることで図示可能です。  
たとえば、無数解の場合は平面が共通部分として直線または平面で交わり、解が存在しない場合は少なくとも一部の平面が平行で交わらないなどの状況を図示します。

---

## 5. 学んだ内容がどのように応用されるか
- **工学・物理学:**  
  連立一次方程式の解の種類の理解は、システムの自由度や制約条件を把握する上で重要です。たとえば、構造物の変形や回路解析などにおいて、システムが一意解を持つかどうかが設計の安全性や動作に直結します。
- **経済学・最適化:**  
  市場均衡や資源配分問題では、連立一次方程式の解の存在性や一意性が経済モデルの安定性に影響します。
- **コンピュータグラフィックス:**  
  画像や3Dモデルの変換、レンダリングでは、平面や直線の交点の計算が重要な役割を果たします。
- **機械学習:**  
  線形モデル（例：線形回帰）の解の一意性や多様な解の存在は、モデルの学習や解釈に影響し、次元削減などの技法とも密接に関連しています。

---

## 6. 演習問題
1. **演習問題1:**  
   次の3変数の連立一次方程式について、解の種類（一意解、無数解、または解が存在しない）を判定せよ。  
   例題 (一意解の例):  
   \[
   \begin{cases}
   x + y + z = 6, \\
   2x + 3y + 4z = 14, \\
   3x + 4y + 5z = 20.
   \end{cases}
   \]
   ※ 解が一意であれば、解を求めなさい。

2. **演習問題2:**  
   次の3変数の連立一次方程式について、解の種類を判定せよ。  
   例題 (無数解の例):  
   \[
   \begin{cases}
   x + y + z = 6, \\
   2x + 3y + 4z = 14, \\
   3x + 4y + 5z = 20.
   \end{cases}
   \]
   ※ ただし、3行目が1行目と2行目の線形結合になっている場合の状況を示すこと。

3. **演習問題3:**  
   次の3変数の連立一次方程式について、解の種類を判定せよ。  
   例題 (解が存在しない例):  
   \[
   \begin{cases}
   x + y + z = 6, \\
   2x + 3y + 4z = 14, \\
   3x + 4y + 5z = 21.
   \end{cases}
   \]
   ※ なぜ解が存在しないか、その理由を説明せよ。

4. **演習問題4:**  
   2変数の連立一次方程式（例: \(x + 2y = 5\) と \(3x - y = 4\)）および3変数の連立一次方程式の各解のパターン（一意解、無数解、解なし）のシミュレーションを Google Colab 上で実装し、図示して、幾何学的な違いを説明せよ。