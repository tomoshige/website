# 講義タイトル: ベクトルの1次独立と逆行列

## 1. 講義概要
- **講義時間:** 60分　/　**演習時間:** 30分
- **目的:**  
  ベクトルの1次結合と1次独立の概念を理解し、それが行列の逆行列の存在にどのように影響するかを学ぶ。さらに、1次独立でない場合の逆行列の不安定性についても検討し、Google Colabを用いた視覚的な理解を促す。
- **今日の目標:**  
  ・ベクトルの1次結合・1次独立の定義と判定方法（ガウスの消去法）を明確にする。  
  ・1次独立なベクトル群から構成される正則行列と、1次独立でない場合の行列の不安定性を理解する。  
  ・具体例とColabでの実演を通して、理論と実践の両面から理解を深める。

## 2. 理論的背景と内容の説明
### 2.1 定義・基本概念
- **ベクトルの1次結合:**  
  複数のベクトル \( \mathbf{v}_1, \mathbf{v}_2, \dots, \mathbf{v}_k \) に対して、スカラー \( c_1, c_2, \dots, c_k \) を用い  
  $$
  c_1 \mathbf{v}_1 + c_2 \mathbf{v}_2 + \cdots + c_k \mathbf{v}_k
  $$
  と表現できるものをそのベクトルの1次結合という。

- **ベクトルの1次独立:**  
  あるベクトル群 \( \{\mathbf{v}_1, \mathbf{v}_2, \dots, \mathbf{v}_k\} \) が、  
  $$
  c_1 \mathbf{v}_1 + c_2 \mathbf{v}_2 + \cdots + c_k \mathbf{v}_k = \mathbf{0}
  $$
  となるためのスカラー \( c_1, c_2, \dots, c_k \) がすべてゼロである場合、そのベクトル群は1次独立である。  
  逆に、非自明な組み合わせ（少なくとも1つの \( c_i \neq 0 \) ）で和が0になるなら、1次従属と呼ぶ。

- **逆行列の存在との関係:**  
  正方行列 \( A \) の列が1次独立であれば、行列 \( A \) は正則（逆行列が存在）である。  
  もし1次独立でなければ、\( A \) は特異行列となり、逆行列が存在しない。また、1次独立性に近い場合は、逆行列の計算が数値的に不安定になる。

### 2.2 定理・命題
- **定理1: 1次独立性と行列の正則性**  
  正方行列 \( A \) の列が1次独立である（すなわち、\( \operatorname{rank}(A) = n \)）ならば、  
  - \( A \) は正則であり、逆行列 \( A^{-1} \) が一意に存在する。  
  - 逆に、\( A \) が特異である（すなわち、列が1次独立でない）と、逆行列は存在しない。  

- **定理2: ガウスの消去法による1次独立性の判定**  
  任意の行列 \( A \) に対し、ガウスの消去法（または行基本変形）を適用して行階段形（または簡約化された行列）に変換する。  
  このとき、非零行の数が \( A \) のランクとなり、  
  - 非零行の数が元のベクトルの個数と一致すれば1次独立、  
  - 一致しなければ1次従属であると判定できる。

- **命題: 1次独立性の不安定性と逆行列の数値的不安定性**  
  ベクトル群が厳密には1次独立でなくても、非常に近い状態（数値計算上「ほぼ1次独立」）の場合、  
  - 対応する正方行列 \( A \) は条件数が大きくなり、逆行列 \( A^{-1} \) の計算において数値的不安定性が顕在化する。  
  これは、微小な誤差が大きく増幅される原因となる。

### 2.3 数式・証明の詳細
- **1次結合のゼロ和の唯一性:**  
  \( c_1 \mathbf{v}_1 + c_2 \mathbf{v}_2 + \cdots + c_k \mathbf{v}_k = \mathbf{0} \) の解が \( c_1 = c_2 = \cdots = c_k = 0 \) であることが1次独立の定義です。  
  例えば、2次元空間での2つのベクトル \( \mathbf{v}_1 = \begin{pmatrix} a \\ b \end{pmatrix} \) と \( \mathbf{v}_2 = \begin{pmatrix} c \\ d \end{pmatrix} \) に対して  
  $$
  c_1 \begin{pmatrix} a \\ b \end{pmatrix} + c_2 \begin{pmatrix} c \\ d \end{pmatrix} = \begin{pmatrix} 0 \\ 0 \end{pmatrix}.
  $$
  これを成分ごとに展開すると、  
  $$
  a c_1 + c c_2 = 0, \quad b c_1 + d c_2 = 0.
  $$
  この連立方程式が自明解しか持たなければ、\(\mathbf{v}_1\) と \(\mathbf{v}_2\) は1次独立です。  

- **ガウスの消去法による判定:**  
  与えられたベクトル群を行として持つ行列 \( M \) を考え、ガウスの消去法を適用して簡約化する。  
  簡約化後の非零行の数が、元の行列の行数に等しければ、  
  全てのベクトルが1次独立である。  
  逆に、1つ以上の行が全零になれば、何らかのベクトルが他のベクトルの1次結合で表せることを意味する。

- **逆行列と1次独立性の関係の証明:**  
  正方行列 \( A = \begin{pmatrix} \mathbf{v}_1 & \mathbf{v}_2 & \cdots & \mathbf{v}_n \end{pmatrix} \) の列が1次独立ならば、  
  \( \operatorname{rank}(A) = n \) となり、  
  定理より \( \det(A) \neq 0 \) となる。  
  これにより、逆行列 \( A^{-1} \) が存在し、  
  $$
  A^{-1} A = I.
  $$
  逆に、もし列が1次従属ならば \( \det(A) = 0 \) となり、逆行列は存在しない。  
  また、1次独立性に「ほぼ」近い場合、\( \det(A) \) は非常に小さくなり、条件数が大きいため、数値計算上の逆行列は不安定となる。

- **数値例:**  
  例えば、  
  $$
  A = \begin{pmatrix}
  1 & 2 \\
  2 & 4.001
  \end{pmatrix},
  $$
  は理論上は1次独立に近いものの、2列目が1列目のほぼ2倍であるため、\( \det(A) \approx 1 \times 4.001 - 2 \times 2 = 0.001 \) となり、逆行列の計算で大きな誤差が生じやすいことが示される。

---

## 3. 扱う内容の実例（GPT, Colab等は使用せず）
- **実例1:**  
  3次元空間での3つのベクトル  
  $$
  \mathbf{v}_1 = \begin{pmatrix} 1 \\ 0 \\ 0 \end{pmatrix}, \quad
  \mathbf{v}_2 = \begin{pmatrix} 0 \\ 1 \\ 0 \end{pmatrix}, \quad
  \mathbf{v}_3 = \begin{pmatrix} 0 \\ 0 \\ 1 \end{pmatrix}
  $$
  は明らかに1次独立です。これらを列として持つ正方行列  
  $$
  A = \begin{pmatrix}
  1 & 0 & 0 \\
  0 & 1 & 0 \\
  0 & 0 & 1
  \end{pmatrix}
  $$
  は単位行列であり、逆行列も同じ単位行列となります。

- **実例2:**  
  ガウスの消去法を用いて、  
  $$
  A = \begin{pmatrix}
  1 & 2 & 3 \\
  2 & 4 & 6.1 \\
  3 & 6 & 9
  \end{pmatrix}
  $$
  の列が1次独立かを判定します。  
  2行目は1行目の2倍に近いですが、わずかにずれているため完全な1次独立ではなく、条件数が大きくなる可能性があります。  
  実際にガウス消去法で簡約化すると、2行目・3行目に依存性が現れ、逆行列の計算が不安定になる様子をホワイトボードで示すことができます。

- **実例3:**  
  数値実験として、Google Colab を用いてランダムに生成した行列の条件数を計算し、  
  1次独立なベクトルから構成された行列と、ほぼ1次独立なベクトル群から構成された行列の逆行列の不安定性の違いを視覚的に示します。

## 4. ChatGPTによる解説＋Colabでの実行例
- **ChatGPT解説:**  
  ベクトルの1次独立は、線形代数学の基礎であり、正則行列の存在条件に直結します。  
  ガウスの消去法を用いると、どのベクトルが他のベクトルの1次結合で表現可能かを容易に判定でき、これにより行列のランクを求められます。  
  数値例では、1次独立性がほぼ満たされない場合に生じる逆行列の不安定性も確認でき、実際の数値計算における誤差の増幅についても理解できます。  
  以下のColab実行例では、ランダムな行列の1次独立性の判定と、逆行列計算の安定性を視覚的に確認します。

- **Colab実行例:** 以下のサンプルコードは、行列のガウス消去法による簡約化と、条件数の計算を通して1次独立性と逆行列の安定性を確認するものです。
  ```python
  import numpy as np
  import matplotlib.pyplot as plt

  # 1. 1次独立な行列の例
  A1 = np.array([[1, 2, 3],
                 [0, 1, 4],
                 [5, 6, 0]])
  print("A1:\n", A1)
  print("det(A1):", np.linalg.det(A1))
  print("条件数(A1):", np.linalg.cond(A1))

  # 2. ほぼ1次独立な行列の例（2列目が1列目のほぼ倍）
  A2 = np.array([[1, 2, 3],
                 [2, 4.001, 6],
                 [3, 6, 9]])
  print("\nA2:\n", A2)
  print("det(A2):", np.linalg.det(A2))
  print("条件数(A2):", np.linalg.cond(A2))

  # ガウス消去法（scipy.linalg.lu なども利用可能ですが、ここではnumpy.linalg.svdでランクを確認）
  U, s, Vt = np.linalg.svd(A2)
  rank_A2 = np.sum(s > 1e-10)
  print("\nA2のランク:", rank_A2)
