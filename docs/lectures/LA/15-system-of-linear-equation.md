# 講義14: 逆行列の概念と存在条件

## 1. 講義概要
- **講義時間:** 60分　/　**演習時間:** 30分
- **目的:**  
  正方行列の逆行列の定義、性質、存在条件を理解し、ガウスの消去法（ガウス・ジョルダン法）を用いた逆行列計算のプロセスを習得する。
- **今日の目標:**  
  逆行列の概念とその存在条件（例えば $ \det(A) \neq 0 $ の必要十分条件）を明確に理解し、実際に計算過程を追いながら、逆行列を求める手法をステップバイステップで実装できるようになる。

## 2. 理論的背景と内容の説明
### 2.1 定義・基本概念
- **逆行列の定義:**  
  正方行列 $A$ に対して、もし存在するならば、その逆行列 $A^{-1}$ は  
  $$
  A \cdot A^{-1} = A^{-1} \cdot A = I
  $$
  となる行列である。ここで $I$ は単位行列を表す。
- **正則行列:**  
  行列 $A$ が逆行列を持つ場合、$A$ は正則（invertible）または非特異（nonsingular）と呼ばれる。
- **連立方程式との関係:**  
  逆行列を用いることで、連立方程式 $A\mathbf{x}= \mathbf{b}$ の解は  
  $$
  \mathbf{x} = A^{-1}\mathbf{b}
  $$
  と一括して求めることができる。

### 2.2 定理・命題
- **逆行列の存在条件:**  
  正方行列 $A$ が逆行列を持つための必要十分条件は、  
  $$
  \det(A) \neq 0
  $$
  である。また、ガウス・ジョルダン法により拡大行列 $[A|I]$ を変形し、左側が単位行列になれば右側が $A^{-1}$ となる。
- **逆行列の性質:**  
  - $(A^{-1})^{-1} = A$
  - $(AB)^{-1} = B^{-1}A^{-1}$
  - $(A^T)^{-1} = (A^{-1})^T$
- **一意性:**  
  逆行列は一意に定まる。すなわち、もし $A^{-1}$ が存在するならば、唯一の行列である。

### 2.3 数式・証明の詳細
- **ガウス・ジョルダン法による逆行列計算:**  
  正方行列 $A$ に対し、拡大行列 $[A|I]$ を作成し、行基本変形を行う。  
  その変形の過程で、左側が単位行列に変換されたとき、右側に現れる行列が $A^{-1}$ である。  
  具体例として、2×2行列  
  $$
  A = \begin{pmatrix} a & b \\ c & d \end{pmatrix}
  $$
  に対して、$\det(A) = ad - bc \neq 0$ のとき、  
  $$
  A^{-1} = \frac{1}{ad - bc}\begin{pmatrix} d & -b \\ -c & a \end{pmatrix}
  $$
  と求められる。また、より大きな行列の場合も同様の手法で逆行列を求めることが可能である。
- **計算過程の重要性:**  
  各ステップ（行の入れ替え、ピボットの正規化、他行の消去操作）を明示的に確認することで、計算過程の理解が深まる。

## 3. 扱う内容の実例（GPT, Colab等は使用せず）
- **実例1:**  
  2×2行列
  $$
  A = \begin{pmatrix} 4 & 7 \\ 2 & 6 \end{pmatrix}
  $$
  に対し、$\det(A) = 4\cdot6 - 7\cdot2 = 24 - 14 = 10 \neq 0$ であるため、  
  $$
  A^{-1} = \frac{1}{10}\begin{pmatrix} 6 & -7 \\ -2 & 4 \end{pmatrix}
  $$
  と計算される。
- **実例2:**  
  3×3行列の場合、拡大行列 $[A|I]$ に対してガウス・ジョルダン法を適用し、左側を単位行列に変形することで右側から逆行列を読み取る方法を説明。  
  （例は紙上での手計算やホワイトボードでの説明を想定）

## 4. ChatGPTによる解説＋Colabでの実行例
- **ChatGPT解説:**  
  逆行列の計算は、拡大行列 $[A|I]$ に対してガウス・ジョルダン法を用い、行基本変形を行う過程を通して行われる。  
  各ステップで、ピボットの選択、行の正規化、他行の消去操作を丁寧に行うことで、最終的に左側が単位行列に変換されたとき、右側に現れる行列が逆行列となる。  
  これにより、逆行列計算が単なる数式操作ではなく、複数の連立方程式を同時に解く手法と対応していることが理解できる。
- **Colab実行例:** 以下に、ガウス・ジョルダン法による逆行列計算の step by step のサンプルコードを提示する。
  ```python
  import numpy as np

  def gauss_jordan_inverse(A):
      n = A.shape[0]
      A = A.astype(float)
      # 単位行列との連結
      I = np.eye(n)
      AI = np.concatenate((A, I), axis=1)
      
      # 前進消去および後退消去の実施
      for i in range(n):
          # ピボットの選択（絶対値最大の要素を持つ行を選ぶ）
          max_row = np.argmax(np.abs(AI[i:, i])) + i
          if abs(AI[max_row, i]) < 1e-10:
              raise ValueError("行列は特異で逆行列を持ちません。")
          # 行の入れ替え
          if max_row != i:
              AI[[i, max_row]] = AI[[max_row, i]]
              print(f"Step: 行 {i} と行 {max_row} の入れ替え")
              print(AI, "\n")
          
          # ピボット行の正規化
          pivot = AI[i, i]
          AI[i] = AI[i] / pivot
          print(f"Step: 行 {i} の正規化")
          print(AI, "\n")
          
          # ピボット列以外の行の消去
          for j in range(n):
              if j != i:
                  factor = AI[j, i]
                  AI[j] = AI[j] - factor * AI[i]
                  print(f"Step: 行 {j} から行 {i} を用いて消去")
                  print(AI, "\n")
      # 逆行列は右半分に現れる
      inverse = AI[:, n:]
      return inverse

  # サンプル行列の定義
  A = np.array([[4, 7],
                [2, 6]])
  print("元の行列 A:")
  print(A, "\n")

  invA = gauss_jordan_inverse(A)
  print("計算された逆行列 A^-1:")
  print(invA)
  ```

## 5. 学んだ内容の応用例
- **応用分野:**  
  逆行列の概念は、コンピュータグラフィックス、機械学習、統計解析、最適化問題など多岐にわたる分野で応用される。  
- **具体例:**  
  - **連立方程式の解法:** 逆行列を用いることで、複数の連立方程式を一括して解くことができる。  
  - **数値解析:** 線形システムの安定性解析や、反復法の初期近似として逆行列計算が利用される。  
  - **データ解析:** 線形回帰や最小二乗法におけるパラメータ推定で、逆行列計算が不可欠となる。

## 6. 演習問題
- **問題1:**  
  以下の 2×2 行列の逆行列を求め、その正しさを確認せよ。  
  $$
  A = \begin{pmatrix} 3 & 5 \\ 1 & 2 \end{pmatrix}
  $$
  *【ヒント】* $\det(A)=3\cdot2-5\cdot1\neq 0$ であることを確認し、公式またはガウス・ジョルダン法を用いる。
- **問題2:**  
  3×3 行列  
  $$
  A = \begin{pmatrix} 2 & 0 & 1 \\ 3 & 1 & 0 \\ 1 & 2 & 1 \end{pmatrix}
  $$
  に対して、拡大行列 $[A|I]$ を作成し、ガウス・ジョルダン法を用いて逆行列が存在するかどうか、また存在するならばその計算過程を示せ。
- **問題3:**  
  逆行列の性質を用いて、2つの正則行列 $A$, $B$ に対し、  
  $$
  (AB)^{-1} = B^{-1}A^{-1}
  $$
  であることを具体例で確認せよ。  
  *【ヒント】* それぞれの逆行列を個別に求め、行列積を比較する。

## 付録・参考資料
- **参考文献:**  
  - 『線形代数学入門』、教科書「基礎線形代数学」など  
  - 関連論文およびオンライン講義資料（例: MIT OpenCourseWare、Khan Academy）
- **補足資料:**  
  - 詳細な解説スライド  
  - 追加例題集  
  - FAQ: 逆行列の計算と性質に関するよくある質問