# 講義6: 連立一次方程式の表現と解法の基礎

## 1. 本日扱う内容について（概要）
- **目的:**

    1. 連立一次方程式の基本概念とその行列表現を理解する  
    2. 3変数（3つの未知数）を含む連立一次方程式を例題として扱い、  
    ・代入法による解法の煩雑さを実例で示す  
    ・式の足し算・引き算（消去法）による解法を最後まで示す  
    3. 幾何学的に、2次元では直線の交点、3次元では平面の交点として解をイメージする

- **講義の流れ:**

    1. 連立一次方程式の定義（一般的な m 本の式、n 個の未知数の場合）と行列表現の導入  
    2. 【例題】以下の連立方程式を用いて、  
        - 代入法で解を求めるときの煩雑さを実際に示す  
        - 同じ例題を消去法（足し算・引き算のみ）で解く方法を示す  
    3. ChatGPTによる解説およびGoogle Colabでの実行例（幾何学的可視化を含む）  
    4. 応用例の考察  
    5. 演習問題

---

## 2. 扱う内容の理論の説明（定義・定理・数式を含む）
### 連立一次方程式の定義
- **一般的な定義:**  
  連立一次方程式とは、未知数 $ x_1, x_2, \dots, x_n $ に関して、m 本の一次方程式が同時に成り立つ問題です。  
  具体的には、以下のように表されます：
  $$
  \begin{cases}
  a_{11} x_1 + a_{12} x_2 + \cdots + a_{1n} x_n = b_1, \\\
  a_{21} x_1 + a_{22} x_2 + \cdots + a_{2n} x_n = b_2, \\\
  \quad \vdots \\\
  a_{m1} x_1 + a_{m2} x_2 + \cdots + a_{mn} x_n = b_m.
  \end{cases}
  $$
  ここで、$ a_{ij} $ は各式の係数、$ b_i $ は定数項といいます。

### 例題として用いる3変数の連立一次方程式
今回の例題として、以下の連立一次方程式（m = 3, n = 3）を扱います：
$$
\begin{cases}
3x + y + z = -5, \\\
4x + 3y - z = -2, \\\
5x + 4y + z = 6.
\end{cases}
$$

この連立1次方程式を解くことで、連立1次方程式の一般的な解き方について学びましょう。
これまで連立方程式を解く時には、**代入法** を用いて解いてきたという人もいるはずです。
しかし、代入法で計算する際には、式を消去するための操作が多くなりがちで、煩雑になる場合が多いです。
一方で、今回学ぶ解法は**消去法**と言います。式と式を足したり、引いたりすることで、連立方程式の解を求めます。
以下の例で、代入法と消去法のそれぞれを説明します。

### 代入法による解法の例とその煩雑さ
- **代入法の手順:**  
  1. 式(1)から $ z $ を解く：
     $$
     z = -5 - 3x - y.
     $$
  2. この $ z $ を式(2)に代入：
     $$
     4x + 3y - (-5 - 3x - y) = -2 \quad \Rightarrow \quad 4x + 3y + 5 + 3x + y = -2,
     $$
     $$
     7x + 4y = -7. \quad \text{（中間結果①）}
     $$
  3. 同様に、$ z $ を式(3)に代入：
     $$
     5x + 4y + (-5 - 3x - y) = 6 \quad \Rightarrow \quad 2x + 3y = 11. \quad \text{（中間結果②）}
     $$
  4. ここから、さらに $ y $ を $ x $ の式で表し代入する必要があり、代入法では計算の過程が複雑になり、ミスが生じやすくなります。


### 式の足し算・引き算による消去法の説明
消去法では、連立方程式の式同士ををうまく足し算、引き算、式の順序の入れ替え、式を定数倍することにより、次のような形に変形することを目標にします。
$$
\begin{cases}
a_{11}x + a_{12}y + a_{13}z = b_1, \\\
a_{21}x + a_{22}y + c_{23}z = b_2, \\\
a_{31}x + a_{32}y + a_{33}z = b_3.
\end{cases}
\rightarrow
\begin{cases}
x + c_{12}y + c_{13}z = d_1, \\\
0x + y + c_{23}z = d_2, \\\
0x + 0y + z = d_3.
\end{cases}
$$

では、手順を見ていきましょう。

- **消去法の手順:**
    同じ例題を用いて、手順を説明します。
    - まずは連立方程式をうまく足し算・引き算することで、左上の係数を`1`にしましょう。いま連立方程式の`x`の係数で`1`の式はありません。そこで、まずは (2)式から、(1)式を引いて、`x`の係数が`1`の式を作りましょう。
        $$
        \begin{cases}
        3x + y + z = -5, \\\
        4x + 3y - z = -2, \\\
        5x + 4y + z = 6.
        \end{cases} \longrightarrow 
        \begin{cases}
        3x + y + z = -5, \\\
        x + 2y - 2z = 3, \\\
        5x + 4y + z = 6.
        \end{cases}
        $$
    
    - 次に、(2)式 と (1)式の位置を入れ替えることで、一番上の式の`x`の係数が`1`になります。
        $$
        \begin{cases}
        3x + y + z = -5, \\\
        x + 2y - 2z = 3, \\\
        5x + 4y + z = 6.
        \end{cases}\longrightarrow 
        \begin{cases}
        x + 2y - 2z = 3, \\\
        3x + y + z = -5, \\\
        5x + 4y + z = 6.
        \end{cases}
        $$
    - 次に、(2)式と、(3)式の`x`の係数を`0`にするために、(2)式から(1)式の3倍を引き、(3)式から(1)式の5倍を引き算します。
        $$
        \begin{cases}
        x + 2y - 2z = 3, \\\
        3x + y + z = -5, \\\
        5x + 4y + z = 6.
        \end{cases} \longrightarrow 
        \begin{cases}
        x + 2y - 2z = 3, \\\
        0x - 5y + 7z = -14, \\\
        0x - 6y + 11z = -9.
        \end{cases}
        $$
    - ここで、(1)式は求める形になっているので、これ以降は触りません。次は、第2式の`y`の係数を`1`にしたいので、(2)式に、(3)式の`-1`倍を加えましょう。
        $$
        \begin{cases}
        x + 2y - 2z = 3, \\\
        0x - 5y + 7z = -14, \\\
        0x - 6y + 11z = -9.
        \end{cases} \longrightarrow 
        \begin{cases}
        x + 2y - 2z = 3, \\\
        0x + y - 4z = -5, \\\
        0x - 6y + 11z = -9.
        \end{cases}
        $$
    - では、第3式の`y`の係数を`0`にしたいので、(3)式に、(2)式の`6`倍を加えます。
        $$
        \begin{cases}
        x + 2y - 2z = 3, \\\
        0x + y - 4z = -5, \\\
        0x - 6y + 11z = -9.
        \end{cases} \longrightarrow 
        \begin{cases}
        x + 2y - 2z = 3, \\\
        0x + y - 4z = -5, \\\
        0x + 0y - 13z = -39.
        \end{cases}
        $$
    - 最後に、`z`の係数を`1`にします。(3)式を-13で割りましょう。
        $$
        \begin{cases}
        x + 2y - 2z = 3, \\\
        0x + y - 4z = -5, \\\
        0x + 0y + z = 3.
        \end{cases}
        $$
    - これによって、求める形になりました。
    - この結果、(3)式から `z=3`がわかります。次に(2)式に、`z=3`を代入すると、`y=7`となります。最後に(1)式にこれらを代入すると、`x=-5`が得られました。最後に行った一番下の式から順々に解を計算していく方法を**後退代入法**といいます。
---

## 3. 扱う内容の例 （別の連立方程式）
### 例: 3変数の連立一次方程式
与えられた連立方程式：
$$
\begin{cases}
3x + y - 5z = -4, \\\
-x + 2y - 3z = -1, \\\
-2x + 6y - 9z = -2.
\end{cases}
$$

この連立方程式を消去法を使って解いていきます。まずは、一番上の式の`x`の係数を`1`にしたいので、(2)式を-1倍し、(1)式と入れ替える。

$$
\begin{cases}
x - 2y + 3z = 1, \\\
3x + y - 5z = -4, \\\
-2x + 6y - 9z = -2.
\end{cases}
$$

次に、上の式の(1)式を使って、(2)式と(3)式の `x` を消去する。そこで、以下の操作を行う。

- (1)式 の -3倍を (2)式に加える。
- (1)式の 2倍を (3)式に加える。すると、次の式になる。

$$
\begin{cases}
x - 2y + 3z = 1, \\\
0x + 7y - 14z = -7, \\\
0x + 2y - 3z = 0.
\end{cases}
$$

次は、(2)式の`y`の係数を`1`にしたいので、(2)式を7で割る。

$$
\begin{cases}
x - 2y + 3z = 1, \\\
0x + y - 2z = -1, \\\
0x + 2y - 3z = 0.
\end{cases}
$$

次は、(3)式の `y` の係数を`0`にしたい。よって、(2)式の -2倍を (3)式に加える。

$$
\begin{cases}
x - 2y + 3z = 1, \\\
0x + y - 2z = -1, \\\
0x + 0y + z = 2.
\end{cases}
$$

よって、求める形が完成したので後退代入法を用いると、(3)式から　`z = 2` だとわかる。次に、(2)式に、`z = 2` を代入すると、`y = 3` と求められる。最後に (1)式に それぞれを代入すると `x = 5` と求めることができる。

---

## 4. ChatGPTによる解説＋Colab での実行例

### ChatGPTによる解説
- **ポイント:**  
  - 代入法では、1つの変数を他の変数の式として表し、他の式に代入するため、特に3変数以上の場合、途中で現れる複雑な分数や長い式の整理が必要となり、非常に手間がかかる。  
  - 消去法では、式同士を足し引きして変数を打ち消すことで、シンプルな2変数の連立方程式に還元でき、計算が整理される。
  - また、連立一次方程式は幾何学的に、2変数の場合は直線の交点、3変数の場合は平面の交点として解釈でき、視覚的に確認することができる。

### Google Colabで視覚的に確認する実行例

#### (1) 幾何学的可視化：2次元の直線の交点
（2変数の連立一次方程式の例）
```python
import numpy as np
import matplotlib.pyplot as plt

# 例: 2直線の連立方程式
# 直線1: 2x + 3y = 8  → y = (8 - 2x)/3
# 直線2: x - y = 1     → y = x - 1

x_vals = np.linspace(-2, 6, 400)
y_line1 = (8 - 2 * x_vals) / 3
y_line2 = x_vals - 1

# 代数的に求めた解 (x, y) = (11/5, 11/5 - 1)
x_intersect = 11/5
y_intersect = x_intersect - 1

plt.figure(figsize=(8,6))
plt.plot(x_vals, y_line1, label="2x + 3y = 8")
plt.plot(x_vals, y_line2, label="x - y = 1")
plt.plot(x_intersect, y_intersect, 'ro', label=f"交点 ({x_intersect:.2f}, {y_intersect:.2f})")
plt.xlabel("x")
plt.ylabel("y")
plt.title("2直線の交点")
plt.legend()
plt.grid(True)
plt.show()
```

#### (2) 幾何学的可視化：3次元の平面の交点
（例として、上記の3変数連立一次方程式の解をもとに3平面の交点を可視化）

```python
import numpy as np
import matplotlib.pyplot as plt
from mpl_toolkits.mplot3d import Axes3D

# 4x -2y + z =11
# -2x +4y -2z = -16
# x -2y + 4z = 17

# グリッド作成のための範囲設定
x, y = np.linspace(-8,8,100), np.linspace(-8,8,100)
X, Y = np.meshgrid(x,y)

# 各平面の定義（z = f(x,y) の形で表現）
Z1 = 11 - 4*X + 2*Y
Z2 = (16 - 2*X + 4*Y) / 2
Z3 = (17 - X + 2*Y) / 4

fig = plt.figure(figsize=(12,10))
ax = fig.add_subplot(111, projection='3d')

ax.plot_surface(X,Y,Z1, alpha=0.5, rstride=100, cstride=100, label="平面1")
ax.plot_surface(X,Y,Z2, alpha=0.5, rstride=100, cstride=100, label="平面2")

ax.plot_surface(X,Y,Z3, alpha=0.5, facecolors='g', rstride=100, cstride=100, label="平面3")
ax.plot((1,1),(-8,8),(-9,23), lw=2, c='b')
ax.plot((1,),(-2,),(3,), lw=2, c='k', marker='o')
ax.set_xlabel("x")
ax.set_ylabel("y")
ax.set_zlabel("z")
ax.set_title("3平面の交点の可視化")
ax.legend()
plt.show()

```

---

## 5. 学んだ内容がどのように応用されるか
- **工学・物理学:**  
  複数の法則や条件（例：力の釣り合いや回路解析）を同時に満たす解を求める際に、連立一次方程式は基本ツールとなります。
- **経済学・最適化:**  
  市場均衡や資源配分問題など、複数の制約条件下での解の探索に利用されます。
- **コンピュータグラフィックス:**  
  2次元の直線や3次元の平面の交点は、画像変換、レンダリング、衝突判定などの基盤技術です。
- **機械学習:**  
  線形回帰や分類モデルのパラメータ推定、データ前処理などにおける数値解法の基礎として利用されます。

---

## 6. 演習問題
1. **演習問題1:**  
   次の3変数の連立一次方程式
   $$
   \begin{cases}
   4x -2y + z =11 \\\
   -2x +4y -2z = -16 \\\
   x -2y + 4z = 17
   \end{cases}
   $$
   について、まず代入法で解こうとする手順（中間式も含む）を自分で書き出し、なぜ計算が煩雑になるかを考えなさい。その後、式の足し算・引き算による消去法を用いて最終的な解 $x = 1,\; y = -2,\; z = 3$ を導きなさい。

2. **演習問題2:**  
   2変数の連立一次方程式（例: $x + 3y = 2$ と $-2x + y = 3$）を、足し算・引き算だけで解き、その解をグラフで直線の交点として可視化せよ。

3. **演習問題3:**  
   上記の3変数の連立一次方程式を用いて、Google Colab上で3平面のグラフと交点を可視化し、幾何学的に解の存在（または無限に存在する場合のパラメータ表示）を確認せよ。

---