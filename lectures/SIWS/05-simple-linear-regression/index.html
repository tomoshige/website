
<!doctype html>
<html lang="ja" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Statistics, Tomoshige Nakamura, Machine Learning, Juntendo University">
      
      
        <meta name="author" content="Tomoshige Nakamura">
      
      
        <link rel="canonical" href="https://tomoshige.github.io/website/lectures/SIWS/05-simple-linear-regression/">
      
      
        <link rel="prev" href="../04-data-import-and-tidy-data/">
      
      
        <link rel="next" href="../06-multiple-regression/">
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.50">
    
    
      
        <title>5. Simple Linear Regression - Statistical Learning Laboratory</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.a40c8224.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="https://unpkg.com/katex@0/dist/katex.min.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#5" class="md-skip">
          コンテンツにスキップ
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="ヘッダー">
    <a href="../../.." title="Statistical Learning Laboratory" class="md-header__button md-logo" aria-label="Statistical Learning Laboratory" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Statistical Learning Laboratory
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              5. Simple Linear Regression
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="検索" placeholder="検索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="検索">
        
        <button type="reset" class="md-search__icon md-icon" title="クリア" aria-label="クリア" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            検索を初期化
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://tomoshige.github.io/website" title="リポジトリへ" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    tomoshige/website
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="ナビゲーション" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Statistical Learning Laboratory" class="md-nav__button md-logo" aria-label="Statistical Learning Laboratory" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Statistical Learning Laboratory
  </label>
  
    <div class="md-nav__source">
      <a href="https://tomoshige.github.io/website" title="リポジトリへ" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    tomoshige/website
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Lectures
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Lectures
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../LA/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Linear algebra
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            Linear algebra
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2_2" id="__nav_2_2_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Module 1 - Vector and Matrix
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_2">
            <span class="md-nav__icon md-icon"></span>
            Module 1 - Vector and Matrix
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../LA/01-introduction/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1. Introduction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../LA/02-vector-and-matrix/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2. Vector and Matrix 1
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../LA/03-vector-and-matrix/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3. Vector and Matrix 2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../LA/04-vector-and-matrix/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4. Vector and Matrix 3
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../LA/05-vector-and-matrix/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5. Vector and Matrix 4
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../LA/06-vector-and-matrix/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6. Vector and Matrix 5
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../LA/07-vector-and-matrix/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7. Vector and Matrix 6
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../LA/08-vector-and-matrix/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    8. Vector and Matrix 7
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../LA/09-exercise/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    9. Exercise
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_2_3" id="__nav_2_2_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Module 2 - System of Linear Equations
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_3">
            <span class="md-nav__icon md-icon"></span>
            Module 2 - System of Linear Equations
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../LA/10-system-of-linear-equation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    10. System of Linear Equation 1
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../LA/11-system-of-linear-equation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    11. System of Linear Equation 2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../LA/12-system-of-linear-equation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    12. System of Linear Equation 3
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../LA/13-system-of-linear-equation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    13. System of Linear Equation 4
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../LA/14-system-of-linear-equation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    14. System of Linear Equation 5
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../LA/15-system-of-linear-equation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    15. System of Linear Equation 6
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../LA/16-system-of-linear-equation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    16. System of Linear Equation 7
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../LA/17-system-of-linear-equation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    17. System of Linear Equation 8
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../LA/18-system-of-linear-equation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    18. System of Linear Equation 9
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../LA/19-exercise/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    19. Exercise
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../LA/20-midterm-exam/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    20. Midterm Exam
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_4" >
        
          
          <label class="md-nav__link" for="__nav_2_2_4" id="__nav_2_2_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Module 3 - Determinants
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_4">
            <span class="md-nav__icon md-icon"></span>
            Module 3 - Determinants
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../LA/21-determinant/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    21. Determinant 1
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../LA/22-determinant/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    22. Determinant 2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../LA/23-determinant/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    23. Determinant 3
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../LA/24-determinant/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    24. Determinant 4
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../LA/25-exercise/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    25. Exercise
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_5" >
        
          
          <label class="md-nav__link" for="__nav_2_2_5" id="__nav_2_2_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Module 4 - Vector Spaces
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_2_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_5">
            <span class="md-nav__icon md-icon"></span>
            Module 4 - Vector Spaces
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../LA/26-vector-space-and-inner-product/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    26. Vector space 1
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../LA/27-vector-space-and-inner-product/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    27. Vector space 2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../LA/28-vector-space-and-inner-product/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    28. Vector space 3
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../LA/29-exercise/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    29. Exercise
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../LA/30-exercise/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    30. Exercise
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../LA/31-exam/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    31. Semester Exam
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_6" >
        
          
          <label class="md-nav__link" for="__nav_2_2_6" id="__nav_2_2_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Module 5 - Eigenvalues and Decomposition
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_2_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_6">
            <span class="md-nav__icon md-icon"></span>
            Module 5 - Eigenvalues and Decomposition
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../LA/32-eigen-value-vector/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    32. Eigen value and vector 1
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../LA/33-eigen-value-vector/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    33. Eigen value and vector 2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../LA/34-eigen-value-vector/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    34. Eigen value and vector 3
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../LA/35-eigen-value-vector/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    35. Eigen value and vector 4
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../LA/36-eigen-value-vector/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    36. Eigen value and vector 5
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../LA/37-exercise/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    37. Exercise
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../LA/38-midterm-exam/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    38. Midterm Exam
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../LA/39-singular-value-decomposition/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    39. Singular value decomposition 1
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../LA/40-singular-value-decomposition/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    40. Singular value decomposition 2
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_7" >
        
          
          <label class="md-nav__link" for="__nav_2_2_7" id="__nav_2_2_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Module 6 - Applications
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_2_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_7">
            <span class="md-nav__icon md-icon"></span>
            Module 6 - Applications
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../LA/41-principal-component-analysis/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    41. Principal component analysis 1
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../LA/42-principal-component-analysis/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    42. Principal component analysis 2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../LA/43-principal-component-analysis/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    43. Principal component analysis 3
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../LA/44-factor-analysis/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    44. Factor analysis 1
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../LA/45-factor-analysis/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    45. Factor analysis 2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../LA/46-nonlinear-dimension-reduction/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    46. Nonlinear dimension reduction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../LA/47-wrapup/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    47. Wrap up
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../LA/48-exam/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    48. Semester Exam
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Data Science without syntax
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            Data Science without syntax
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3_2" >
        
          
          <label class="md-nav__link" for="__nav_2_3_2" id="__nav_2_3_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Foundations
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3_2">
            <span class="md-nav__icon md-icon"></span>
            Foundations
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../01-getting-started/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1. Getting-Started
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../02-visualization/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2. Data Visualization
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../03-wrangling/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3. Data Wrangling
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../04-data-import-and-tidy-data/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4. Data Import and Tidy Data
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
      
        
      
    
    
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3_3" checked>
        
          
          <label class="md-nav__link" for="__nav_2_3_3" id="__nav_2_3_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Regression Analysis
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_3_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_3_3">
            <span class="md-nav__icon md-icon"></span>
            Regression Analysis
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    5. Simple Linear Regression
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    5. Simple Linear Regression
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="目次">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目次
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      はじめに
    </span>
  </a>
  
    <nav class="md-nav" aria-label="はじめに">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      必要なパッケージ
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#51-1" class="md-nav__link">
    <span class="md-ellipsis">
      5.1 1つの数値的説明変数
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5.1 1つの数値的説明変数">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#exploratory-data-analysis-eda" class="md-nav__link">
    <span class="md-ellipsis">
      探索的データ分析 (Exploratory Data Analysis, EDA)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      単純線形回帰
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      観測値、予測値、残差
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#line-of-best-fit" class="md-nav__link">
    <span class="md-ellipsis">
      最適な当てはめ直線 (Line of Best Fit) と最小二乗法
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#52-1" class="md-nav__link">
    <span class="md-ellipsis">
      5.2 1つのカテゴリ的説明変数
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5.2 1つのカテゴリ的説明変数">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      探索的データ分析
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      線形回帰
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    <span class="md-ellipsis">
      観測値、予測値、残差
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#53-correlation-does-not-imply-causation" class="md-nav__link">
    <span class="md-ellipsis">
      5.3 相関は必ずしも因果を意味しない (Correlation does not imply causation)
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    <span class="md-ellipsis">
      まとめ
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#python-google-colab" class="md-nav__link">
    <span class="md-ellipsis">
      Pythonコード一括実行用 (Google Colab向け)
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../06-multiple-regression/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6. Multiple Regression
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3_4" >
        
          
          <label class="md-nav__link" for="__nav_2_3_4" id="__nav_2_3_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Statistical Methods
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3_4">
            <span class="md-nav__icon md-icon"></span>
            Statistical Methods
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../07-sampling/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7. Sampling Method
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../08-Estimation-CI-Bootstrapping/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    8. Estimation, CI and Bootstrapping
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../09-hypothesis-testing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    9. Hypothesis Testing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../10-inference-for-regression/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    10. Inference for Regression
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3_5" >
        
          
          <label class="md-nav__link" for="__nav_2_3_5" id="__nav_2_3_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Communications
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_3_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3_5">
            <span class="md-nav__icon md-icon"></span>
            Communications
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../11-tell-your-story-with-data/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    11. Tell Your Story with Data
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3_6" >
        
          
          <label class="md-nav__link" for="__nav_2_3_6" id="__nav_2_3_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Website Design Competition
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_3_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3_6">
            <span class="md-nav__icon md-icon"></span>
            Website Design Competition
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../12-how-to-create-a-compelling-proposal/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    12. How to Create a Compelling Proposal
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../SP/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Statistics and Probability
  </span>
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4">
            <span class="md-nav__icon md-icon"></span>
            Statistics and Probability
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../research/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Research
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3" id="__nav_3_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Research
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Decision Trees and Forests
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            Decision Trees and Forests
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../research/note/generalized-random-forests/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Generalized random forests
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../research/note/variable-importance/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Variable Importance Measures
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../research/note/forest-kernel-and-its-asymptotics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Random forest kernels
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" >
        
          
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Causal Inference
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            Causal Inference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../research/note/sparseBART/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Sparse Causal BART
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../research/note/causal-mediation-analysis/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Causal mediation analysis
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../research/note/causal-data-repository/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Causal data repository
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../research/note/factor-analysis/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Factor analysis
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_4" id="__nav_3_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4">
            <span class="md-nav__icon md-icon"></span>
            Factor analysis
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4_2" >
        
          
          <label class="md-nav__link" for="__nav_3_4_2" id="__nav_3_4_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Theoretical Foundations
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4_2">
            <span class="md-nav__icon md-icon"></span>
            Theoretical Foundations
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../research/note/factor-analysis/01-introduction/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1. はじめに
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../research/note/factor-analysis/02-factor/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2. 因子とは
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../research/note/factor-analysis/03-factor-loading-matrix/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3. 因子負荷行列
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../research/note/factor-analysis/04-latent-factor-estimation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4. 潜在因子推定法
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4_3" >
        
          
          <label class="md-nav__link" for="__nav_3_4_3" id="__nav_3_4_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Analysis Methods
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4_3">
            <span class="md-nav__icon md-icon"></span>
            Analysis Methods
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../research/note/factor-analysis/05-rotation-and-interpretation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    5. 回転基準と結果の解釈
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../research/note/factor-analysis/06-sensitivity-analysis/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    6. 感度分析
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../research/note/factor-analysis/07-analysis-step/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    7. 因子分析の手順
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4_4" >
        
          
          <label class="md-nav__link" for="__nav_3_4_4" id="__nav_3_4_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Applications
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_4_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4_4">
            <span class="md-nav__icon md-icon"></span>
            Applications
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../research/note/factor-analysis/08-simulation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    8. シミュレーション
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../research/note/factor-analysis/09-pima-indians-diabetes-analysis/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    9. 糖尿病潜在原因分析
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../research/note/factor-analysis/10-ordered-categorical-factor-analysis/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    10. 順序ありカテゴリカル変数の扱い
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../research/note/factor-analysis/11-airline-passenger-satisfaction-analysis/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    11. 飛行機乗客満足度分析
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4_5" >
        
          
          <label class="md-nav__link" for="__nav_3_4_5" id="__nav_3_4_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Technical Notes
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_4_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4_5">
            <span class="md-nav__icon md-icon"></span>
            Technical Notes
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../research/note/factor-analysis/12-technical-note-matrix-factorization/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    12. 行列分解と因子分析
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="目次">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目次
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      はじめに
    </span>
  </a>
  
    <nav class="md-nav" aria-label="はじめに">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      必要なパッケージ
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#51-1" class="md-nav__link">
    <span class="md-ellipsis">
      5.1 1つの数値的説明変数
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5.1 1つの数値的説明変数">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#exploratory-data-analysis-eda" class="md-nav__link">
    <span class="md-ellipsis">
      探索的データ分析 (Exploratory Data Analysis, EDA)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      単純線形回帰
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      観測値、予測値、残差
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#line-of-best-fit" class="md-nav__link">
    <span class="md-ellipsis">
      最適な当てはめ直線 (Line of Best Fit) と最小二乗法
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#52-1" class="md-nav__link">
    <span class="md-ellipsis">
      5.2 1つのカテゴリ的説明変数
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5.2 1つのカテゴリ的説明変数">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      探索的データ分析
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      線形回帰
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    <span class="md-ellipsis">
      観測値、予測値、残差
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#53-correlation-does-not-imply-causation" class="md-nav__link">
    <span class="md-ellipsis">
      5.3 相関は必ずしも因果を意味しない (Correlation does not imply causation)
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    <span class="md-ellipsis">
      まとめ
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#python-google-colab" class="md-nav__link">
    <span class="md-ellipsis">
      Pythonコード一括実行用 (Google Colab向け)
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="5">第5章 基本的回帰分析</h1>
<p><strong>スライド</strong> <a href="../Marp/05-simple-linear-regression-slide.pdf">こちら</a></p>
<h2 id="_1">はじめに</h2>
<p>これまでに第2章でデータ可視化、第3章でデータ操作、これらのスキルを基に、本章からはデータモデリングの世界へと進みます。データモデリングの基本的な考え方は、以下の関係性を明らかにすることです。</p>
<ul>
<li><strong>目的変数 (target variable)</strong> <span class="arithmatex">\(y\)</span>: 予測または説明したい変数。<em>従属変数 (dependent variable)</em> や <em>応答変数 (response variable)</em> とも呼ばれます。</li>
<li><strong>説明変数 (explanatory variable) / 予測変数 (predictor variable)</strong> <span class="arithmatex">\(x\)</span>: 目的変数を説明または予測するために用いる変数。<em>独立変数 (independent variable)</em> や <em>共変量 (covariate)</em> とも呼ばれます。</li>
</ul>
<p>数学的に言えば、目的変数 <span class="arithmatex">\(y\)</span> を説明変数 <span class="arithmatex">\(x\)</span> の「関数として」モデル化します。ここでの「関数」とは、数学的な意味での関数を指します。説明変数と予測変数という用語はしばしば同じ意味で使われますが、モデリングの目的によって使い分けられることがあります。データモデリングは、大まかに以下の二つの目的のいずれかのために行われます。</p>
<ol>
<li><strong>説明のためのモデリング (Modeling for Explanation)</strong>: 目的変数 <span class="arithmatex">\(y\)</span> と説明変数 <span class="arithmatex">\(x\)</span> の間の関係性を明確に記述し、定量化することを目的とします。関係の統計的有意性を評価したり、変数間の関連性の強さを測る指標を得たり、場合によっては変数間の因果関係の理解を試みたりします。</li>
<li><strong>予測のためのモデリング (Modeling for Prediction)</strong>: 説明変数 <span class="arithmatex">\(x\)</span> に含まれる情報に基づいて、目的変数 <span class="arithmatex">\(y\)</span> の値を予測することを目的とします。この場合、変数間の関係性を深く理解することよりも、<span class="arithmatex">\(x\)</span> を使って <span class="arithmatex">\(y\)</span> を精度良く予測することに重点が置かれます。</li>
</ol>
<p>本書では主に<strong>説明のためのモデリング</strong>に焦点を当て、変数を<strong>説明変数</strong>と呼びます。予測のためのモデリングに興味がある方は、『Pythonによる統計的学習入門』(An Introduction to Statistical Learning with Python) のような専門書を参照すると良いでしょう。
世の中には決定木モデルやニューラルネットワークなど多種多様なモデリング手法が存在しますが、本書では最も基本的で理解しやすいアプローチの一つである<strong>線形回帰 (linear regression)</strong> に焦点を当てます。</p>
<p>線形回帰では、目的変数 <span class="arithmatex">\(y\)</span> は<strong>数値型 (numerical)</strong> である必要があり、説明変数 <span class="arithmatex">\(x\)</span> は<strong>数値型</strong>または<strong>カテゴリ型 (categorical)</strong> のいずれかをとることができます。そして最も重要な仮定は、<span class="arithmatex">\(y\)</span> と <span class="arithmatex">\(x\)</span> の関係が線形、つまり直線的であると仮定することです。「直線」が何を意味するかは、説明変数 <span class="arithmatex">\(x\)</span> の種類によって少し異なります。</p>
<p>本章（第5章）では、説明変数が1つだけのモデルを扱います。
* 5.1節では、説明変数が数値型である<strong>単純線形回帰 (simple linear regression)</strong> を学びます。
* 5.2節では、説明変数がカテゴリ型である場合を扱います。</p>
<p>続く第6章では、この基本的な回帰の考えを拡張し、2つの説明変数 <span class="arithmatex">\(x_1, x_2\)</span> を持つモデルを検討します。
そして第7章以降では、回帰モデルの結果を分析するために、第8章から第10章で学ぶ<strong>統計的推論 (statistical inference)</strong> の手法を用いていきます。</p>
<p>それでは、1つの説明変数 <span class="arithmatex">\(x\)</span> を持つ線形回帰モデル、すなわち基本的な回帰分析から始めましょう。この過程で、<strong>相関係数 (correlation coefficient)</strong>、「相関は必ずしも因果を意味しない」という重要な注意点、そして「最適な当てはめ直線 (line of best fit)」とは何かといった統計学の基本概念についても解説していきます。</p>
<h3 id="_2">必要なパッケージ</h3>
<p>この章で使用するPythonライブラリをインポートします。<code>seaborn</code>ライブラリから直接データセットを読み込むため、以前のようなデータダウンロードのステップは不要になります。</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">seaborn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sns</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">statsmodels.api</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sm</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">statsmodels.formula.api</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">smf</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">IPython.display</span><span class="w"> </span><span class="kn">import</span> <span class="n">display</span> <span class="c1"># DataFrameなどをきれいに表示するため</span>
</code></pre></div>
<hr />
<h2 id="51-1">5.1 1つの数値的説明変数</h2>
<p>レストランでは、食事の総支払額とウェイター/ウェイトレスへのチップの額にはどのような関係があるのでしょうか？総支払額が高いほど、チップの額も高くなる傾向があるのでしょうか？もしそうなら、その関係はどの程度の強さなのでしょうか？</p>
<p>この節では、レストランでの食事の総支払額という1つの数値型説明変数を用いて、チップの額の違いを説明することを試みます。これらの問いに答えるために、<strong>単純線形回帰</strong>を用いて、チップの額と食事の総支払額の関係をモデル化します。</p>
<ol>
<li>目的変数 <span class="arithmatex">\(y\)</span>: チップの額 (<code>tip</code>)（数値型）</li>
<li>説明変数 <span class="arithmatex">\(x\)</span>: 食事の総支払額 (<code>total_bill</code>)（数値型）</li>
</ol>
<p>使用するデータは、<code>seaborn</code>ライブラリに含まれる<code>tips</code>データセットです。このデータセットには、レストランのさまざまなテーブルでのチップの記録が含まれています。</p>
<h3 id="exploratory-data-analysis-eda">探索的データ分析 (Exploratory Data Analysis, EDA)</h3>
<p>まず、<code>tips</code>データセットを読み込み、基本的な情報を確認します。</p>
<div class="highlight"><pre><span></span><code><span class="c1"># seabornからtipsデータセットを読み込む</span>
<span class="n">tips</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">load_dataset</span><span class="p">(</span><span class="s1">&#39;tips&#39;</span><span class="p">)</span>
</code></pre></div>
<p>EDAでは主に以下の3つのステップを行います。
1.  データフレームの基本的な情報を確認し、実際のデータ値を見る。
2.  記述統計量（平均値、中央値、標準偏差など）を計算する。
3.  データを可視化する。</p>
<p><strong>1. 生のデータ値と構造の確認</strong></p>
<p><div class="highlight"><pre><span></span><code><span class="c1"># データの最初の数行を表示</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;レストランのチップデータの最初の5行:&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">tips</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>

<span class="c1"># データの構造（型や欠損値など）を確認</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">データの構造:&quot;</span><span class="p">)</span>
<span class="n">tips</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</code></pre></div>
<code>tips</code>データセットには、<code>total_bill</code> (総支払額), <code>tip</code> (チップ額), <code>sex</code> (支払者の性別), <code>smoker</code> (喫煙席か否か), <code>day</code> (曜日), <code>time</code> (時間帯), <code>size</code> (グループの人数) といった列が含まれています。このセクションでは主に <code>tip</code> と <code>total_bill</code> に注目します。幸い、このデータセットには欠損値はないようです。</p>
<p><strong>2. 記述統計量の計算</strong></p>
<p><div class="highlight"><pre><span></span><code><span class="c1"># tipとtotal_billの記述統計量の表示</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&#39;tip&#39;と&#39;total_bill&#39;の記述統計量:&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">tips</span><span class="p">[[</span><span class="s1">&#39;tip&#39;</span><span class="p">,</span> <span class="s1">&#39;total_bill&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">describe</span><span class="p">())</span>

<span class="c1"># チップ額と総支払額の相関係数を計算</span>
<span class="n">correlation_tips</span> <span class="o">=</span> <span class="n">tips</span><span class="p">[</span><span class="s1">&#39;tip&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="n">tips</span><span class="p">[</span><span class="s1">&#39;total_bill&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">チップ額と総支払額の相関係数: </span><span class="si">{</span><span class="n">correlation_tips</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
相関係数は約0.676であり、チップ額と総支払額の間には比較的強い正の線形関係があることを示唆しています。つまり、総支払額が高いほど、チップの額も高い傾向があると言えそうです。</p>
<p><strong>3. データの可視化</strong></p>
<p>目的変数も説明変数も数値型なので、散布図を作成するのが適切です。</p>
<p><div class="highlight"><pre><span></span><code><span class="c1"># 散布図の作成</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;total_bill&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;tip&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">tips</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;総支払額 (total_bill)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;チップ額 (tip)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;チップ額と総支払額の関係&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>
この散布図から、点が右上がりの傾向をはっきりと示しており、これは先ほど計算した相関係数0.676（比較的強い正の相関）と整合的です。</p>
<p>回帰直線を重ねて全体の傾向を捉えやすくしてみましょう。</p>
<p><div class="highlight"><pre><span></span><code><span class="c1"># 散布図と回帰直線の描画</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">regplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;total_bill&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;tip&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">tips</span><span class="p">,</span>
            <span class="n">scatter_kws</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;alpha&#39;</span><span class="p">:</span><span class="mf">0.4</span><span class="p">,</span> <span class="s1">&#39;s&#39;</span><span class="p">:</span><span class="mi">50</span><span class="p">},</span> <span class="c1"># 点の透明度とサイズ</span>
            <span class="n">line_kws</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span><span class="s1">&#39;blue&#39;</span><span class="p">},</span>        <span class="c1"># 回帰直線の色</span>
            <span class="n">ci</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>                          <span class="c1"># 信頼区間は今回は表示しない</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;総支払額 (total_bill)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;チップ額 (tip)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;チップ額と総支払額の関係 (回帰直線付き)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>
回帰直線は、データ点全体の右上がりの傾向をよく捉えています。</p>
<h3 id="_3">単純線形回帰</h3>
<p>統計モデリング、特に回帰分析では、回帰直線の方程式は <span class="arithmatex">\(\widehat{y} = b_0 + b_1 x\)</span> と書きます。
* <span class="arithmatex">\(b_0\)</span> は<strong>切片 (intercept)</strong> で、<span class="arithmatex">\(x=0\)</span> のときの <span class="arithmatex">\(\widehat{y}\)</span> の値です。（ご質問のモデル <span class="arithmatex">\(y = a + bx\)</span> における <span class="arithmatex">\(a\)</span> に相当）
* <span class="arithmatex">\(b_1\)</span> は説明変数 <span class="arithmatex">\(x\)</span> に対する<strong>傾き (slope)</strong> で、<span class="arithmatex">\(x\)</span> が1単位増加したときの <span class="arithmatex">\(\widehat{y}\)</span> の増加量です。（ご質問のモデル <span class="arithmatex">\(y = a + bx\)</span> における <span class="arithmatex">\(b\)</span> に相当）
* <span class="arithmatex">\(\widehat{y}\)</span> は、回帰モデルによって予測された<strong>予測値 (predicted value)</strong> または<strong>適合値 (fitted value)</strong> です。</p>
<p>Pythonの<code>statsmodels</code>ライブラリを使って、線形回帰モデルを当てはめてみましょう。</p>
<p><div class="highlight"><pre><span></span><code><span class="c1"># statsmodels を用いた線形回帰モデルの構築</span>
<span class="c1"># &#39;tip ~ total_bill&#39; は「tip を total_bill で説明する」という意味の formula</span>
<span class="n">model_tips_vs_bill</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="s1">&#39;tip ~ total_bill&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">tips</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>

<span class="c1"># 回帰結果の要約を表示</span>
<span class="nb">print</span><span class="p">(</span><span class="n">model_tips_vs_bill</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</code></pre></div>
<code>model_tips_vs_bill.summary()</code> の出力結果の中の <code>coef</code> という列（係数の推定値）に注目します。
* <code>Intercept</code> (切片 <span class="arithmatex">\(b_0\)</span>) の推定値は約 0.9203 です。
* <code>total_bill</code> (傾き <span class="arithmatex">\(b_1\)</span>) の推定値は約 0.1050 です。</p>
<p>したがって、当てはめられた回帰直線の方程式は次のようになります。
<span class="arithmatex">\(<span class="arithmatex">\(\widehat{\text{tip}} = 0.9203 + 0.1050 \cdot \text{total\_bill}\)</span>\)</span></p>
<p><strong>係数の解釈:</strong></p>
<ul>
<li>
<p><strong>切片 (<span class="arithmatex">\(b_0 \approx 0.9203\)</span>)</strong>: 「総支払額 <code>total_bill</code>」が0ドルの場合に予測されるチップ額が約0.92ドルであることを意味します。しかし、総支払額が0ドルというのは現実的な状況ではないため、この切片の値を実用的に解釈することにはあまり意味がありません。多くの場合、切片はモデルがデータに適合するために数学的に必要な値となります。</p>
</li>
<li>
<p><strong>傾き (<span class="arithmatex">\(b_1 \approx 0.1050\)</span>)</strong>: 「総支払額 <code>total_bill</code>」が1ドル増加するごとに、チップ額 <code>tip</code> は<strong>平均して</strong>約0.105ドル（約10.5セント）増加する<strong>関連がある</strong>と解釈されます。</p>
<ul>
<li>符号が正であるため、これら2つの変数間には正の関係があることが示唆されます。これは相関係数 (0.676) が正であったことと整合します。</li>
<li>繰り返しになりますが、これはあくまで「関連」であり、この分析だけから「総支払額の増加がチップ額の増加を<strong>引き起こす</strong>」という因果関係を断定することはできません（5.3節で詳述）。</li>
<li>「平均して」という言葉が重要です。総支払額が1ドル増えたからといって、必ずチップが正確に0.105ドル増えるわけではなく、多くのデータで見た場合の平均的な傾向を示しています。</li>
</ul>
</li>
</ul>
<p>回帰結果の主要な情報をまとめた表（回帰表）を作成してみましょう。</p>
<div class="highlight"><pre><span></span><code><span class="c1"># 回帰表の作成 (簡略版)</span>
<span class="n">regression_table_tips_vs_bill</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;term&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Intercept&#39;</span><span class="p">,</span> <span class="s1">&#39;total_bill&#39;</span><span class="p">],</span>
    <span class="s1">&#39;estimate&#39;</span><span class="p">:</span> <span class="n">model_tips_vs_bill</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
    <span class="s1">&#39;std_error&#39;</span><span class="p">:</span> <span class="n">model_tips_vs_bill</span><span class="o">.</span><span class="n">bse</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
    <span class="s1">&#39;t_value&#39;</span><span class="p">:</span> <span class="n">model_tips_vs_bill</span><span class="o">.</span><span class="n">tvalues</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
    <span class="s1">&#39;p_value&#39;</span><span class="p">:</span> <span class="n">model_tips_vs_bill</span><span class="o">.</span><span class="n">pvalues</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
    <span class="s1">&#39;conf_int_lower&#39;</span><span class="p">:</span> <span class="n">model_tips_vs_bill</span><span class="o">.</span><span class="n">conf_int</span><span class="p">()</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
    <span class="s1">&#39;conf_int_upper&#39;</span><span class="p">:</span> <span class="n">model_tips_vs_bill</span><span class="o">.</span><span class="n">conf_int</span><span class="p">()</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="p">})</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">回帰表 (tip ~ total_bill):&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">regression_table_tips_vs_bill</span><span class="p">)</span>
</code></pre></div>
<h3 id="_4">観測値、予測値、残差</h3>
<p>回帰分析では、以下の3つの値が重要です。
1.  <strong>観測値 (<span class="arithmatex">\(y_i\)</span>)</strong>: 実際にデータとして観測された目的変数の値。
2.  <strong>予測値 (<span class="arithmatex">\(\widehat{y}_i\)</span>)</strong>: 当てはめられた回帰モデルから、ある説明変数の値 <span class="arithmatex">\(x_i\)</span> に基づいて予測される目的変数の値。
3.  <strong>残差 (<span class="arithmatex">\(e_i = y_i - \widehat{y}_i\)</span>)</strong>: 観測値と予測値の差。モデルの「誤差」を表します。</p>
<p>例えば、最初のデータ点を見てみましょう。総支払額が <span class="arithmatex">\(x = 16.99\)</span> ドル、実際のチップ額は <span class="arithmatex">\(y = 1.01\)</span> ドルです。
この場合の予測チップ額 <span class="arithmatex">\(\widehat{y}\)</span> は、
<span class="arithmatex">\(<span class="arithmatex">\(\widehat{\text{tip}} = 0.9203 + 0.1050 \cdot 16.99 \approx 0.9203 + 1.7840 \approx 2.7043\)</span>\)</span>残差は、<span class="arithmatex">\(<span class="arithmatex">\(e = y - \widehat{y} = 1.01 - 2.7043 \approx -1.6943\)</span>\)</span>
となります。この場合、モデルは実際のチップ額よりも高く予測したため、残差は負の値になっています。</p>
<p>これらの値を全てのデータ点について計算し、データフレームに追加してみましょう。</p>
<div class="highlight"><pre><span></span><code><span class="c1"># 予測値と残差をデータフレームに追加</span>
<span class="n">tips</span><span class="p">[</span><span class="s1">&#39;tip_hat_vs_bill&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">model_tips_vs_bill</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">tips</span><span class="p">)</span>
<span class="n">tips</span><span class="p">[</span><span class="s1">&#39;residual_vs_bill&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">model_tips_vs_bill</span><span class="o">.</span><span class="n">resid</span>

<span class="c1"># 最初の数行を表示して確認</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">予測値と残差を含むデータフレームの最初の数行:&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">tips</span><span class="p">[[</span><span class="s1">&#39;total_bill&#39;</span><span class="p">,</span> <span class="s1">&#39;tip&#39;</span><span class="p">,</span> <span class="s1">&#39;tip_hat_vs_bill&#39;</span><span class="p">,</span> <span class="s1">&#39;residual_vs_bill&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</code></pre></div>
<p><strong>残差プロット</strong>
残差の性質を調べるために、残差プロットを作成します。</p>
<p><div class="highlight"><pre><span></span><code><span class="c1"># 残差プロットの作成</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;tip_hat_vs_bill&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;residual_vs_bill&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">tips</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span> <span class="c1"># y=0 の線</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;予測チップ額 (ŷ)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;残差 (y - ŷ)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;残差プロット (tip ~ total_bill)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>
理想的には、残差は <span class="arithmatex">\(y=0\)</span> の線の周りにランダムに散らばり、明確なパターンが見られないことが望ましいです。このプロットでは、予測値が大きくなるにつれて残差のばらつきも若干大きくなる（扇形のような形）傾向が見られるかもしれません。これは<strong>不等分散性</strong>の兆候である可能性があり、より高度なモデリングでは考慮すべき点ですが、本章では深入りしません。</p>
<p><strong>残差のヒストグラム</strong>
<div class="highlight"><pre><span></span><code><span class="c1"># 残差のヒストグラム</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">tips</span><span class="p">[</span><span class="s1">&#39;residual_vs_bill&#39;</span><span class="p">],</span> <span class="n">kde</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;残差 (y - ŷ)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;度数&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;残差のヒストグラム (tip ~ total_bill)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>
残差は0を中心におおよそ対称的に分布しているように見えますが、少し右に裾が長い（正の方向に偏っている）かもしれません。</p>
<h3 id="line-of-best-fit">最適な当てはめ直線 (Line of Best Fit) と最小二乗法</h3>
<p>回帰直線は「最適な当てはめ直線」とも呼ばれます。では、何をもって「最適」と判断するのでしょうか？
回帰分析では、観測された全てのデータ点に対して、<strong>残差の平方和 (Sum of Squared Residuals, SSRまたはSSE)</strong> を最小にするような直線を「最適」な直線として選びます。残差平方和は以下のように定義されます。
<span class="arithmatex">\(<span class="arithmatex">\(SSR = \sum_{i=1}^{n} (y_i - \widehat{y}_i)^2 = \sum_{i=1}^{n} e_i^2\)</span>\)</span>
ここで、<span class="arithmatex">\(n\)</span> はデータ点の数です。各データ点での誤差（残差）を二乗し、それらを全て合計したものです。二乗することで、正の誤差も負の誤差も正の値として扱われ、大きな誤差ほどSSRへの寄与が大きくなります。
このSSRを最小にするという基準は、<strong>最小二乗法 (Method of Least Squares)</strong> と呼ばれます。</p>
<p><strong>最小二乗法による <span class="arithmatex">\(b_0\)</span> と <span class="arithmatex">\(b_1\)</span> の導出</strong></p>
<p>単純線形回帰モデル <span class="arithmatex">\(\widehat{y}_i = b_0 + b_1 x_i\)</span> において、SSRは次のように書けます。
<span class="arithmatex">\(<span class="arithmatex">\(SSR(b_0, b_1) = \sum_{i=1}^{n} (y_i - (b_0 + b_1 x_i))^2\)</span>\)</span>
この <span class="arithmatex">\(SSR(b_0, b_1)\)</span> を最小にする <span class="arithmatex">\(b_0\)</span> と <span class="arithmatex">\(b_1\)</span> を見つけるために、大学で学ぶ微分積分学の知識を使います。具体的には、<span class="arithmatex">\(SSR\)</span> を <span class="arithmatex">\(b_0\)</span> と <span class="arithmatex">\(b_1\)</span> それぞれで偏微分し、その値を0とおいた連立方程式（正規方程式と呼ばれます）を解きます。</p>
<ol>
<li>
<p><strong><span class="arithmatex">\(b_0\)</span> に関する偏微分:</strong>
    <span class="arithmatex">\(<span class="arithmatex">\(\frac{\partial SSR}{\partial b_0} = \sum_{i=1}^{n} 2(y_i - b_0 - b_1 x_i)(-1) = -2 \sum_{i=1}^{n} (y_i - b_0 - b_1 x_i)\)</span>\)</span>
    これを0とおくと、
    <span class="arithmatex">\(<span class="arithmatex">\(\sum_{i=1}^{n} (y_i - b_0 - b_1 x_i) = 0\)</span>\)</span>   <span class="arithmatex">\(<span class="arithmatex">\(\sum y_i - n b_0 - b_1 \sum x_i = 0\)</span>\)</span>   <span class="arithmatex">\(<span class="arithmatex">\(n b_0 + b_1 \sum x_i = \sum y_i \quad \cdots (1)\)</span>\)</span></p>
</li>
<li>
<p><strong><span class="arithmatex">\(b_1\)</span> に関する偏微分:</strong>
    <span class="arithmatex">\(<span class="arithmatex">\(\frac{\partial SSR}{\partial b_1} = \sum_{i=1}^{n} 2(y_i - b_0 - b_1 x_i)(-x_i) = -2 \sum_{i=1}^{n} x_i(y_i - b_0 - b_1 x_i)\)</span>\)</span>
    これを0とおくと、
    <span class="arithmatex">\(<span class="arithmatex">\(\sum_{i=1}^{n} (x_i y_i - b_0 x_i - b_1 x_i^2) = 0\)</span>\)</span>   <span class="arithmatex">\(<span class="arithmatex">\(b_0 \sum x_i + b_1 \sum x_i^2 = \sum x_i y_i \quad \cdots (2)\)</span>\)</span></p>
</li>
</ol>
<p>これで、<span class="arithmatex">\(b_0\)</span> と <span class="arithmatex">\(b_1\)</span> に関する2つの正規方程式が得られました。これらを解きます。
まず、(1)式を <span class="arithmatex">\(n\)</span> で割ると、
<span class="arithmatex">\(<span class="arithmatex">\(b_0 + b_1 \frac{\sum x_i}{n} = \frac{\sum y_i}{n}\)</span>\)</span>ここで、<span class="arithmatex">\(\bar{x} = \frac{\sum x_i}{n}\)</span>（<span class="arithmatex">\(x\)</span>の平均値）、<span class="arithmatex">\(\bar{y} = \frac{\sum y_i}{n}\)</span>（<span class="arithmatex">\(y\)</span>の平均値）なので、<span class="arithmatex">\(<span class="arithmatex">\(b_0 + b_1 \bar{x} = \bar{y}\)</span>\)</span>
<span class="arithmatex">\(<span class="arithmatex">\(b_0 = \bar{y} - b_1 \bar{x} \quad \cdots (3)\)</span>\)</span>
この(3)式は、回帰直線 <span class="arithmatex">\((\widehat{y} = b_0 + b_1 x)\)</span> が必ず点 <span class="arithmatex">\((\bar{x}, \bar{y})\)</span> を通ることを示しています。</p>
<p>次に、(3)式を(2)式に代入します。
<span class="arithmatex">\(<span class="arithmatex">\((\bar{y} - b_1 \bar{x}) \sum x_i + b_1 \sum x_i^2 = \sum x_i y_i\)</span>\)</span>
<span class="arithmatex">\(<span class="arithmatex">\(\bar{y} \sum x_i - b_1 \bar{x} \sum x_i + b_1 \sum x_i^2 = \sum x_i y_i\)</span>\)</span><span class="arithmatex">\(b_1\)</span> について整理すると、<span class="arithmatex">\(<span class="arithmatex">\(b_1 (\sum x_i^2 - \bar{x} \sum x_i) = \sum x_i y_i - \bar{y} \sum x_i\)</span>\)</span>ここで、<span class="arithmatex">\(\bar{x} \sum x_i = \frac{(\sum x_i)^2}{n}\)</span> および <span class="arithmatex">\(\bar{y} \sum x_i = \frac{(\sum y_i)(\sum x_i)}{n}\)</span> を使うと、<span class="arithmatex">\(<span class="arithmatex">\(b_1 \left(\sum x_i^2 - \frac{(\sum x_i)^2}{n}\right) = \sum x_i y_i - \frac{(\sum y_i)(\sum x_i)}{n}\)</span>\)</span>分子・分母に <span class="arithmatex">\(n\)</span> を掛けると、<span class="arithmatex">\(<span class="arithmatex">\(b_1 = \frac{n \sum x_i y_i - (\sum x_i)(\sum y_i)}{n \sum x_i^2 - (\sum x_i)^2}\)</span>\)</span>この式は、偏差平方和や偏差積和の記号 <span class="arithmatex">\(S_{xx} = \sum (x_i - \bar{x})^2 = \sum x_i^2 - n\bar{x}^2\)</span> や <span class="arithmatex">\(S_{xy} = \sum (x_i - \bar{x})(y_i - \bar{y}) = \sum x_i y_i - n\bar{x}\bar{y}\)</span> を用いると、より簡潔に以下のように書けます。<span class="arithmatex">\(<span class="arithmatex">\(b_1 = \frac{S_{xy}}{S_{xx}} = \frac{\sum (x_i - \bar{x})(y_i - \bar{y})}{\sum (x_i - \bar{x})^2}\)</span>\)</span>そして、<span class="arithmatex">\(b_1\)</span> が求まれば、(3)式から <span class="arithmatex">\(b_0\)</span> が求まります。<span class="arithmatex">\(<span class="arithmatex">\(b_0 = \bar{y} - b_1 \bar{x}\)</span>\)</span></p>
<p>これらの計算は複雑に見えるかもしれませんが、コンピュータ（例えばPythonの<code>statsmodels</code>ライブラリ）が瞬時に行ってくれます。重要なのは、回帰直線がデータへの当てはまりの指標である残差平方和を最小にするように数学的に決定されている、という原理を理解することです。</p>
<p><div class="highlight"><pre><span></span><code><span class="c1"># このモデルの残差平方和</span>
<span class="n">ssr_tips_vs_bill</span> <span class="o">=</span> <span class="n">model_tips_vs_bill</span><span class="o">.</span><span class="n">ssr</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;このモデルの残差平方和 (SSR): </span><span class="si">{</span><span class="n">ssr_tips_vs_bill</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
<code>statsmodels</code>が出力した係数 <span class="arithmatex">\(b_0\)</span> と <span class="arithmatex">\(b_1\)</span> は、まさにこのSSRを最小にする値です。</p>
<hr />
<h2 id="52-1">5.2 1つのカテゴリ的説明変数</h2>
<p>レストランで支払われるチップの額は、曜日によって異なるのでしょうか？例えば、週末は平日よりもチップが多くなる傾向があるのでしょうか？</p>
<p>この節では、曜日という1つのカテゴリ型説明変数を用いて、チップの額の違いを探ります。引き続き <code>tips</code> データセットを使用します。</p>
<ol>
<li>目的変数 <span class="arithmatex">\(y\)</span>: チップの額 (<code>tip</code>)（数値型）</li>
<li>説明変数 <span class="arithmatex">\(x\)</span>: 曜日 (<code>day</code>)（カテゴリ型: 木, 金, 土, 日）</li>
</ol>
<h3 id="_5">探索的データ分析</h3>
<p><strong>1. <code>day</code> 変数の確認と記述統計量</strong>
<div class="highlight"><pre><span></span><code><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">曜日のカテゴリとそれぞれの件数:&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">tips</span><span class="p">[</span><span class="s1">&#39;day&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">曜日ごとのチップ額の記述統計量:&quot;</span><span class="p">)</span>
<span class="n">tip_by_day_summary</span> <span class="o">=</span> <span class="n">tips</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;day&#39;</span><span class="p">)[</span><span class="s1">&#39;tip&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;median&#39;</span><span class="p">,</span> <span class="s1">&#39;std&#39;</span><span class="p">,</span> <span class="s1">&#39;min&#39;</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span><span class="p">,</span> <span class="s1">&#39;count&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">tip_by_day_summary</span><span class="p">)</span>
</code></pre></div>
データには木曜日(Thur)、金曜日(Fri)、土曜日(Sat)、日曜日(Sun)の4つの曜日が含まれています。平均チップ額を見ると、日曜と土曜が高く、金曜が最も低いようです。</p>
<p><strong>2. データの可視化</strong></p>
<p>曜日ごとにチップ額の分布を箱ひげ図で比較します。
<div class="highlight"><pre><span></span><code><span class="c1"># 曜日別のチップ額の箱ひげ図</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="c1"># tips[&#39;day&#39;].cat.categories でカテゴリの順序を取得して表示順を指定</span>
<span class="n">day_order</span> <span class="o">=</span> <span class="n">tips</span><span class="p">[</span><span class="s1">&#39;day&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">categories</span> 
<span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;day&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;tip&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">tips</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="n">day_order</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;曜日 (day)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;チップ額 (tip)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;曜日別のチップ額の分布&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># 曜日別のチップ額のバイオリンプロット</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">violinplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;day&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;tip&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">tips</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="n">day_order</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;曜日 (day)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;チップ額 (tip)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;曜日別のチップ額の分布 - バイオリンプロット&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>
箱ひげ図やバイオリンプロットから、曜日によってチップ額の分布に違いが見られそうです。特に土曜日と日曜日は中央値が高く、ばらつきも大きいように見えます。</p>
<h3 id="_6">線形回帰</h3>
<p>カテゴリ型の説明変数 <code>day</code> を用いて、チップ額 <code>tip</code> を説明する線形回帰モデルを当てはめてみましょう。</p>
<div class="highlight"><pre><span></span><code><span class="c1"># カテゴリ変数を説明変数とした線形回帰モデル</span>
<span class="n">model_tips_vs_day</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="s1">&#39;tip ~ C(day)&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">tips</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>

<span class="c1"># 回帰結果の要約を表示</span>
<span class="nb">print</span><span class="p">(</span><span class="n">model_tips_vs_day</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</code></pre></div>
<p>回帰結果の <code>coef</code>（係数）の部分に注目します。<code>statsmodels</code> は、<code>tips</code> データセットの <code>day</code> 列（カテゴリ型）のカテゴリの中で、通常、最初のもの（このデータセットでは <code>Thur</code> (木曜日)）を<strong>基準カテゴリ (baseline category)</strong> として自動的に選択します。
* <code>Intercept</code>: 約2.771。これは基準カテゴリである木曜日 (<code>Thur</code>) の平均チップ額の推定値です。
* <code>C(day)[T.Fri]</code>: 約-0.030。これは金曜日 (<code>Fri</code>) の平均チップ額が、木曜日の平均チップ額よりも平均して約0.030ドル低いことを示します。したがって、金曜日の平均チップ額の推定値は <span class="arithmatex">\(2.771 - 0.030 \approx 2.741\)</span> ドルです。
* <code>C(day)[T.Sat]</code>: 約0.212。土曜日 (<code>Sat</code>) は木曜日より平均約0.212ドル高い。推定平均チップ額は <span class="arithmatex">\(2.771 + 0.212 \approx 2.983\)</span> ドル。
* <code>C(day)[T.Sun]</code>: 約0.478。日曜日 (<code>Sun</code>) は木曜日より平均約0.478ドル高い。推定平均チップ額は <span class="arithmatex">\(2.771 + 0.478 \approx 3.249\)</span> ドル。</p>
<p>他のカテゴリの係数は、この基準カテゴリとの差（オフセット）を表します。</p>
<p>回帰表を整理してみましょう。
<div class="highlight"><pre><span></span><code><span class="c1"># 回帰表の作成 (簡略版)</span>
<span class="n">base_category</span> <span class="o">=</span> <span class="n">tips</span><span class="p">[</span><span class="s1">&#39;day&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># &#39;Thur&#39;</span>
<span class="n">terms_day</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;Intercept (</span><span class="si">{</span><span class="n">base_category</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">term_name</span> <span class="ow">in</span> <span class="n">model_tips_vs_day</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
    <span class="n">day_name</span> <span class="o">=</span> <span class="n">term_name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;[T.&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">terms_day</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">day_name</span><span class="si">}</span><span class="s2"> (vs </span><span class="si">{</span><span class="n">base_category</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>

<span class="n">regression_table_tips_vs_day</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;term&#39;</span><span class="p">:</span> <span class="n">terms_day</span><span class="p">,</span>
    <span class="s1">&#39;estimate&#39;</span><span class="p">:</span> <span class="n">model_tips_vs_day</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
    <span class="s1">&#39;std_error&#39;</span><span class="p">:</span> <span class="n">model_tips_vs_day</span><span class="o">.</span><span class="n">bse</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
    <span class="s1">&#39;t_value&#39;</span><span class="p">:</span> <span class="n">model_tips_vs_day</span><span class="o">.</span><span class="n">tvalues</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
    <span class="s1">&#39;p_value&#39;</span><span class="p">:</span> <span class="n">model_tips_vs_day</span><span class="o">.</span><span class="n">pvalues</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
    <span class="s1">&#39;conf_int_lower&#39;</span><span class="p">:</span> <span class="n">model_tips_vs_day</span><span class="o">.</span><span class="n">conf_int</span><span class="p">()</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
    <span class="s1">&#39;conf_int_upper&#39;</span><span class="p">:</span> <span class="n">model_tips_vs_day</span><span class="o">.</span><span class="n">conf_int</span><span class="p">()</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="p">})</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">カテゴリ変数を用いた回帰の回帰表 (基準: </span><span class="si">{</span><span class="n">base_category</span><span class="si">}</span><span class="s2">):&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">regression_table_tips_vs_day</span><span class="p">)</span>
</code></pre></div>
この表の <code>estimate</code> を使うと、各曜日の平均チップ額の推定値が、EDAで計算した <code>tip_by_day_summary</code> の <code>mean</code> 列と一致することを確認できます。</p>
<h3 id="_7">観測値、予測値、残差</h3>
<p>このモデルにおける予測値 <span class="arithmatex">\(\widehat{y}_i\)</span> は、その食事がなされた曜日の平均チップ額の推定値となります。</p>
<p><div class="highlight"><pre><span></span><code><span class="c1"># 予測値と残差をデータフレームに追加</span>
<span class="n">tips</span><span class="p">[</span><span class="s1">&#39;tip_hat_vs_day&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">model_tips_vs_day</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">tips</span><span class="p">)</span>
<span class="n">tips</span><span class="p">[</span><span class="s1">&#39;residual_vs_day&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">model_tips_vs_day</span><span class="o">.</span><span class="n">resid</span>

<span class="c1"># 曜日、観測値、予測値、残差を表示 (最初の数行)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">観測値、予測値、残差を含むデータフレーム (tip ~ day):&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">tips</span><span class="p">[[</span><span class="s1">&#39;day&#39;</span><span class="p">,</span> <span class="s1">&#39;tip&#39;</span><span class="p">,</span> <span class="s1">&#39;tip_hat_vs_day&#39;</span><span class="p">,</span> <span class="s1">&#39;residual_vs_day&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</code></pre></div>
例えば、最初のデータ点が日曜日 (<code>Sun</code>) で、実際のチップ額が1.01ドルだったとします。日曜日の予測平均チップ額 (tip_hat_vs_day) は約3.249ドルです。したがって、この場合の残差は約 <span class="arithmatex">\(1.01 - 3.249 = -2.239\)</span> ドルとなります。</p>
<p>残差の分布を曜日ごとに見てみましょう。
<div class="highlight"><pre><span></span><code><span class="c1"># 曜日別の残差の箱ひげ図</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;day&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;residual_vs_day&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">tips</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="n">day_order</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;曜日 (day)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;残差 (tip - tip_hat_vs_day)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;曜日別の残差の分布&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>
このプロットは、各曜日の平均チップ額からの個々のチップ額のばらつきを示しています。</p>
<hr />
<h2 id="53-correlation-does-not-imply-causation">5.3 相関は必ずしも因果を意味しない (Correlation does not imply causation)</h2>
<p>この章を通じて、回帰係数を解釈する際には慎重な言葉遣いを心がけてきました。例えば、「総支払額 <code>total_bill</code> が1ドル増加するごとに、チップ額 <code>tip</code> は<strong>平均して</strong>約0.105ドル増加する<strong>関連がある</strong>」と述べました。「関連がある」という言葉を使うことで、直接的な因果関係を主張しているわけではないことを明確にしています。</p>
<p>2つの変数 X と Y の間に統計的な相関や関連が見られたとしても、それが必ずしも「X が Y を引き起こす」という因果関係を意味するわけではありません。この原則は非常に重要です。</p>
<p>例として、ある医師が「靴を履いたまま寝た患者は、翌朝頭痛を訴える傾向がある」という関連を医療記録から発見したとします。この医師が「靴を履いて寝ることが頭痛を引き起こす！」と結論付けるのは早計です。
実際には、<strong>交絡変数 (confounding variable)</strong> が存在する可能性があります。この場合、それは「前夜の飲酒量」かもしれません。
* 飲酒量が多い (Z) <span class="arithmatex">\(\rightarrow\)</span> 靴を履いたまま寝てしまう可能性が高い (X)
* 飲酒量が多い (Z) <span class="arithmatex">\(\rightarrow\)</span> 二日酔いで頭痛がする可能性が高い (Y)</p>
<p>この関係を図で示すと以下のようになります。
<div class="highlight"><pre><span></span><code>      Z (飲酒量)
     / \
    /   \
   v     v
  X       Y
(靴就寝) (頭痛)
</code></pre></div>
この状況では、X と Y の間には見かけ上の関連がありますが、真の原因は Z である可能性があります。X と Y の真の因果関係を評価するためには、Z の影響を考慮に入れる（例：Z で調整する）必要があります。</p>
<p>因果関係を確立するには、ランダム化比較試験 (RCT) のような慎重に設計された実験的研究や、観察研究であっても高度な統計的手法（因果推論の手法）を用いて交絡変数の影響を制御する努力が必要です。線形回帰モデルを立てただけでは、通常、因果関係について強い主張をすることはできません。</p>
<hr />
<h2 id="_8">まとめ</h2>
<p>この章では、データモデリングの基本的なアプローチである<strong>線形回帰分析</strong>の基礎を学びました。特に、説明変数が1つの場合に焦点を当て、<code>seaborn</code>ライブラリの<code>tips</code>データセットを用いて具体的な分析を行いました。</p>
<p>主な学習ポイントは以下の通りです。
1.  <strong>モデリングの目的</strong>: 「説明のためのモデリング」と「予測のためのモデリング」の違いを理解しました。
2.  <strong>単純線形回帰</strong>: 1つの数値型説明変数を用いて数値型の目的変数をモデル化する方法（<span class="arithmatex">\(\widehat{y} = b_0 + b_1 x\)</span>）を学び、係数 <span class="arithmatex">\(b_0\)</span>（切片）と <span class="arithmatex">\(b_1\)</span>（傾き）の解釈を行いました。
3.  <strong>最小二乗法による係数の導出</strong>: 回帰直線の係数 <span class="arithmatex">\(b_0\)</span> と <span class="arithmatex">\(b_1\)</span> が、残差平方和を最小にするように数学的に導かれる過程を理解しました。
4.  <strong>カテゴリ型説明変数を持つ回帰</strong>: 1つのカテゴリ型説明変数を用いて数値型の目的変数をモデル化する方法を学びました。基準カテゴリと比較したオフセットとして係数が解釈されることを見ました。
5.  <strong>探索的データ分析(EDA)</strong>: モデリングの前段階として、データの可視化や記述統計量の確認が重要であることを再認識しました。
6.  <strong>観測値、予測値、残差</strong>: これらの基本的な概念と、残差プロットや残差の分布の確認の重要性を学びました。
7.  <strong>相関と因果</strong>: 「相関は必ずしも因果を意味しない」という統計学における重要な注意点を、交絡変数の例と共に学びました。</p>
<p>Pythonのライブラリ（<code>pandas</code>, <code>matplotlib</code>, <code>seaborn</code>, <code>statsmodels</code>）を使い、レストランのチップデータという身近な例でこれらの分析を実行し、結果を解釈する方法を体験しました。</p>
<p>次の章では、複数の説明変数を持つ<strong>重回帰分析 (multiple linear regression)</strong> へと進み、より複雑な関係性を捉えることができるモデルについて学んでいきます。</p>
<hr />
<h2 id="python-google-colab">Pythonコード一括実行用 (Google Colab向け)</h2>
<p>以下に、この章で用いたPythonコードをまとめて記述します。</p>
<div class="highlight"><pre><span></span><code><span class="c1"># 必要なライブラリのインポート</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">seaborn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sns</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">statsmodels.api</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sm</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">statsmodels.formula.api</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">smf</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">IPython.display</span><span class="w"> </span><span class="kn">import</span> <span class="n">display</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;==================================================&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;5.1 1つの数値的説明変数 (tipsデータセット)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;==================================================</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># seabornからtipsデータセットを読み込む</span>
<span class="n">tips</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">load_dataset</span><span class="p">(</span><span class="s1">&#39;tips&#39;</span><span class="p">)</span>

<span class="c1"># 1. 生のデータ値と構造の確認</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;レストランのチップデータの最初の5行:&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">tips</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">データの構造:&quot;</span><span class="p">)</span>
<span class="n">tips</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>

<span class="c1"># 2. 記述統計量の計算</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&#39;tip&#39;と&#39;total_bill&#39;の記述統計量:&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">tips</span><span class="p">[[</span><span class="s1">&#39;tip&#39;</span><span class="p">,</span> <span class="s1">&#39;total_bill&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">describe</span><span class="p">())</span>
<span class="n">correlation_tips</span> <span class="o">=</span> <span class="n">tips</span><span class="p">[</span><span class="s1">&#39;tip&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="n">tips</span><span class="p">[</span><span class="s1">&#39;total_bill&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">チップ額と総支払額の相関係数: </span><span class="si">{</span><span class="n">correlation_tips</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># 3. データの可視化</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">--- 散布図 ---&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;total_bill&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;tip&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">tips</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;総支払額 (total_bill)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;チップ額 (tip)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;チップ額と総支払額の関係&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">--- 散布図と回帰直線 ---&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">regplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;total_bill&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;tip&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">tips</span><span class="p">,</span>
            <span class="n">scatter_kws</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;alpha&#39;</span><span class="p">:</span><span class="mf">0.4</span><span class="p">,</span> <span class="s1">&#39;s&#39;</span><span class="p">:</span><span class="mi">50</span><span class="p">},</span>
            <span class="n">line_kws</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span><span class="s1">&#39;blue&#39;</span><span class="p">},</span>
            <span class="n">ci</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;総支払額 (total_bill)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;チップ額 (tip)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;チップ額と総支払額の関係 (回帰直線付き)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># 単純線形回帰</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">--- 単純線形回帰モデル (tip ~ total_bill) ---&quot;</span><span class="p">)</span>
<span class="n">model_tips_vs_bill</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="s1">&#39;tip ~ total_bill&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">tips</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">model_tips_vs_bill</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>

<span class="n">regression_table_tips_vs_bill</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;term&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Intercept&#39;</span><span class="p">,</span> <span class="s1">&#39;total_bill&#39;</span><span class="p">],</span>
    <span class="s1">&#39;estimate&#39;</span><span class="p">:</span> <span class="n">model_tips_vs_bill</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
    <span class="s1">&#39;std_error&#39;</span><span class="p">:</span> <span class="n">model_tips_vs_bill</span><span class="o">.</span><span class="n">bse</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
    <span class="s1">&#39;t_value&#39;</span><span class="p">:</span> <span class="n">model_tips_vs_bill</span><span class="o">.</span><span class="n">tvalues</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
    <span class="s1">&#39;p_value&#39;</span><span class="p">:</span> <span class="n">model_tips_vs_bill</span><span class="o">.</span><span class="n">pvalues</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
    <span class="s1">&#39;conf_int_lower&#39;</span><span class="p">:</span> <span class="n">model_tips_vs_bill</span><span class="o">.</span><span class="n">conf_int</span><span class="p">()</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
    <span class="s1">&#39;conf_int_upper&#39;</span><span class="p">:</span> <span class="n">model_tips_vs_bill</span><span class="o">.</span><span class="n">conf_int</span><span class="p">()</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="p">})</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">回帰表 (tip ~ total_bill):&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">regression_table_tips_vs_bill</span><span class="p">)</span>

<span class="c1"># 観測値、予測値、残差</span>
<span class="n">tips</span><span class="p">[</span><span class="s1">&#39;tip_hat_vs_bill&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">model_tips_vs_bill</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">tips</span><span class="p">)</span>
<span class="n">tips</span><span class="p">[</span><span class="s1">&#39;residual_vs_bill&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">model_tips_vs_bill</span><span class="o">.</span><span class="n">resid</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">予測値と残差を含むデータフレームの最初の数行:&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">tips</span><span class="p">[[</span><span class="s1">&#39;total_bill&#39;</span><span class="p">,</span> <span class="s1">&#39;tip&#39;</span><span class="p">,</span> <span class="s1">&#39;tip_hat_vs_bill&#39;</span><span class="p">,</span> <span class="s1">&#39;residual_vs_bill&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">--- 残差プロット (tip ~ total_bill) ---&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;tip_hat_vs_bill&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;residual_vs_bill&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">tips</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;予測チップ額 (ŷ)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;残差 (y - ŷ)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;残差プロット (tip ~ total_bill)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">--- 残差のヒストグラム (tip ~ total_bill) ---&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">tips</span><span class="p">[</span><span class="s1">&#39;residual_vs_bill&#39;</span><span class="p">],</span> <span class="n">kde</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;残差 (y - ŷ)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;度数&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;残差のヒストグラム (tip ~ total_bill)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">ssr_tips_vs_bill</span> <span class="o">=</span> <span class="n">model_tips_vs_bill</span><span class="o">.</span><span class="n">ssr</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">このモデルの残差平方和 (SSR): </span><span class="si">{</span><span class="n">ssr_tips_vs_bill</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>


<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">==================================================&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;5.2 1つのカテゴリ的説明変数 (tipsデータセット)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;==================================================</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># 1. `day` 変数の確認と記述統計量</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">曜日のカテゴリとそれぞれの件数:&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">tips</span><span class="p">[</span><span class="s1">&#39;day&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">曜日ごとのチップ額の記述統計量:&quot;</span><span class="p">)</span>
<span class="n">tip_by_day_summary</span> <span class="o">=</span> <span class="n">tips</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;day&#39;</span><span class="p">)[</span><span class="s1">&#39;tip&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;median&#39;</span><span class="p">,</span> <span class="s1">&#39;std&#39;</span><span class="p">,</span> <span class="s1">&#39;min&#39;</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span><span class="p">,</span> <span class="s1">&#39;count&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">tip_by_day_summary</span><span class="p">)</span>

<span class="c1"># 2. データの可視化</span>
<span class="n">day_order</span> <span class="o">=</span> <span class="n">tips</span><span class="p">[</span><span class="s1">&#39;day&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">categories</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">--- 曜日別のチップ額の箱ひげ図 ---&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;day&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;tip&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">tips</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="n">day_order</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;曜日 (day)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;チップ額 (tip)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;曜日別のチップ額の分布&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">--- 曜日別のチップ額のバイオリンプロット ---&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">violinplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;day&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;tip&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">tips</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="n">day_order</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;曜日 (day)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;チップ額 (tip)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;曜日別のチップ額の分布 - バイオリンプロット&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># 線形回帰</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">--- カテゴリ変数を説明変数とした線形回帰モデル (tip ~ C(day)) ---&quot;</span><span class="p">)</span>
<span class="n">model_tips_vs_day</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="s1">&#39;tip ~ C(day)&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">tips</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">model_tips_vs_day</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>

<span class="n">base_category</span> <span class="o">=</span> <span class="n">tips</span><span class="p">[</span><span class="s1">&#39;day&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">categories</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">terms_day</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;Intercept (</span><span class="si">{</span><span class="n">base_category</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">term_name</span> <span class="ow">in</span> <span class="n">model_tips_vs_day</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
    <span class="n">day_name</span> <span class="o">=</span> <span class="n">term_name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;[T.&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">terms_day</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">day_name</span><span class="si">}</span><span class="s2"> (vs </span><span class="si">{</span><span class="n">base_category</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>

<span class="n">regression_table_tips_vs_day</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;term&#39;</span><span class="p">:</span> <span class="n">terms_day</span><span class="p">,</span>
    <span class="s1">&#39;estimate&#39;</span><span class="p">:</span> <span class="n">model_tips_vs_day</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
    <span class="s1">&#39;std_error&#39;</span><span class="p">:</span> <span class="n">model_tips_vs_day</span><span class="o">.</span><span class="n">bse</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
    <span class="s1">&#39;t_value&#39;</span><span class="p">:</span> <span class="n">model_tips_vs_day</span><span class="o">.</span><span class="n">tvalues</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
    <span class="s1">&#39;p_value&#39;</span><span class="p">:</span> <span class="n">model_tips_vs_day</span><span class="o">.</span><span class="n">pvalues</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
    <span class="s1">&#39;conf_int_lower&#39;</span><span class="p">:</span> <span class="n">model_tips_vs_day</span><span class="o">.</span><span class="n">conf_int</span><span class="p">()</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
    <span class="s1">&#39;conf_int_upper&#39;</span><span class="p">:</span> <span class="n">model_tips_vs_day</span><span class="o">.</span><span class="n">conf_int</span><span class="p">()</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="p">})</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">カテゴリ変数を用いた回帰の回帰表 (基準: </span><span class="si">{</span><span class="n">base_category</span><span class="si">}</span><span class="s2">):&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">regression_table_tips_vs_day</span><span class="p">)</span>

<span class="c1"># 観測値、予測値、残差</span>
<span class="n">tips</span><span class="p">[</span><span class="s1">&#39;tip_hat_vs_day&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">model_tips_vs_day</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">tips</span><span class="p">)</span>
<span class="n">tips</span><span class="p">[</span><span class="s1">&#39;residual_vs_day&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">model_tips_vs_day</span><span class="o">.</span><span class="n">resid</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">観測値、予測値、残差を含むデータフレーム (tip ~ day):&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">tips</span><span class="p">[[</span><span class="s1">&#39;day&#39;</span><span class="p">,</span> <span class="s1">&#39;tip&#39;</span><span class="p">,</span> <span class="s1">&#39;tip_hat_vs_day&#39;</span><span class="p">,</span> <span class="s1">&#39;residual_vs_day&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">--- 曜日別の残差の箱ひげ図 ---&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;day&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;residual_vs_day&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">tips</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="n">day_order</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;曜日 (day)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;残差 (tip - tip_hat_vs_day)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;曜日別の残差の分布&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">講義資料は以上です。&quot;</span><span class="p">)</span>
</code></pre></div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  ページトップへ戻る
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2024 - 2025 Tomoshige Nakamura
    </div>
  
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.sections", "navigation.indexes", "navigation.collapse", "navigation.tracking", "navigation.path", "navigation.top", "toc.follow"], "search": "../../../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "\u30b3\u30d4\u30fc\u3057\u307e\u3057\u305f", "clipboard.copy": "\u30af\u30ea\u30c3\u30d7\u30dc\u30fc\u30c9\u3078\u30b3\u30d4\u30fc", "search.result.more.one": "\u3053\u306e\u30da\u30fc\u30b8\u5185\u306b\u3082\u30461\u4ef6\u898b\u3064\u304b\u308a\u307e\u3057\u305f", "search.result.more.other": "\u3053\u306e\u30da\u30fc\u30b8\u5185\u306b\u3042\u3068#\u4ef6\u898b\u3064\u304b\u308a\u307e\u3057\u305f", "search.result.none": "\u4f55\u3082\u898b\u3064\u304b\u308a\u307e\u305b\u3093\u3067\u3057\u305f", "search.result.one": "1\u4ef6\u898b\u3064\u304b\u308a\u307e\u3057\u305f", "search.result.other": "#\u4ef6\u898b\u3064\u304b\u308a\u307e\u3057\u305f", "search.result.placeholder": "\u691c\u7d22\u30ad\u30fc\u30ef\u30fc\u30c9\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044", "search.result.term.missing": "\u691c\u7d22\u306b\u542b\u307e\u308c\u306a\u3044", "select.version": "\u30d0\u30fc\u30b8\u30e7\u30f3\u5207\u308a\u66ff\u3048"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.60a45f97.min.js"></script>
      
        <script src="../../../javascripts/katex.js"></script>
      
        <script src="https://unpkg.com/katex@0/dist/katex.min.js"></script>
      
        <script src="https://unpkg.com/katex@0/dist/contrib/auto-render.min.js"></script>
      
    
  </body>
</html>