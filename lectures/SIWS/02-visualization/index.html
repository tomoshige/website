
<!doctype html>
<html lang="ja" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Statistics, Tomoshige Nakamura, Machine Learning, Juntendo University">
      
      
        <meta name="author" content="Tomoshige Nakamura">
      
      
        <link rel="canonical" href="https://tomoshige.github.io/website/lectures/SIWS/02-visualization/">
      
      
        <link rel="prev" href="../01-getting-started/">
      
      
        <link rel="next" href="../../SP/">
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.50">
    
    
      
        <title>2. Data Visualizaion - Statistical Learning Laboratory</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.a40c8224.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="https://unpkg.com/katex@0/dist/katex.min.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#_1" class="md-skip">
          コンテンツにスキップ
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="ヘッダー">
    <a href="../../.." title="Statistical Learning Laboratory" class="md-header__button md-logo" aria-label="Statistical Learning Laboratory" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Statistical Learning Laboratory
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              2. Data Visualizaion
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="検索" placeholder="検索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="検索">
        
        <button type="reset" class="md-search__icon md-icon" title="クリア" aria-label="クリア" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            検索を初期化
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://tomoshige.github.io/website" title="リポジトリへ" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    tomoshige/website
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="タブ" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../" class="md-tabs__link">
          
  
    
  
  Lectures

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../research/" class="md-tabs__link">
          
  
    
  
  Research

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="ナビゲーション" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Statistical Learning Laboratory" class="md-nav__button md-logo" aria-label="Statistical Learning Laboratory" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Statistical Learning Laboratory
  </label>
  
    <div class="md-nav__source">
      <a href="https://tomoshige.github.io/website" title="リポジトリへ" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    tomoshige/website
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Lectures
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Lectures
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../LA/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Linear algebra
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_2" id="__nav_2_2_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            Linear algebra
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../LA/00-vector-and-matrix/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Chapter 1 Vector and Matrix
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Data Science without syntax
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_3" id="__nav_2_3_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            Data Science without syntax
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../01-getting-started/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1. Getting-Started
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    2. Data Visualizaion
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    2. Data Visualizaion
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="目次">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目次
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      必要なライブラリ
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      グラフィックの基礎理論
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gapminder" class="md-nav__link">
    <span class="md-ellipsis">
      Gapminderデータの可視化
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Gapminderデータの可視化">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      データの準備
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      データの可視化
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../SP/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Statistics and Probability
  </span>
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4">
            <span class="md-nav__icon md-icon"></span>
            Statistics and Probability
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../research/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Research
  </span>
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Research
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="目次">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目次
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      必要なライブラリ
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      グラフィックの基礎理論
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gapminder" class="md-nav__link">
    <span class="md-ellipsis">
      Gapminderデータの可視化
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Gapminderデータの可視化">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      データの準備
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      データの可視化
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="_1">データの可視化</h1>
<p>データサイエンスのツールボックスを構築する最初のステップとして、データの可視化を学びます。データを視覚化することで、単なる数値の羅列では見えなかったパターンや傾向を発見できます。Pythonでは、<code>matplotlib</code> や <code>seaborn</code> を利用してデータを可視化できます。本章では、これらのライブラリを活用し、基本的なプロットを作成する方法を学びます。</p>
<p>グラフ（プロットやチャートとも呼びます）は、データのパターンを探るための強力な手法です。例えば、<strong>外れ値の特定</strong>、<strong>データの分布</strong>、<strong>変数間の関係性</strong>を理解するのに役立ちます。適切な可視化を行うことで、データから得られる洞察を効果的に伝えることができます。ただし、情報を詰め込みすぎると、かえって理解しにくくなることもあるため、適切なバランスを取ることが重要です。</p>
<hr />
<h2 id="_2">必要なライブラリ</h2>
<p>本章では、gapminderと呼ばれるデータセットを利用します。そのために、まずは以下のパッケージをインストールしてください。</p>
<pre><code class="language-python">!pip install gapminder
</code></pre>
<p>次に、必要なライブラリをインポートします。</p>
<pre><code class="language-python">import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns
from gapminder import gapminder
</code></pre>
<hr />
<h2 id="_3">グラフィックの基礎理論</h2>
<p>「グラフィックの文法（Grammar of Graphics）」とは、データの可視化を体系的に整理するための理論です。この概念は Leland Wilkinson によって提唱され、Rの <code>ggplot2</code> や Pythonの <code>plotly</code> などの可視化ライブラリにも応用されています。</p>
<p>この理論によると、統計グラフは次の3つの要素から構成されます。</p>
<ol>
<li><strong>データ (<code>data</code>)</strong>: 可視化の対象となるデータセット。</li>
<li><strong>幾何オブジェクト (<code>geom</code>)</strong>: グラフに描画される基本要素（点、線、棒など）。</li>
<li><strong>美的要素 (<code>aes</code>)</strong>: 幾何オブジェクトの見た目を決める要素（位置、色、大きさなど）。</li>
</ol>
<p>これらを組み合わせることで、データの可視化を構築できます。</p>
<hr />
<h2 id="gapminder">Gapminderデータの可視化</h2>
<p>Gapminderは、世界の経済・健康・発展状況に関するデータを提供するプロジェクトです。このデータセットには、各国のGDP、寿命、人口などの情報が含まれています。</p>
<h3 id="_4">データの準備</h3>
<p>まず、Gapminderデータを2007年のデータに絞り込んで表示してみましょう。</p>
<pre><code class="language-python"># 2007年のデータのみを取得
gapminder_2007 = gapminder[gapminder['year'] == 2007]

# 必要な列のみ選択
gapminder_2007 = gapminder_2007[['country', 'continent', 'lifeExp', 'pop', 'gdpPercap']]
gapminder_2007.columns = ['Country', 'Continent', 'Life Expectancy', 'Population', 'GDP per Capita']

# データの先頭を表示
gapminder_2007.head()
</code></pre>
<p>この表の各行は1つの国を表し、次の情報を含みます。</p>
<ol>
<li><strong>Country</strong>: 国の名前。</li>
<li><strong>Continent</strong>: 5つの大陸のいずれか（「Americas」は北米と南米を含み、南極は除外）。</li>
<li><strong>Life Expectancy</strong>: 平均寿命（年）。</li>
<li><strong>Population</strong>: 人口（人）。</li>
<li><strong>GDP per Capita</strong>: 1人当たりGDP（米ドル）。</li>
</ol>
<hr />
<h2 id="_5">データの可視化</h2>
<p>2007年のGDPと平均寿命の関係を可視化してみましょう。</p>
<pre><code class="language-python">plt.figure(figsize=(10, 6))

sns.scatterplot(
    data=gapminder_2007,
    x='GDP per Capita',
    y='Life Expectancy',
    size='Population',
    hue='Continent',
    sizes=(10, 200),
    alpha=0.7
)

plt.xscale('log')  # GDPは対数スケールに変換
plt.xlabel('GDP per Capita (log scale)')
plt.ylabel('Life Expectancy (years)')
plt.title('2007年におけるGDPと平均寿命の関係')
plt.legend(title='Continent', bbox_to_anchor=(1.05, 1), loc='upper left')
plt.show()
</code></pre>
<p>このとき、グラフのタイトルをみると、日本語が表示できていないことがわかりますね。これは、非常によく起きる問題です。pythonでは、これを以下のパッケージをインストールすることで解消することができます。</p>
<pre><code class="language-python">!pip install japanize-matplotlib
</code></pre>
<p>インストールした後で、最初の <code>import</code> 部分を次のように変更しましょう。</p>
<pre><code class="language-python">import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import japanize_matplotlib
import seaborn as sns
from gapminder import gapminder
</code></pre>
<p>これで日本語が表示されるはずです。次に、このプロットを詳しく見ていきましょう。</p>
<ul>
<li>変数 GDP per Capita（1人当たりGDP） は、x軸にマッピングされています。</li>
<li>変数 Life Expectancy（平均寿命） は、ポイントの y軸にマッピングされています。</li>
<li>変数 Population（人口） は、ポイントの サイズ（size aesthetic） にマッピングされます。</li>
<li>変数 Continent（大陸） は、ポイントの 色（color aesthetic） にマッピングされます。</li>
</ul>
<p>ここで、<code>data</code>（データ）とは pythonの <code>dataframe</code>に対応し、データ変数（data variables） がデータフレーム内の特定の列に対応していることが分かります。例えば、。特にこのプロットでは、4つの情報を同時に集約しています。x軸に一人あたりのGDP、y軸に平均寿命、さらに点の大きさで人口、そして、点の色で大陸を表しています。このプロットを通じて、以下の傾向が読み取れます。</p>
<ul>
<li>GDPが高い国ほど、平均寿命が長い傾向がある。</li>
<li>大陸ごとに分布が異なり、特にアフリカ（Africa）の国々はGDPと平均寿命が低い傾向がある。</li>
<li>国ごとの人口（点の大きさ）も視覚的に把握できる。</li>
</ul>
<p>このように自分が示したいものが何かということを意識して、適切な図を書くことは、データサイエンスの基本となるものです。また、データの種類によっても、最適な図の書き方は異なります。次のステップとして、データサイエンスにおける5つの基本的な図について学びましょう。</p>
<hr />
<h1 id="python-5-5ng">Pythonによるデータ可視化入門: 5つの代表的なグラフ (5NG)</h1>
<p>このテキストでは、Google Colaboratory上でPython、NumPy、Pandas、matplotlib、seabornを用いて、データ可視化の基本となる5種類のグラフ（5NG）を紹介します。ここでは、seabornに組み込まれている<strong>irisデータセット</strong>を例として使用します。</p>
<hr />
<h2 id="22-5-5ng">2.2 5つの代表的なグラフ – 5NG</h2>
<p>本書では、以下の5種類のグラフに注目します。これらは一般的に名前が付けられており、以降「5NG」と呼びます：</p>
<ul>
<li><strong>散布図 (scatterplots)</strong></li>
<li><strong>折れ線グラフ (linegraphs)</strong></li>
<li><strong>ヒストグラム (histograms)</strong></li>
<li><strong>箱ひげ図 (boxplots)</strong></li>
<li><strong>棒グラフ (barplots)</strong></li>
</ul>
<p>これらの基本的なグラフを覚えておくことで、さまざまな種類の変数を視覚的に表現する際に非常に役立ちます。なお、あるグラフはカテゴリカル変数に適しており、また別のグラフは数値変数に適しています。</p>
<hr />
<h2 id="23-5ng1-scatterplots">2.3 5NG#1: 散布図 (Scatterplots)</h2>
<p>散布図は、2つの数値変数間の関係性を視覚化する最も基本的なグラフです。ここでは、irisデータセットの以下の2つの数値変数の関係を散布図で表現します：</p>
<ul>
<li><strong>sepal_length</strong>：x軸</li>
<li><strong>petal_length</strong>：y軸</li>
</ul>
<h3 id="231">2.3.1 基本的な散布図の作成</h3>
<p>以下のコードは、irisデータセットを読み込み、<code>sepal_length</code> と <code>petal_length</code> の関係を散布図で可視化する例です。</p>
<pre><code class="language-python">import seaborn as sns
import matplotlib.pyplot as plt

# Irisデータセットの読み込み
iris = sns.load_dataset(&quot;iris&quot;)

# 基本的な散布図の作成
sns.scatterplot(data=iris, x=&quot;sepal_length&quot;, y=&quot;petal_length&quot;)
plt.title(&quot;Irisデータセット: sepal_lengthとpetal_lengthの散布図&quot;)
plt.xlabel(&quot;sepal_length&quot;)
plt.ylabel(&quot;petal_length&quot;)
plt.show()
</code></pre>
<p>このコードでは、sns.scatterplot 関数を用いて、irisデータセット内のsepal_length（x軸）とpetal_length（y軸）の各サンプルを点としてプロットしています。図では、各点が1つの花のサンプルを表しており、両変数間の関係性が視覚的に把握できます。</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>(LC2.1) IrisデータセットをPandasのDataFrameとして表示し、各変数（sepal_length, sepal_width, petal_length, petal_width, species）の型と内容を確認してみましょう。</p>
</div>
<h3 id="232">2.3.2 過剰なプロット（オーバープロッティング）への対処</h3>
<p>データ数が非常に多い場合、同じ位置に点が重なってしまい、実際にプロットされている点の数が分かりにくくなる「オーバープロッティング」が発生します。これに対処する方法は主に2つあります。</p>
<h4 id="1-alpha">方法1: 透明度 (alpha) の調整</h4>
<p>点の透明度を変更することで、重なった部分が濃く見えるようになり、点の密集度が視覚的に分かりやすくなります。以下は透明度を設定した散布図の例です。</p>
<p>python
コピーする
sns.scatterplot(data=iris, x="sepal_length", y="petal_length", alpha=0.5)
plt.title("透明度を調整した散布図 (alpha=0.5)")
plt.xlabel("sepal_length")
plt.ylabel("petal_length")
plt.show()
ここでは、alpha パラメータを0.5に設定することで、各点の不透明度が50%となり、重なっている部分はより濃く表示されます。</p>
<h4 id="2-jitter">方法2: ジッター (Jitter) の追加</h4>
<p>ジッターは、各点に小さなランダムなずれ（ノイズ）を加えて、同じ位置に重なって表示される点を少しずらす手法です。これにより、重なり合っている点が個別に見えるようになります。以下のコードはジッターを加えた散布図の例です。</p>
<pre><code class="language-python">import numpy as np

# ジッターの強さ（調整可能）
jitter_strength = 0.1

# sepal_lengthとpetal_lengthにランダムなノイズを加える
x_jittered = iris[&quot;sepal_length&quot;] + np.random.uniform(-jitter_strength, jitter_strength, size=len(iris))
y_jittered = iris[&quot;petal_length&quot;] + np.random.uniform(-jitter_strength, jitter_strength, size=len(iris))

plt.figure()
plt.scatter(x_jittered, y_jittered, alpha=0.7)
plt.title(&quot;ジッターを加えた散布図&quot;)
plt.xlabel(&quot;sepal_length (jittered)&quot;)
plt.ylabel(&quot;petal_length (jittered)&quot;)
plt.show()
</code></pre>
<p>この例では、np.random.uniform を用いて、各点に -0.1 から 0.1 の範囲のランダムな値を加えています。ジッターはあくまで視覚化のための手法であり、元のデータ自体は変更されません。</p>
<p>Learning Check</p>
<p>(LC2.2) 透明度（alpha）の設定が、重なり合う点の密集度をどのように表現するか考えてみましょう。
(LC2.3) ジッターによって点がわずかにずれると、元のデータのパターンはどのように変化するでしょうか？また、ジッターの強さはどのように調整するのが適切か検討してみてください。</p>
<h3 id="233">2.3.3 まとめ</h3>
<p>散布図は、2つの数値変数間の関係を直感的に把握するための基本的な可視化手法です。特にデータ量が多い場合、透明度の調整やジッターの追加といった工夫をすることで、重なり合ったデータ点の情報をより明確に伝えることができます。どの手法を用いるかは、データの特性や伝えたい内容に応じて判断する必要があります。</p>
<p>Learning Check</p>
<p>(LC2.4) 透明度の調整とジッターの追加、それぞれの手法のメリット・デメリットを比較してみましょう。
(LC2.5) Irisデータセット内の他の数値変数（例えば、sepal_widthやpetal_width）を用いて、別の散布図を作成し、得られるパターンの違いを観察してみてください。
このように、PythonとGoogle Colaboratoryを利用することで、RやRStudioで行っていたようなグラフィックスの基本操作を手軽に再現し、さまざまな手法でデータの特徴を明らかにすることが可能です。次のセクションでは、折れ線グラフ、ヒストグラム、箱ひげ図、棒グラフの作成方法についても見ていきましょう。</p>
<h2 id="5ng2-linegraphs">5NG#2: 折れ線グラフ (Linegraphs)</h2>
<p>折れ線グラフは、x軸に順序性（特に時間などの連続的な情報）がある場合に、2つの数値変数間の関係を視覚化するためのグラフです。隣接するデータ点を線で結ぶことで、時系列データの変化やトレンドを明確に示すことができます。</p>
<p>ここでは、seabornに組み込まれている<strong>flights</strong>データセットを使用して、1949年から1960年までの月ごとの乗客数の推移を折れ線グラフで可視化する方法について説明します。<br />
flightsデータセットは、以下の変数を含んでいます：</p>
<ul>
<li><strong>year</strong>: 年（1949～1960）</li>
<li><strong>month</strong>: 月（"Jan", "Feb", …, "Dec" といった文字列）</li>
<li><strong>passengers</strong>: 各月の乗客数</li>
</ul>
<h3 id="flights">flightsデータの準備と日時変数の作成</h3>
<p>折れ線グラフを作成する際には、x軸に順序性のある変数（ここでは日時）が必要です。<br />
flightsデータセットでは、<code>year</code> と <code>month</code> の2つの変数から日時情報を作成する必要があります。以下のコードでは、Pandasを用いてこれらの変数を組み合わせ、<code>date</code> という新しい日時型の変数を作成します。</p>
<pre><code class="language-python">import pandas as pd
import seaborn as sns
import matplotlib.pyplot as plt

# flightsデータセットの読み込み
flights = sns.load_dataset(&quot;flights&quot;)
print(flights.head())

# yearとmonthからdatetime型の変数を作成
# flightsデータセットのmonth列は &quot;Jan&quot;, &quot;Feb&quot;, ... の形式のため、'%Y-%b' を指定
flights['date'] = pd.to_datetime(flights['year'].astype(str) + '-' + flights['month'], format='%Y-%b')
print(flights.head())
</code></pre>
<h3 id="_6">折れ線グラフの作成</h3>
<p>作成したdate変数をx軸、passengers変数をy軸として、seabornのlineplot()関数を使い折れ線グラフを描いてみます。以下のコードでは、図のサイズを調整し、タイトルや軸ラベルを設定しています。</p>
<pre><code class="language-python">plt.figure(figsize=(12,6))
sns.lineplot(data=flights, x=&quot;date&quot;, y=&quot;passengers&quot;)
plt.title(&quot;1949年～1960年の月ごとの乗客数の推移&quot;)
plt.xlabel(&quot;日付&quot;)
plt.ylabel(&quot;乗客数&quot;)
plt.show()
</code></pre>
<p>このコードでは、date（日時型の変数）に沿ってpassengers（乗客数）の各データ点を線で結んでいます。日時の順序が保たれるため、連続したデータの変化を直感的に把握することができます。</p>
<h3 id="_7">チェック項目</h3>
<p>(LC1) flightsデータセットのmonth列はどのような形式になっていますか？また、なぜyearとmonthを組み合わせて日時型の変数を作成する必要があるのでしょうか？
(LC2) 折れ線グラフでデータ点を線で結ぶことは、どのような情報（例：傾向や変化の方向性）を視覚的に伝えるのでしょうか？
(LC3) 他の時系列データ（例：ある都市の月別平均気温など）において、同様の方法で折れ線グラフを作成することは可能でしょうか？その場合、どのような点に注意すべきでしょうか？</p>
<h3 id="_8">まとめ</h3>
<p>折れ線グラフは、時間や順序性のある変数をx軸にとることで、連続したデータの変化を効果的に表現できます。
ここでは、seabornのflightsデータセットを使用し、year と month から作成した日時型の変数を用いて、1949年から1960年までの月ごとの乗客数の推移を線グラフで可視化しました。
この手法は、時系列データの分析やトレンドの把握に非常に有用です。</p>
<h2 id="5ng3-histograms">5NG#3: ヒストグラム (Histograms)</h2>
<p>ヒストグラムは、1つの数値変数の分布を視覚化するためのグラフです。  ここでは、seaborn に組み込まれている <strong>titanic</strong> データセットを用い、乗客の <strong>age</strong>（年齢）の分布に注目します。  ヒストグラムを使うことで、以下のような点を確認できます。</p>
<ol>
<li>最小値と最大値はどこか？</li>
<li>中心や「最も典型的な」値はどこか？</li>
<li>値の広がりはどの程度か？</li>
<li>頻出値と稀な値はどこか？</li>
</ol>
<hr />
<h3 id="1">1. 分布の概要を視覚化する</h3>
<p>まず、年齢の各観測値を横一列に並べたプロットを作成して、分布の大まかな様子を確認してみます。<br />
（このプロットは、後述するヒストグラムと比べるとオーバープロットが発生するため、細かい頻度は読み取りにくいですが、全体の広がりを直感的に把握するのに役立ちます。）</p>
<pre><code class="language-python">import seaborn as sns
import matplotlib.pyplot as plt

# titanicデータセットの読み込み
titanic = sns.load_dataset(&quot;titanic&quot;)

# NaNの除外（age列には欠損値が含まれています）
titanic_age = titanic.dropna(subset=[&quot;age&quot;])

# 各年齢の値を横一列に並べる（y座標は固定値）
plt.figure(figsize=(10, 1))
sns.stripplot(x=&quot;age&quot;, data=titanic_age, jitter=False, color=&quot;gray&quot;)
plt.xlabel(&quot;Age&quot;)
plt.yticks([])  # y軸の目盛りを非表示に
plt.title(&quot;Titanicデータセット：乗客の年齢の散布図（横一列）&quot;)
plt.show()
</code></pre>
<p>このプロットでは、各点が個々の乗客の年齢を示しており、年齢の分布の概形を把握できます。
ただし、多くの点が重なって表示されるため、細かい頻度は見えにくいです。</p>
<h3 id="2">2. ヒストグラムの作成</h3>
<p>ヒストグラムでは、x軸（ここでは年齢）をいくつかの「ビン」（区間）に分割し、各区間に含まれる観測値の数（度数）を棒グラフで示します。以下のコードは、デフォルト設定で年齢のヒストグラムを作成する例です。</p>
<pre><code class="language-python">plt.figure(figsize=(10,6))
sns.histplot(data=titanic_age, x=&quot;age&quot;)
plt.title(&quot;Titanicデータセット：乗客の年齢のヒストグラム (デフォルト設定)&quot;)
plt.xlabel(&quot;Age&quot;)
plt.ylabel(&quot;Count&quot;)
plt.show()
</code></pre>
<p>このプロットでは、seaborn が自動的に30個程度のビンに分割してヒストグラムを描画しています。ただし、ビンの数が多すぎる場合、各ビンの幅が狭くなり、分布が「ごちゃごちゃ」して見えることがあります。</p>
<h3 id="3">3. ビンの調整</h3>
<p>ヒストグラムの解釈を容易にするために、ビンの数や幅を調整することができます。以下に、ビンの数とビン幅を変更した例を示します。</p>
<h4 id="1_1">(1) ビンの数を指定する方法</h4>
<p>ここでは、bins=20 としてビンの数を20に指定しています。
また、edgecolor="white" を設定することで、各ビンの境界線を白色にし、区切りを明確にしています。</p>
<pre><code class="language-python">plt.figure(figsize=(10,6))
sns.histplot(data=titanic_age, x=&quot;age&quot;, bins=20, color=&quot;steelblue&quot;, edgecolor=&quot;white&quot;)
plt.title(&quot;Titanicデータセット：乗客の年齢のヒストグラム (20ビン)&quot;)
plt.xlabel(&quot;Age&quot;)
plt.ylabel(&quot;Count&quot;)
plt.show()
</code></pre>
<h4 id="2_1">(2) ビン幅を指定する方法</h4>
<p>seaborn の histplot() では、binwidth 引数を使って各ビンの幅を直接指定することも可能です。たとえば、ビン幅を5歳に設定する場合は次のようになります。</p>
<pre><code class="language-python">plt.figure(figsize=(10,6))
sns.histplot(data=titanic_age, x=&quot;age&quot;, binwidth=5, color=&quot;steelblue&quot;, edgecolor=&quot;white&quot;)
plt.title(&quot;Titanicデータセット：乗客の年齢のヒストグラム (ビン幅=5)&quot;)
plt.xlabel(&quot;Age&quot;)
plt.ylabel(&quot;Count&quot;)
plt.show()
</code></pre>
<p>この例では、年齢が5歳刻みで区切られ、各区間における乗客数が表示されます。</p>
<h3 id="4-faceting">4. Faceting（ファセット）による分割表示</h3>
<p>ファセットは、ある変数の値ごとに同じ種類のプロットを複数描画し、比較しやすくする手法です。
ここでは、sex（性別）によって乗客の年齢のヒストグラムを分割して表示してみます。</p>
<pre><code class="language-python"># seaborn の displot() は、ヒストグラムのファセット表示に適しています
sns.displot(data=titanic_age, x=&quot;age&quot;, bins=20, color=&quot;steelblue&quot;, edgecolor=&quot;white&quot;, col=&quot;sex&quot;, height=4, aspect=1.2)
plt.suptitle(&quot;Titanicデータセット：性別ごとの乗客の年齢のヒストグラム&quot;, y=1.03)
plt.show()
</code></pre>
<p>このコードでは、col="sex" により、性別（male と female）ごとに別々のヒストグラムが描画され、各グループ内で年齢の分布を比較できます。</p>
<h3 id="_9">チェック項目</h3>
<ul>
<li>
<p>(LC1) titanic データセットにおける age 変数の最小値、最大値、中央値はそれぞれどの程度か調べてみましょう。
（例: titanic_age["age"].describe() を用いて確認できます）</p>
</li>
<li>
<p>(LC2) ヒストグラムでビンの数や幅を変更すると、分布の解釈にどのような影響があるか考えてみましょう。
（例: ビンの数を増やすと細部が見えやすくなる一方、ノイズが目立つ可能性があります）</p>
</li>
<li>
<p>(LC3) 性別（sex）ごとに年齢の分布が異なる理由について、データや歴史的背景から考察してみましょう。</p>
</li>
</ul>
<h3 id="_10">まとめ</h3>
<p>ヒストグラムは、1つの数値変数の分布（最小値、最大値、中心、散らばり、頻出値など）を視覚化するための有効なツールです。ここでは、seaborn の titanic データセットの age 変数を例に、基本のヒストグラムの作成、ビンの調整方法、さらにファセットを用いたグループ別比較の方法を示しました。これらの手法を用いることで、データの特徴や潜在的なパターンを直感的に理解することができます。</p>
<h2 id="5ng4-boxplots">5NG#4: 箱ひげ図 (Boxplots)</h2>
<p>箱ひげ図は、数値変数の<strong>五数要約</strong>（最小値、第1四分位数、中央値、第3四分位数、最大値）に基づいて、データの分布を視覚化する手法です。<br />
ここでは、seaborn の <strong>tips</strong> データセットを用い、飲食代（<code>total_bill</code>）の分布を例に箱ひげ図の作成方法と解釈について説明します。</p>
<hr />
<h3 id="1_2">1. 特定グループにおける五数要約の確認</h3>
<p>まず、tips データセットからディナータイム（<code>time</code> が <code>"Dinner"</code>）のデータに注目し、その <code>total_bill</code> の五数要約を算出します。</p>
<pre><code class="language-python">import pandas as pd
import seaborn as sns
import matplotlib.pyplot as plt

# tips データセットの読み込み
tips = sns.load_dataset(&quot;tips&quot;)

# ディナータイムのデータに絞る
dinner_tips = tips[tips[&quot;time&quot;] == &quot;Dinner&quot;]

# ディナータイムの total_bill に対する五数要約の計算
n_dinner = dinner_tips.shape[0]
min_dinner = dinner_tips[&quot;total_bill&quot;].min()
max_dinner = dinner_tips[&quot;total_bill&quot;].max()
quartiles = dinner_tips[&quot;total_bill&quot;].quantile([0.25, 0.5, 0.75])
five_number_summary = pd.DataFrame({
    &quot;total_bill&quot;: [min_dinner, quartiles.iloc[0], quartiles.iloc[1], quartiles.iloc[2], max_dinner]
}, index=[&quot;Min&quot;, &quot;25%&quot;, &quot;50%&quot;, &quot;75%&quot;, &quot;Max&quot;])

print(&quot;ディナータイムの total_bill の五数要約:&quot;)
print(five_number_summary)
</code></pre>
<p>このコードを実行すると、ディナータイムにおける total_bill の最小値、第一四分位数、中央値、第三四分位数、最大値が得られます。</p>
<h3 id="_11">箱ひげ図作成の段階的な構築</h3>
<p>以下では、ディナータイムの total_bill の観測値を対象に、3種類のプロットを段階的に作成していきます。</p>
<p>(a) ジッターを加えたプロットと五数要約の値の表示
まず、各観測値をジッター（わずかな横方向のずれ）を付与してプロットし、さらに五数要約の各値を赤の破線で示します。</p>
<pre><code class="language-python"># サブプロットの作成（横に3つ並べる）
fig, axes = plt.subplots(1, 3, figsize=(15, 4), sharey=True)

# プロットの基本設定：x 軸は &quot;Dinner&quot; の固定値
x_value = [&quot;Dinner&quot;] * n_dinner

# (a) ジッターを加えた点のプロット
sns.stripplot(x=dinner_tips[&quot;time&quot;], y=dinner_tips[&quot;total_bill&quot;],
              jitter=True, ax=axes[0], color=&quot;gray&quot;, alpha=0.3)
axes[0].set_title(&quot;ジッター付き点と\n五数要約の破線&quot;)
axes[0].set_xlabel(&quot;&quot;)
axes[0].set_ylabel(&quot;Total Bill&quot;)

# 五数要約の各値を破線で追加
for value in five_number_summary[&quot;total_bill&quot;]:
    axes[0].axhline(y=value, color='red', linestyle='--', linewidth=1.0)

# (b) 箱ひげ図とジッター付き点、さらに破線による五数要約の表示
sns.boxplot(x=&quot;time&quot;, y=&quot;total_bill&quot;, data=dinner_tips, ax=axes[1],
            showcaps=True, boxprops={'facecolor':'None'})
sns.stripplot(x=&quot;time&quot;, y=&quot;total_bill&quot;, data=dinner_tips,
              jitter=True, ax=axes[1], color=&quot;gray&quot;, alpha=0.3)
for value in five_number_summary[&quot;total_bill&quot;]:
    axes[1].axhline(y=value, color='red', linestyle='--', linewidth=1.0)
axes[1].set_title(&quot;箱ひげ図 + ジッター付き点&quot;)
axes[1].set_xlabel(&quot;&quot;)
axes[1].set_ylabel(&quot;&quot;)

# (c) 箱ひげ図のみ（余計な点や破線は除去）
sns.boxplot(x=&quot;time&quot;, y=&quot;total_bill&quot;, data=dinner_tips, ax=axes[2])
axes[2].set_title(&quot;箱ひげ図のみ&quot;)
axes[2].set_xlabel(&quot;&quot;)
axes[2].set_ylabel(&quot;&quot;)

plt.tight_layout()
plt.show()
</code></pre>
<ul>
<li>左のプロットでは、ディナータイムの各 total_bill の観測値がジッター付きの点として表示され、赤い破線で五数要約の位置が示されています。</li>
<li>中央のプロットでは、箱ひげ図が描画されると同時に、ジッター付きの点と破線も重ねられています。</li>
<li>右のプロットは、純粋な箱ひげ図のみで、余計な要素が除去されています。</li>
</ul>
<p>箱ひげ図は、箱の上下がそれぞれ第一四分位数（25%）と第三四分位数（75%）を示し、箱内の太い線が中央値（50%）を示します。箱の高さは四分位範囲 (IQR) を表し、上下の「ひげ」は通常、箱から 1.5 × IQR の範囲内の最小値・最大値まで伸び、範囲外の観測値は個別の点（アウトライヤー）として表示されます。</p>
<h3 id="_12">複数グループにおける箱ひげ図の作成</h3>
<p>次に、tips データセット全体を用いて、曜日（day）ごとに total_bill の分布を比較するための サイドバイサイド箱ひげ図 を作成します。
tips データセットの day 変数は既にカテゴリカル変数（"Thur", "Fri", "Sat", "Sun"）となっているため、x 軸に直接割り当てることができます。</p>
<pre><code class="language-python">plt.figure(figsize=(8, 6))
sns.boxplot(x=&quot;day&quot;, y=&quot;total_bill&quot;, data=tips,
            palette=&quot;pastel&quot;, showcaps=True, 
            boxprops={'edgecolor':'black'},
            whiskerprops={'color':'black'},
            capprops={'color':'black'},
            flierprops={'markerfacecolor':'red', 'marker':'o', 'markersize':5})
plt.title(&quot;Tipsデータセット：曜日ごとの Total Bill の箱ひげ図&quot;)
plt.xlabel(&quot;Day&quot;)
plt.ylabel(&quot;Total Bill&quot;)
plt.show()
</code></pre>
<p>このプロットでは、各曜日ごとに total_bill の箱ひげ図が描画され、</p>
<ul>
<li>箱は第一四分位数、中央値、第三四分位数を示し、</li>
<li>ひげは 1.5×IQR の範囲内の値を表し、</li>
<li>その範囲外の値はアウトライヤーとして赤い点で示されています。</li>
</ul>
<p>曜日ごとの箱ひげ図を並べることで、各グループ間の分布の違いやばらつき、さらには外れ値の有無を簡単に比較することができます。</p>
<h3 id="_13">チェック項目</h3>
<ul>
<li>(LC1) ディナータイムの total_bill の五数要約を確認したとき、各値（最小値、第一四分位数、中央値、第三四分位数、最大値）はどのような数値になっていますか？</li>
<li>(LC2) 箱ひげ図における箱の高さ（IQR）が大きい場合、どのような情報が得られますか？</li>
<li>(LC3) アウトライヤー（箱ひげ図上の点）が示す意味は何でしょうか？また、アウトライヤーが多い場合、どのような解釈が可能でしょうか？</li>
<li>(LC4) 曜日ごとの箱ひげ図を比較することで、どの曜日で飲食代のばらつきが大きいか、また中央値に違いがあるかをどのように読み取れますか？</li>
</ul>
<h3 id="_14">まとめ</h3>
<p>箱ひげ図は、単一の数値変数の分布を視覚化する強力なツールであり、</p>
<ul>
<li>中央値 や 四分位数 を直感的に把握でき、</li>
<li>四分位範囲（IQR） による散らばりの度合いを示し、</li>
<li>アウトライヤー（外れ値）を容易に特定することができます。</li>
</ul>
<p>また、カテゴリカル変数（例：曜日）に対してサイドバイサイドで箱ひげ図を作成することで、グループ間の分布の違いやばらつきを比較することが可能です。tips データセットを例に、ディナータイムの total_bill や曜日ごとの total_bill を通じて、箱ひげ図の作成とその解釈の基本を確認しました。</p>
<h2 id="5ng5-barplots-geombar">5NG#5: Barplots {#geombar}</h2>
<p>Both histograms and boxplots are tools to visualize the distribution of numerical variables. Another commonly desired task is to visualize the distribution of a categorical variable. This is a simpler task, as we are simply counting different categories within a categorical variable, also known as the \index{levels} <em>levels</em> of the categorical variable. Often the best way to visualize these different counts, also known as \index{frequencies} <em>frequencies</em>, is with barplots (also called barcharts).</p>
<p>One complication, however, is how your data is represented. Is the categorical variable of interest "pre-counted" or not? For example, run the following code that manually creates two data frames representing a collection of fruit: 3 apples and 2 oranges.</p>
<pre><code>fruits &lt;- tibble(
  fruit = c(&quot;apple&quot;, &quot;apple&quot;, &quot;orange&quot;, &quot;apple&quot;, &quot;orange&quot;)
)
fruits_counted &lt;- tibble(
  fruit = c(&quot;apple&quot;, &quot;orange&quot;),
  number = c(3, 2)
)
</code></pre>
<p>We see both the <code>fruits</code> and <code>fruits_counted</code> data frames represent the same collection of fruit. Whereas <code>fruits</code> just lists the fruit individually...</p>
<pre><code>fruits
</code></pre>
<p>... <code>fruits_counted</code> has a variable <code>count</code> which represent the "pre-counted" values of each fruit. </p>
<pre><code>fruits_counted
</code></pre>
<p>Depending on how your categorical data is represented, you'll need to add a different <code>geom</code>etric layer type to your <code>ggplot()</code> to create a barplot, as we now explore. </p>
<h3 id="barplots-via-geom_bar-or-geom_col">Barplots via <code>geom_bar</code> or <code>geom_col</code></h3>
<p>Let's generate barplots using these two different representations of the same basket of fruit: 3 apples and 2 oranges. Using the <code>fruits</code> data frame where all 5 fruits are listed individually in 5 rows, we map the <code>fruit</code> variable to the x-position aesthetic and add a \index{ggplot2!geom_bar()} <code>geom_bar()</code> layer:</p>
<pre><code>ggplot(data = fruits, mapping = aes(x = fruit)) +
  geom_bar()
</code></pre>
<p>However, using the <code>fruits_counted</code> data frame where the fruits have been "pre-counted", we once again map the <code>fruit</code> variable to the x-position aesthetic, but here we also map the <code>count</code> variable to the y-position aesthetic, and add a \index{ggplot2!geom_col()} <code>geom_col()</code> layer instead.</p>
<pre><code>ggplot(data = fruits_counted, mapping = aes(x = fruit, y = number)) +
  geom_col()
</code></pre>
<p>Compare the barplots in Figures \@ref(fig:geombar) and \@ref(fig:geomcol). They are identical because they reflect counts of the same five fruits. However, depending on how our categorical data is represented, either "pre-counted" or not, we must add a different <code>geom</code> layer. When the categorical variable whose distribution you want to visualize</p>
<ul>
<li>Is <em>not</em> pre-counted in your data frame, we use <code>geom_bar()</code>.</li>
<li>Is pre-counted in your data frame, we use <code>geom_col()</code> with the y-position aesthetic mapped to the variable that has the counts.</li>
</ul>
<p>Let's now go back to the <code>flights</code> data frame in the <code>nycflights13</code> package and visualize the distribution of the categorical variable <code>carrier</code>. In other words, let's visualize the number of domestic flights out of New York City each airline company flew in 2013. Recall from Subsection \@ref(exploredataframes) when you first explored the <code>flights</code> data frame, you saw that each row corresponds to a flight. In other words, the <code>flights</code> data frame is more like the <code>fruits</code> data frame than the <code>fruits_counted</code> data frame because the flights have not been pre-counted by <code>carrier</code>. Thus we should use <code>geom_bar()</code> instead of <code>geom_col()</code> to create a barplot. Much like a <code>geom_histogram()</code>, there is only one variable in the <code>aes()</code> aesthetic mapping: the variable <code>carrier</code> gets mapped to the <code>x</code>-position. As a difference though, histograms have bars that touch whereas bar graphs have white space between the bars going from left to right.</p>
<p>(ref:geombar) Number of flights departing NYC in 2013 by airline using geom_bar().</p>
<pre><code>ggplot(data = flights, mapping = aes(x = carrier)) +
  geom_bar()
</code></pre>
<p>Observe in Figure \@ref(fig:flightsbar) that United Airlines (UA), JetBlue Airways (B6), and ExpressJet Airlines (EV) had the most flights depart NYC in 2013. If you don't know which airlines correspond to which carrier codes, then run <code>View(airlines)</code> to see a directory of airlines. For example, B6 is JetBlue Airways. Alternatively, say you had a data frame where the number of flights for each <code>carrier</code> was pre-counted as in Table \@ref(tab:flights-counted).</p>
<pre><code>flights_counted &lt;- flights %&gt;%
  group_by(carrier) %&gt;%
  summarize(number = n())
kbl(flights_counted,
  digits = 3,
  caption = &quot;Number of flights pre-counted for each carrier&quot;,
  booktabs = TRUE,
  longtable = TRUE,
  linesep = &quot;&quot;
) %&gt;%
  kable_styling(
    font_size = ifelse(is_latex_output(), 10, 16),
    latex_options = c(&quot;hold_position&quot;)
  )
</code></pre>
<p>In order to create a barplot visualizing the distribution of the categorical variable <code>carrier</code> in this case, we would now use <code>geom_col()</code> instead of <code>geom_bar()</code>, with an additional <code>y = number</code> in the aesthetic mapping on top of the <code>x = carrier</code>. The resulting barplot would be identical to Figure \@ref(fig:flightsbar).</p>
<pre><code>\vspace{-0.15in}
**_Learning check_**
\vspace{-0.1in}
</code></pre>
<p><strong><code>r paste0("(LC", chap, ".", (lc &lt;- lc + 1), ")")</code></strong> Why are histograms inappropriate for categorical variables?</p>
<p><strong><code>r paste0("(LC", chap, ".", (lc &lt;- lc + 1), ")")</code></strong> What is the difference between histograms and barplots?</p>
<p><strong><code>r paste0("(LC", chap, ".", (lc &lt;- lc + 1), ")")</code></strong> How many Envoy Air flights departed NYC in 2013?</p>
<p><strong><code>r paste0("(LC", chap, ".", (lc &lt;- lc + 1), ")")</code></strong> What was the 7th highest airline for departed flights from NYC in 2013? How could we better present the table to get this answer quickly?</p>
<pre><code>\vspace{-0.25in}
\vspace{-0.25in}
</code></pre>
<h3 id="must-avoid-pie-charts">Must avoid pie charts!</h3>
<p>One of the most common plots used to visualize the distribution of categorical data is the \index{pie charts} pie chart. While they may seem harmless enough, pie charts actually present a problem in that humans are unable to judge angles well. As Naomi Robbins describes in her book, <em>Creating More Effective Graphs</em> [@robbins2013], we overestimate angles greater than 90 degrees and we underestimate angles less than 90 degrees. In other words, it is difficult for us to determine the relative size of one piece of the pie compared to another.  </p>
<p>Let's examine the same data used in our previous barplot of the number of flights departing NYC by airline in Figure \@ref(fig:flightsbar), but this time we will use a pie chart in Figure \@ref(fig:carrierpie). Try to answer the following questions:</p>
<ul>
<li>How much larger is the portion of the pie for ExpressJet Airlines (<code>EV</code>)  compared to US Airways (<code>US</code>)? </li>
<li>What is the third largest carrier in terms of departing flights?</li>
<li>How many carriers have fewer flights than United Airlines (<code>UA</code>)?</li>
</ul>
<pre><code>if (is_html_output()) {
  ggplot(flights, mapping = aes(x = factor(1), fill = carrier)) +
    geom_bar(width = 1) +
    coord_polar(theta = &quot;y&quot;) +
    theme(
      axis.title.x = element_blank(),
      axis.title.y = element_blank(),
      axis.ticks = element_blank(),
      axis.text.y = element_blank(),
      axis.text.x = element_blank(),
      panel.grid.major = element_blank(),
      panel.grid.minor = element_blank()
    ) +
    guides(fill = guide_legend(keywidth = 0.8, keyheight = 0.8))
} else {
  ggplot(flights, mapping = aes(x = factor(1), fill = carrier)) +
    geom_bar(width = 1) +
    coord_polar(theta = &quot;y&quot;) +
    theme_light() +
    theme(
      axis.title.x = element_blank(),
      axis.title.y = element_blank(),
      axis.ticks = element_blank(),
      axis.text.y = element_blank(),
      axis.text.x = element_blank(),
      panel.grid.major = element_blank(),
      panel.grid.minor = element_blank()
    ) +
    guides(fill = guide_legend(keywidth = 0.8, keyheight = 0.8)) +
    scale_fill_grey()
}
</code></pre>
<p>While it is quite difficult to answer these questions when looking at the pie chart in Figure \@ref(fig:carrierpie), we can much more easily answer these questions using the barchart in Figure \@ref(fig:flightsbar). This is true since barplots present the information in a way such that comparisons between categories can be made with single horizontal lines, whereas pie charts present the information in a way such that comparisons must be made by \index{pie charts!problems with} comparing angles. </p>
<pre><code>\vspace{-0.15in}
**_Learning check_**
\vspace{-0.1in}
</code></pre>
<p><strong><code>r paste0("(LC", chap, ".", (lc &lt;- lc + 1), ")")</code></strong> Why should pie charts be avoided and replaced by barplots?</p>
<p><strong><code>r paste0("(LC", chap, ".", (lc &lt;- lc + 1), ")")</code></strong> Why do you think people continue to use pie charts?</p>
<pre><code>\vspace{-0.25in}
\vspace{-0.25in}
</code></pre>
<h3 id="two-categorical-variables-two-categ-barplot">Two categorical variables {#two-categ-barplot}</h3>
<p>Barplots are a very common way to visualize the frequency of different categories, or levels, of a single categorical variable. Another use of barplots is to visualize the <em>joint</em> distribution of two categorical variables at the same time.  Let's examine the <em>joint</em> distribution of outgoing domestic flights from NYC by <code>carrier</code> as well as <code>origin</code>. In other words, the number of flights for each <code>carrier</code> and <code>origin</code> combination. </p>
<p>For example, the number of WestJet flights from <code>JFK</code>, the number of WestJet flights from <code>LGA</code>, the number of WestJet flights from <code>EWR</code>, the number of American Airlines flights from <code>JFK</code>, and so on. Recall the <code>ggplot()</code> code that created the barplot of <code>carrier</code> frequency in Figure \@ref(fig:flightsbar):</p>
<pre><code>ggplot(data = flights, mapping = aes(x = carrier)) + 
  geom_bar()
</code></pre>
<p>We can now map the additional variable <code>origin</code> by adding a <code>fill = origin</code> inside the <code>aes()</code> aesthetic mapping.</p>
<pre><code>ggplot(data = flights, mapping = aes(x = carrier, fill = origin)) +
  geom_bar()
</code></pre>
<pre><code>if (is_html_output()) {
  ggplot(data = flights, mapping = aes(x = carrier, fill = origin)) +
    geom_bar()
} else {
  ggplot(data = flights, mapping = aes(x = carrier, fill = origin)) +
    geom_bar() +
    scale_fill_grey()
}
</code></pre>
<p>Figure \@ref(fig:flights-stacked-bar) is an example of a \index{barplot!stacked} <em>stacked barplot</em>.  While simple to make, in certain aspects it is not ideal. For example, it is difficult to compare the heights of the different colors between the bars, corresponding to comparing the number of flights from each <code>origin</code> airport between the carriers.</p>
<p>Before we continue, let's address some common points of confusion among new R users. First, the <code>fill</code> aesthetic corresponds to the color used to fill the bars, while the <code>color</code> aesthetic corresponds to the color of the outline of the bars. This is identical to how we added color to our histogram in Subsection \@ref(geomhistogram): we set the outline of the bars to white by setting <code>color = "white"</code> and the colors of the bars to blue steel by setting <code>fill = "steelblue"</code>. Observe in Figure \@ref(fig:flights-stacked-bar-color) that mapping <code>origin</code> to <code>color</code> and not <code>fill</code> yields grey bars with different colored outlines.</p>
<pre><code>ggplot(data = flights, mapping = aes(x = carrier, color = origin)) +
  geom_bar()
</code></pre>
<pre><code>if (is_html_output()) {
  ggplot(data = flights, mapping = aes(x = carrier, color = origin)) +
    geom_bar()
} else {
  ggplot(data = flights, mapping = aes(x = carrier, color = origin)) +
    geom_bar() +
    scale_color_grey()
}
</code></pre>
<p>Second, note that <code>fill</code> is another aesthetic mapping much like <code>x</code>-position; thus we were careful to include it within the parentheses of the <code>aes()</code> mapping. The following code, where the <code>fill</code> aesthetic is specified outside the <code>aes()</code> mapping will yield an error. This is a fairly common error that new <code>ggplot</code> users make:</p>
<pre><code>ggplot(data = flights, mapping = aes(x = carrier), fill = origin) +
  geom_bar()
</code></pre>
<p>An alternative to stacked barplots are \index{barplot!side-by-side} <em>side-by-side barplots</em>, also known as <em>dodged barplots</em>, as seen in Figure \@ref(fig:flights-dodged-bar-color). The code to create a side-by-side barplot is identical to the code to create a stacked barplot, but with a \index{ggplot2!position} <code>position = "dodge"</code> argument added to <code>geom_bar()</code>. In other words, we are overriding the default barplot type, which is a <em>stacked</em> barplot, and specifying it to be a side-by-side barplot instead.</p>
<pre><code>ggplot(data = flights, mapping = aes(x = carrier, fill = origin)) +
  geom_bar(position = &quot;dodge&quot;)
</code></pre>
<pre><code>if (is_html_output()) {
  ggplot(data = flights, mapping = aes(x = carrier, fill = origin)) +
    geom_bar(position = &quot;dodge&quot;)
} else {
  ggplot(data = flights, mapping = aes(x = carrier, fill = origin)) +
    geom_bar(position = &quot;dodge&quot;) +
    scale_fill_grey()
}
</code></pre>
<p>Note the width of the bars for <code>AS</code>, <code>F9</code>, <code>FL</code>, <code>HA</code> and <code>YV</code> is different than the others. We can make one tweak to the <code>position</code> argument to get them to be the same size in terms of width as the other bars by using the more robust <code>position_dodge()</code> function.</p>
<pre><code>ggplot(data = flights, mapping = aes(x = carrier, fill = origin)) +
  geom_bar(position = position_dodge(preserve = &quot;single&quot;))
</code></pre>
<pre><code>if (is_html_output()) {
  ggplot(data = flights, mapping = aes(x = carrier, fill = origin)) +
    geom_bar(position = position_dodge(preserve = &quot;single&quot;))
} else {
  ggplot(data = flights, mapping = aes(x = carrier, fill = origin)) +
    geom_bar(position = position_dodge(preserve = &quot;single&quot;)) +
    scale_fill_grey()
}
</code></pre>
<p>Lastly, another type of barplot is a \index{barplot!faceted} <em>faceted barplot</em>. Recall in Section \@ref(facets) we visualized the distribution of hourly temperatures at the 3 NYC airports <em>split</em> by month using facets. We apply the same principle to our barplot visualizing the frequency of <code>carrier</code> split by <code>origin</code>: instead of mapping <code>origin</code> to <code>fill</code> we include it as the variable to create small multiples of the plot across the levels of <code>origin</code>.</p>
<pre><code>ggplot(data = flights, mapping = aes(x = carrier)) +
  geom_bar() +
  facet_wrap(~ origin, ncol = 1)
</code></pre>
<pre><code>month_facet_ncol &lt;- ggplot(data = flights, mapping = aes(x = carrier)) +
  geom_bar() +
  facet_wrap(~origin, ncol = 1)

if (is_latex_output()) {
  month_facet_ncol +
    theme(
      strip.text = element_text(colour = &quot;black&quot;),
      strip.background = element_rect(fill = &quot;grey93&quot;)
    )
} else {
  month_facet_ncol
}
</code></pre>
<pre><code>\vspace{-0.15in}
**_Learning check_**
\vspace{-0.1in}
</code></pre>
<p><strong><code>r paste0("(LC", chap, ".", (lc &lt;- lc + 1), ")")</code></strong> What kinds of questions are not easily answered by looking at Figure \@ref(fig:flights-stacked-bar)?</p>
<p><strong><code>r paste0("(LC", chap, ".", (lc &lt;- lc + 1), ")")</code></strong> What can you say, if anything, about the relationship between airline and airport in NYC in 2013 in regards to the number of departing flights?</p>
<p><strong><code>r paste0("(LC", chap, ".", (lc &lt;- lc + 1), ")")</code></strong> Why might the side-by-side barplot be preferable to a stacked barplot in this case?</p>
<p><strong><code>r paste0("(LC", chap, ".", (lc &lt;- lc + 1), ")")</code></strong> What are the disadvantages of using a dodged barplot, in general?</p>
<p><strong><code>r paste0("(LC", chap, ".", (lc &lt;- lc + 1), ")")</code></strong> Why is the faceted barplot preferred to the side-by-side and stacked barplots in this case?</p>
<p><strong><code>r paste0("(LC", chap, ".", (lc &lt;- lc + 1), ")")</code></strong> What information about the different carriers at different airports is more easily seen in the faceted barplot?</p>
<pre><code>\vspace{-0.25in}
\vspace{-0.25in}
</code></pre>
<h3 id="summary">Summary</h3>
<p>Barplots are a common way of displaying the distribution of a categorical variable, or in other words the frequency with which the different categories (also called <em>levels</em>) occur.  They are easy to understand and make it easy to make comparisons across levels.  Furthermore, when trying to visualize the relationship of two categorical variables, you have many options: stacked barplots, side-by-side barplots, and faceted barplots. Depending on what aspect of the relationship you are trying to emphasize, you will need to make a choice between these three types of barplots and own that choice.</p>
<h2 id="conclusion-data-vis-conclusion">Conclusion {#data-vis-conclusion}</h2>
<h3 id="summary-table">Summary table</h3>
<p>Let's recap all five of the five named graphs (5NG) \index{five named graphs} in Table \@ref(tab:viz-summary-table) summarizing their differences. Using these 5NG, you'll be able to visualize the distributions and relationships of variables contained in a wide array of datasets. This will be even more the case as we start to map more variables to more of each <code>geom</code>etric object's <code>aes</code>thetic attribute options, further unlocking the awesome power of the <code>ggplot2</code> package.</p>
<pre><code># The following Google Doc is published to CSV and loaded using read_csv():
# https://docs.google.com/spreadsheets/d/1vzqlFiT6qm5wzy_L_0nL7EWAd6jiUZmLSCFhDhztDSg/edit#gid=0

if (!file.exists(&quot;rds/summary_table_ch2.rds&quot;)) {
  summary_table_ch3 &lt;-
    &quot;https://docs.google.com/spreadsheets/d/e/2PACX-1vRGaUW6EMIGPhg2V7CahoSdVi_JCcESFRYV5tov6bjcwOcn7DZDzfpZgrvjfFG6PV57gcJYIrwl_Q2c/pub?gid=0&amp;single=true&amp;output=csv&quot; %&gt;%
    read_csv(na = &quot;&quot;)
  summary_table_ch3$Notes[2] &lt;- &quot;Used when there is a sequential order to x-variable, e.g., time&quot;
  write_rds(summary_table_ch3, &quot;rds/summary_table_ch2.rds&quot;)
} else {
  summary_table_ch2 &lt;- read_rds(&quot;rds/summary_table_ch2.rds&quot;) %&gt;%
    rename(` ` = `X1`)
}

if (is_latex_output()) {
  summary_table_ch2 %&gt;%
    # Weird tick marks show up in PDF:
    mutate(`Geometric object` = str_replace_all(`Geometric object`, &quot;`&quot;, &quot;&quot;)) %&gt;%
    kbl(
      caption = &quot;Summary of Five Named Graphs&quot;,
      booktabs = TRUE,
      format = &quot;latex&quot;,
      linesep = &quot;&quot;
    ) %&gt;%
    kable_styling(font_size = 10) %&gt;%
    column_spec(3, width = &quot;1.1in&quot;) %&gt;%
    column_spec(4, width = &quot;1.2in&quot;) %&gt;%
    column_spec(5, width = &quot;1.6in&quot;)
} else {
  summary_table_ch2 %&gt;%
    kbl(
      caption = &quot;Summary of Five Named Graphs&quot;,
      booktabs = TRUE,
      format = &quot;html&quot;
    )
}
</code></pre>
<h3 id="function-argument-specification">Function argument specification</h3>
<p>Let's go over some important points about specifying the arguments (i.e., inputs) to functions. Run the following two segments of code:</p>
<pre><code># Segment 1:
ggplot(data = flights, mapping = aes(x = carrier)) +
  geom_bar()

# Segment 2:
ggplot(flights, aes(x = carrier)) +
  geom_bar()
</code></pre>
<p>You'll notice that both code segments create the same barplot, even though in the second segment we omitted the <code>data =</code> and <code>mapping =</code> code argument names. This is because the <code>ggplot()</code> function by default assumes that the <code>data</code> argument comes first and the <code>mapping</code> argument comes second. \index{functions!argument order} As long as you specify the data frame in question first and the <code>aes()</code> mapping second, you can omit the explicit statement of the argument names <code>data =</code> and <code>mapping =</code>. </p>
<p>Going forward for the rest of this book, all <code>ggplot()</code> code will be like the second segment: with the <code>data =</code> and <code>mapping =</code> explicit naming of the argument omitted with the default ordering of arguments respected. We'll do this for brevity's sake; it's common to see this style when reviewing other R users' code.</p>
<h3 id="additional-resources">Additional resources</h3>
<pre><code>if (is_latex_output()) {
  cat(&quot;Solutions to all *Learning checks* can be found online in [Appendix D](https://moderndive.com/D-appendixD.html).&quot;)
}
</code></pre>
<pre><code>generate_r_file_link(&quot;02-visualization.R&quot;)
</code></pre>
<p>If you want to further unlock the power of the <code>ggplot2</code> package for data visualization, we suggest that you check out RStudio's "Data Visualization with ggplot2" cheatsheet. This cheatsheet summarizes much more than what we've discussed in this chapter. In particular, it presents many more than the 5 <code>geom</code>etric objects we covered in this chapter while providing quick and easy to read visual descriptions. For all the <code>geom</code>etric objects, it also lists all the possible aesthetic attributes one can tweak. In the current version of RStudio in mid 2024, you can access this cheatsheet by going to the RStudio Menu Bar -&gt; Help -&gt; Cheatsheets -&gt; "Data Visualization with ggplot2." <code>r if(is_html_output()) "You can see a preview in the figure below."</code> Alternatively, you can preview the cheat sheet by going to the ggplot2 Github page with this <a href="https://github.com/rstudio/cheatsheets/blob/main/data-visualization-2.1.pdf">link</a>.</p>
<pre><code>if (is_html_output()) {
  include_graphics(&quot;images/cheatsheets/ggplot_cheatsheet-1.png&quot;)
}
</code></pre>
<h3 id="whats-to-come-whats-to-come-3">What's to come {#whats-to-come-3}</h3>
<pre><code># This redundant code is used for dynamic non-static in-line text output purposes
flights_rows &lt;- flights %&gt;%
  nrow() %&gt;%
  comma()
alaska_flights_rows &lt;- flights %&gt;%
  filter(carrier == &quot;AS&quot;) %&gt;%
  nrow() %&gt;%
  comma()
</code></pre>
<p>Recall in Figure \@ref(fig:noalpha) in Section \@ref(scatterplots) we visualized the relationship between departure delay and arrival delay for Alaska Airlines flights only, rather than <em>all</em> flights. This data is saved in the <code>alaska_flights</code> data frame from the <code>moderndive</code> package.</p>
<p>In reality, the <code>alaska_flights</code> data frame is merely a subset of the <code>flights</code> data frame from the <code>nycflights13</code> package consisting of <em>all</em> flights that left NYC in 2013. We created <code>alaska_flights</code> using the following code that uses the <code>dplyr</code> package for data wrangling:</p>
<pre><code>library(dplyr)

alaska_flights &lt;- flights %&gt;% 
  filter(carrier == &quot;AS&quot;)

ggplot(data = alaska_flights, mapping = aes(x = dep_delay, y = arr_delay)) + 
  geom_point()
</code></pre>
<p>This code takes the <code>flights</code> data frame and <code>filter()</code> it to only return the <code>r alaska_flights_rows</code> rows where <code>carrier</code> is equal to <code>"AS"</code>, Alaska Airlines' carrier code. (Recall from Section \@ref(code) that testing for equality is specified with \index{using == instead of =} <code>==</code> and not <code>=</code>.) The code then cycles back to save the output in a new data frame called <code>alaska_flights</code> using the <code>&lt;-</code> <em>assignment</em> operator\index{operators!assignment (&lt;-)}. </p>
<p>Similarly, recall in Figure \@ref(fig:hourlytemp) in Section \@ref(linegraphs) we visualized hourly temperature recordings at Newark airport only for the first 15 days of January 2013. This data is saved in the <code>early_january_weather</code> data frame from the <code>moderndive</code> package.</p>
<p>In reality, the <code>early_january_weather</code> data frame is merely a subset of the <code>weather</code> data frame from the <code>nycflights13</code> package consisting of <em>all</em> hourly weather observations in 2013 for <em>all</em> three NYC airports. We created <code>early_january_weather</code> using the following <code>dplyr</code> code:  </p>
<pre><code>early_january_weather &lt;- weather %&gt;% 
  filter(origin == &quot;EWR&quot; &amp; month == 1 &amp; day &lt;= 15)

ggplot(data = early_january_weather, mapping = aes(x = time_hour, y = temp)) +
  geom_line()
</code></pre>
<p>This code pares down the <code>weather</code> data frame to a new data frame <code>early_january_weather</code> consisting of hourly temperature recordings only for <code>origin == "EWR"</code>, <code>month == 1</code>, and day less than or equal to <code>15</code>. </p>
<p>These two code segments are a preview of Chapter \@ref(wrangling) on data wrangling using the <code>dplyr</code> package. Data wrangling is the process of transforming and modifying existing data with the intent of making it more appropriate for analysis purposes. For example, these two code segments used the <code>filter()</code> function to create new data frames (<code>alaska_flights</code> and <code>early_january_weather</code>) by choosing only a subset of rows of existing data frames (<code>flights</code> and <code>weather</code>). In the next chapter, we'll formally introduce the <code>filter()</code> and other data wrangling functions as well as the <em>pipe operator</em> <code>%&gt;%</code> which allows you to combine multiple data wrangling actions into a single sequential <em>chain</em> of actions. On to Chapter \@ref(wrangling) on data wrangling!</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  ページトップへ戻る
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2023 - 2025 Tomoshige Nakamura
    </div>
  
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.tabs", "navigation.expand", "navigation.path", "navigation.indexes", "navigation.sections", "navigation.top", "navigation.tracking", "toc.follow"], "search": "../../../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "\u30b3\u30d4\u30fc\u3057\u307e\u3057\u305f", "clipboard.copy": "\u30af\u30ea\u30c3\u30d7\u30dc\u30fc\u30c9\u3078\u30b3\u30d4\u30fc", "search.result.more.one": "\u3053\u306e\u30da\u30fc\u30b8\u5185\u306b\u3082\u30461\u4ef6\u898b\u3064\u304b\u308a\u307e\u3057\u305f", "search.result.more.other": "\u3053\u306e\u30da\u30fc\u30b8\u5185\u306b\u3042\u3068#\u4ef6\u898b\u3064\u304b\u308a\u307e\u3057\u305f", "search.result.none": "\u4f55\u3082\u898b\u3064\u304b\u308a\u307e\u305b\u3093\u3067\u3057\u305f", "search.result.one": "1\u4ef6\u898b\u3064\u304b\u308a\u307e\u3057\u305f", "search.result.other": "#\u4ef6\u898b\u3064\u304b\u308a\u307e\u3057\u305f", "search.result.placeholder": "\u691c\u7d22\u30ad\u30fc\u30ef\u30fc\u30c9\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044", "search.result.term.missing": "\u691c\u7d22\u306b\u542b\u307e\u308c\u306a\u3044", "select.version": "\u30d0\u30fc\u30b8\u30e7\u30f3\u5207\u308a\u66ff\u3048"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.60a45f97.min.js"></script>
      
        <script src="../../../javascripts/katex.js"></script>
      
        <script src="https://unpkg.com/katex@0/dist/katex.min.js"></script>
      
        <script src="https://unpkg.com/katex@0/dist/contrib/auto-render.min.js"></script>
      
    
  </body>
</html>